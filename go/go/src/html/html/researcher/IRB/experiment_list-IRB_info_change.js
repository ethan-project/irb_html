"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof ipsap_item_module_js&&document.write("<script src='/assets/js/ipsap/ipsap_item_module.js'><\/script>"),"undefined"==typeof ipsap_application_common_js&&document.write("<script src='/assets/js/ipsap/ipsap_application_common.js'><\/script>"),"undefined"==typeof date_utils_js&&document.write("<script src='/assets/js/common/util/date_utils.js'><\/script>"),document.write("<script src='/html/researcher/IRB/common_application_new-IRB.js'><\/script>");var g_all_userlist=[];let g_old_member_app_seq=0,g_old_end_date_app_seq=0;const member_is_seq=299,end_date_is_seq=300;function dataMappingFunc(e){var t=e.getParentItemData("general_title");$("#name_ko").text(t.getStringValue("name_ko")),$("#name_en").text(t.getStringValue("name_en"));{t=e.getParentItemData("application_info");let a=Number(t.getStringValue("approved_dttm"));$("#approved_dttm").text(getDttm(a).dt)}t=e.getParentItemData("general_end_date");function a(e,t){for(let a=0;a<e.length;++a)if(e[a].is_seq==t)return e[a].contents;return"Error!!"}function n(e,t){for(let a=0;a<e.length;++a)if(e[a].file_idx==t)return e[a]}$("#general_end_date").text(t.getStringValue("0")),setExpCategory(e);{var r=e.getItemData("irb_ca_file");let P=(t=e.getItemData("irb_ca_item")).dataObj.saved_data.data;for(const[h,A]of Object.entries(P)){let P=n(r.dataObj.saved_data.data,Number(h));var i=JSON.parse(A);let E={};var p=3;if(299==Number(h)){E=changeMemberTemplate.clone(),E.find(".data").eq(2).text(i[2]);var d=E.find(".data").find("tbody").eq(0),_=E.find(".data").find("tbody").eq(1),c=d.children("tr").eq(0),o=_.children("tr").eq(0);E.find(".data").find("tbody").empty();let t=CONST.API.APPLICATION_CHANGE.BEFORECHANGE_MEMBER,a=i[1];API.load({url:t.replace("${app_seq}",a),type:CONST.API_TYPE.GET,success:function(e){var t=[];for(let a=0;a<e.length;a++)t.push(e[a]);$.each(t,(function(e,t){var a=c.clone(),n=t.info;n.tmp_phoneno=n.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),0==t.exp_type_code&&(t.exp_type_code_str="연구 책임자"),a.children("td").eq(0).text(t.exp_type_code_str),a.children("td").eq(1).text(n.name),a.children("td").eq(2).text(n.dept_str),a.children("td").eq(3).text(n.position_str),a.children("td").eq(4).text(n.major_field_str),a.children("td").eq(5).text(t.exp_year_code_str),d.append(a)}))},error:function(){},complete:function(){}});var s=[],l=e.getItemData("general_director");s.push(l.dataObj.saved_data.data[0]);for(var m=e.getItemData("general_expt"),g=0;g<Object.keys(m.dataObj.saved_data.data).length;g++)s.push(m.dataObj.saved_data.data[g]);$.each(s,(function(e,t){var a=o.clone(),n=t.info;0==t.exp_type_code&&(t.exp_type_code_str="연구 책임자"),a.children("td").eq(0).text(t.exp_type_code_str),a.children("td").eq(1).text(n.name),a.children("td").eq(2).text(n.dept_str),a.children("td").eq(3).text(n.position_str),a.children("td").eq(4).text(n.major_field_str),a.children("td").eq(5).text(t.exp_year_code_str),_.append(a)}))}else if(300==Number(h)){var u;E=changeEndDateTemplate.clone();let t=CONST.API.APPLICATION_CHANGE.BEFORECHANGE_ENDDATE,a=i[1];API.load({url:t.replace("${app_seq}",a),type:CONST.API_TYPE.GET,success:function(t){var a=e.getParentItemData("application_info");let n=getTimeStrFromDateType(new Date(getDttm(Number(a.getStringValue("approved_dttm"))).dt));u=getTimeStrFromDateType(new Date(t[0][0]));var r=e.getItemData("general_end_date"),i=getTimeStrFromDateType(new Date(r.getStringValue("0")));E.find(".data").eq(2).text(n+"~"+u),E.find(".data").eq(3).text(n+"~"+i)},error:function(){},complete:function(){}}),E.find(".data").eq(4).text(i[2]),p=5}else E=changeInfoTemplate.clone(),E.find("label").eq(0).text(a(t.dataObj.codes,Number(h))),E.find(".data").eq(1).text(i[1]),E.find(".data").eq(2).text(i[2]);null==P?E.find(".data").eq(p).text(""):(E.find(".data").eq(p).text(P.org_file_name),E.find(".data").eq(p).attr("href",P.src));var f=`newWindowPopup('./_popup_app-IRB_info_all.html#form_${i[0]}')`;E.find("a").first().attr("onclick",f),E.find("a").eq(0).empty();var I=`<i class="fas fa-link mRight5"></i>심의 신청서 : ${IPSAP.IRB_MAIN_TAGE_NAME[i[0]]}`;E.find("a").eq(0).append(I),$("#change_application").append(E)}}switch($(".agree_date").text(getDate(g_AppInfo.appObj.submit_dttm)),$(".reviewer").text(spaceAddStr(g_AppInfo.appObj.user_name)),Number(g_AppInfo.appObj.application_result)){case IPSAP.APPLICATION_RESULT.SUPPLEMENT:$(".card-footer").children().eq(0).removeClass("hidden");case IPSAP.APPLICATION_RESULT.REJECT:case IPSAP.APPLICATION_RESULT.REQUIRE_RETRY:case IPSAP.APPLICATION_RESULT.EXPERIMENT_ING_A:case IPSAP.APPLICATION_RESULT.EXPERIMENT_ING_AC:case IPSAP.APPLICATION_RESULT.EXPERIMENT_FINISH:case IPSAP.APPLICATION_RESULT.TASK_FINISH:case IPSAP.APPLICATION_RESULT.ACCEPT:case IPSAP.APPLICATION_RESULT.ACCEPT_AC:}$(".card").removeClass("hidden")}function appendExpCategory(e){$("#exp_category").empty();var t='<label class="mRight10 mBot0">실험 분류 :</label>';for(let a=0;a<e.length;a++)t+=`<button type="button" class="btn btn-outline-primary btn-round btn_tag btn_tag_sm mRight5">\n                  ${e[a]}\n                </button>`;$("#exp_category").append(t)}function setExpCategory(e){var t=[],a="general_object";1==e.getParentItemData(a,"nosave").getStringValue("0")?t.push("심의 대상"):t.push("면제 대상");a="general_human_research";1==e.getParentItemData(a,"nosave").getStringValue("0")&&t.push("인간대상 연구");a="general_body_research";1==e.getParentItemData(a,"nosave").getStringValue("0")&&t.push("인체 유래물 연구"),appendExpCategory(t)}$((function(){loadApplicationParams();changeInfoTemplate=$("#change_application").children("ul").eq(0).clone(),changeMemberTemplate=$("#change_application").children("ul").eq(1).clone(),changeEndDateTemplate=$("#change_application").children("ul").eq(2).clone(),$("#change_application").empty(),$("#change_application").removeClass("hidden"),g_AppItemParser=new ItemParser(g_AppInfo.childAppSeq),g_AppItemParser.load({"filter.query_items":"irb_change_application,general_director,general_expt,general_end_date","filter.parent_items":"general_title,general_end_date,application_info,general_director,general_expt,general_object,general_human_research,general_body_research"},dataMappingFunc)}));