var g_other_userlist;function makeExptUserList(){var e="general_expt",t=g_AppItemParser.getItemData(e),a='<tbody id="general_expt">';let n=g_AppItemParser.managedItems[e].member;$.each(n,(function(e,n){n.info.tmp_phoneno=n.info.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),n.info.tmp_edu_date=n.info.edu_date.replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3");var r=`general_expt_${n.user_seq}_select`,i=`general_expt_${n.user_seq}_radio`;combo_html=makeComboList(r,"<option selected disabled>경력</option>",t.dataObj.codes,"exp_year_code"),a+=`\n      <tr data-id="${n.user_seq}" item_name="general_expt">\n        <td>\n          <div class="custom-radio">\n            <input type="radio" id="${i}" name="exp_manager" value="${n.user_seq}">\n          </div>\n        </td>\n        <td>${n.info.name}</td>\n        <td>${n.info.dept_str}</td>\n        <td>${n.info.position_str}</td>\n        <td>${n.info.major_field_str}</td>\n        <td>${n.info.tmp_phoneno}</td>\n        <td>${n.info.email}</td>\n        <td>${n.info.edu_course_num}</td>\n        <td>${n.info.edu_institution_str}</td>\n        <td>${combo_html}</td>\n        <td>\n          <a href="javascript:void(0);" class="btn btn-xs btn-outline-danger btn-staff-delete"><i class="far fa-trash-alt mRight5"></i>삭제</a>\n        </td>\n      </tr>`})),a+='\n  <tr class="add_row">\n    <td colspan="11">\n      <a href="javascript:void(0);" onclick="openModelOtherStaff();" class="btn btn-xs btn-outline-primary" ><i class="fas fa-user-plus mRight5"></i>실험 수행자 선택 추가</a>\n    </td>\n  </tr>\n  </tbody>',$("#general_expt").replaceWith(a),$("#general_expt").children().eq(0).find("input").prop("checked",!0),$.each(n,(function(e,a){var n=`general_expt_${a.user_seq}_radio`;a.animal_mng_flag>0&&$("#"+n).prop("checked",!0);var r=`general_expt_${a.user_seq}_select`;$("#"+r).find(`option[value='${a.exp_year_code}'`).attr("selected",!0),$("#"+r).on("change",(function(){t.changeAttrForMember(a.user_seq,"exp_year_code",this.value)}))})),$("input[name=exp_manager]").on("change",(function(){var e=Number($(this).val());t.changeAttrForMember(e,"animal_mng_flag",1)}))}function openModelOtherStaff(){makeOtherStaffList(),$("#modal_staff").modal("show")}function onStaffSelect(e){$.each(g_other_userlist,(function(t,a){if(Number(a.user_seq)==e&&!g_AppItemParser.hasMemberExists(a.user_seq))return g_AppItemParser.insertMember("general_expt",a),makeExptUserList(),void $("#modal_staff").modal("hide")}))}function makeOtherStaffList(){let e='<tbody id="other-staff">';$.each(g_other_userlist,(function(t,a){var n=a.user_type.split(",");g_AppItemParser.hasMemberExists(a.user_seq)||-1==$.inArray("3",n)||(a.tmp_phoneno=a.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),e+=`\n      <tr data-url="" class="staff-row" onclick="onStaffSelect(${a.user_seq})">\n        <td class="text-center">${a.name}</td>\n        <td>${a.dept_str}</td>\n        <td>${a.position_str}</td>\n        <td>${a.major_field_str}</td>\n        <td>${a.tmp_phoneno}</td>\n        <td>${a.email}</td>\n        <td>${a.edu_course_num}</td>\n        <td>${a.edu_institution_str}</td>\n      </tr>`)})),e+="</tbody>",$("#other-staff").replaceWith(e),initDataTable("#researcher_list")}"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),document.write("<script src='./application_new-0.js'><\/script>"),$((function(){loadApplicationParams();$(".page-content");function e(e){!function(e){var t="general_director",a=e.getItemData(t);if(null==a.dataObj.saved_data)return;a.dataObj.saved_data.data[0].animal_mng_flag=0,a.initMembers();let n=a.dataObj.saved_data.data[0];n.info.tmp_phoneno=n.info.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),n.info.tmp_edu_date=n.info.edu_date.replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3"),$("#general_director_name").text(n.info.name),$("#general_director_email").text(n.info.email),$("#general_director_dept").text(n.info.dept_str),$("#general_director_edu_date").text(n.info.tmp_edu_date),$("#general_director_position").text(n.info.position_str),$("#general_director_edu_instition").text(n.info.edu_institution_str),$("#general_director_major_field").text(n.info.major_field_str),$("#general_director_edu_course_num").text(n.info.edu_course_num),$("#general_director_phoneno").text(n.info.tmp_phoneno);var r="general_director_select";combo_html=makeComboList(r,"<option selected disabled>경력 선택</option>",a.dataObj.codes,"exp_year_code"),$("#"+r).replaceWith(combo_html),$("#"+r).find(`option[value='${n.exp_year_code}'`).attr("selected",!0),$("#"+r).on("change",(function(){a.changeAttrForMember(n.user_seq,"exp_year_code",this.value)}))}(e),function(e){var t=e.getItemData("general_expt");null!=t.dataObj.saved_data&&(t.initMembers(),makeExptUserList())}(e);var t="general_ref";e.getItemData(t).applyMultiFileValue(5,t,"관련 자료"),$(".card").removeClass("hidden")}var t=function(e,t){this.phase="page1_2",this.btn_type=t};t.prototype.check=function(){"nextPage"==this.btn_type?appNaviNextPage():saveTemporary()},di.autowired(!1).register("validator_nextPage").as(t).withConstructor().withProperties().prop("btn_type").val("nextPage").register("validator_tempSave").as(t).withConstructor().withProperties().prop("btn_type").val("tempSave"),g_AppItemParser=new ItemParser(g_AppInfo.appSeq),g_AppItemParser.load({"filter.query_items":"general_director,general_expt,general_ref","filter.guide_items":"general_director,general_expt,general_ref"},e),function(){let e=CONST.API.INSTITUTION.USER;API.load({url:e.replace("${inst_seq}",g_AppInfo.appObj.institution_seq),data:{"filter.user_type":IPSAP.USER_TYPE.RESEARCHER},type:CONST.API_TYPE.GET,success:function(e){g_other_userlist=e}})}(),$(document).on("click",".btn-staff-delete",(function(){if($(this).closest("tr").find("input:radio").is(":checked"))return!1;var e=$(this).closest("tr").attr("data-id"),t=$(this).closest("tr").attr("item_name");g_AppItemParser.removeMembers(t,e),$(this).closest("tr").remove()}))}));