var changeInfoTemplate,changeMemberTemplate,changeEndDateTemplate;"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof ipsap_item_module_js&&document.write("<script src='/assets/js/ipsap/ipsap_item_module.js'><\/script>"),document.write("<script src='/html/researcher/IBC/common_application_new-IBC.js'><\/script>");const member_is_seq=286,end_date_is_seq=288;function dataMappingFunc(e){var t=e.getParentItemData("general_title");$("#name_ko").text(t.getStringValue("name_ko")),$("#name_en").text(t.getStringValue("name_en"));{t=e.getParentItemData("application_info");let a=Number(t.getStringValue("approved_dttm"));$("#approved_dttm").text(getDttm(a).dt)}t=e.getParentItemData("general_end_date");function a(e,t){for(let a=0;a<e.length;++a)if(e[a].is_seq==t)return e[a].contents;return"Error!!"}function n(e,t){for(let a=0;a<e.length;++a)if(e[a].file_idx==t)return e[a]}$("#general_end_date").text(t.getStringValue("0"));{var d=e.getItemData("ibc_ca_file");let P=(t=e.getItemData("ibc_ca_item")).dataObj.saved_data.data;for(const[A,T]of Object.entries(P)){let P=n(d.dataObj.saved_data.data,Number(A));var i=JSON.parse(T);let q={};var r=3;if(286==Number(A)){q=changeMemberTemplate.clone(),q.find(".data").eq(2).text(i[2]);var p=q.find(".data").find("tbody").eq(0),c=q.find(".data").find("tbody").eq(1),l=p.children("tr").eq(0),s=c.children("tr").eq(0);q.find(".data").find("tbody").empty();let t=CONST.API.APPLICATION_CHANGE.BEFORECHANGE_MEMBER,a=i[1];API.load({url:t.replace("${app_seq}",a),type:CONST.API_TYPE.GET,success:function(e){var t=[];for(let a=0;a<e.length;a++)t.push(e[a]);$.each(t,(function(e,t){let a="";if(t.edu_course){let e=JSON.parse(t.edu_course);for(const t in e)a+=`\n                  <div class="flexMid">\n                    <span class="w120 mRight5">${t}</span>\n                    <div>${e[t]}</div>\n                  </div>`}var n=l.clone(),d=t.info;d.tmp_phoneno=d.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),1==t.user_seq?n.children("td").eq(0).find("input").prop("checked",!0):(n.children("td").eq(0).find("input").prop("checked",!1),n.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?n.children("td").eq(1).find("input").prop("checked",!0):(n.children("td").eq(1).find("input").prop("checked",!1),n.children("td").eq(1).find("input").prop("disabled",!0)),n.children("td").eq(2).text(d.name),n.children("td").eq(3).text(d.dept_str),n.children("td").eq(4).append(a),p.append(n)}))},error:function(){},complete:function(){}});var o=[],_=e.getItemData("general_director");o.push(_.dataObj.saved_data.data[0]);for(var f=_.dataObj.saved_data.data[0].user_seq,m=e.getItemData("general_expt"),u=0;u<Object.keys(m.dataObj.saved_data.data).length;u++)o.push(m.dataObj.saved_data.data[u]);$.each(o,(function(e,t){let a="";if(t.edu_course){let n=JSON.parse(t.edu_course);for(e in n)a+=`\n              <div class="flexMid">\n                <span class="w120 mRight5">${e}</span>\n                <div>${n[e]}</div>\n              </div>`}var n=s.clone(),d=t.info;f==t.user_seq?n.children("td").eq(0).find("input").prop("checked",!0):(n.children("td").eq(0).find("input").prop("checked",!1),n.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?n.children("td").eq(1).find("input").prop("checked",!0):(n.children("td").eq(1).find("input").prop("checked",!1),n.children("td").eq(1).find("input").prop("disabled",!0)),n.children("td").eq(2).text(d.name),n.children("td").eq(3).text(d.dept_str),n.children("td").eq(4).append(a),c.append(n)}))}else if(288==Number(A)){var g;q=changeEndDateTemplate.clone();let t=CONST.API.APPLICATION_CHANGE.BEFORECHANGE_ENDDATE,a=i[1];API.load({url:t.replace("${app_seq}",a),type:CONST.API_TYPE.GET,success:function(t){var a=e.getParentItemData("application_info");let n=getTimeStrFromDateType(new Date(getDttm(Number(a.getStringValue("approved_dttm"))).dt));g=getTimeStrFromDateType(new Date(t[0][0]));var d=e.getItemData("general_end_date"),r=getTimeStrFromDateType(new Date(d.getStringValue("0")));q.find(".data").eq(2).text(n+"~"+g),q.find(".data").eq(3).text(n+"~"+r),q.find(".data").eq(4).text(i[2])},error:function(){},complete:function(){}}),q.find(".data").eq(4).text(i[2]),r=5}else q=changeInfoTemplate.clone(),q.find("label").eq(0).text(a(t.dataObj.codes,Number(A))),q.find(".data").eq(1).text(i[1]),q.find(".data").eq(2).text(i[2]);null==P?q.find(".data").eq(r).text(""):(q.find(".data").eq(r).text(P.org_file_name),q.find(".data").eq(r).attr("href",P.src));var h=`newWindowPopup('./_popup_app-IBC_info_all.html#form_${i[0]}')`;q.find("a").first().attr("onclick",h),q.find("a").eq(0).empty();var I=`<i class="fas fa-link mRight5"></i>심의 신청서 : ${IPSAP.IBC_MAIN_TAGE_NAME[i[0]]}`;q.find("a").eq(0).append(I),$("#change_application").append(q)}}switch($(".agree_date").text(getDate(g_AppInfo.appObj.submit_dttm)),$(".reviewer").text(spaceAddStr(g_AppInfo.appObj.user_name)),Number(g_AppInfo.appObj.application_result)){case IPSAP.APPLICATION_RESULT.SUPPLEMENT:$(".card-footer").children().eq(0).removeClass("hidden");break;case IPSAP.APPLICATION_RESULT.REJECT:case IPSAP.APPLICATION_RESULT.REQUIRE_RETRY:case IPSAP.APPLICATION_RESULT.EXPERIMENT_ING_A:case IPSAP.APPLICATION_RESULT.EXPERIMENT_ING_AC:case IPSAP.APPLICATION_RESULT.EXPERIMENT_FINISH:case IPSAP.APPLICATION_RESULT.TASK_FINISH:case IPSAP.APPLICATION_RESULT.ACCEPT:case IPSAP.APPLICATION_RESULT.ACCEPT_AC:$(".card-footer").children().eq(1).removeClass("hidden")}$(".card").removeClass("hidden")}$((function(){loadApplicationParams();changeInfoTemplate=$("#change_application").children("ul").eq(0).clone(),changeMemberTemplate=$("#change_application").children("ul").eq(1).clone(),changeEndDateTemplate=$("#change_application").children("ul").eq(2).clone(),$("#change_application").empty(),$("#change_application").removeClass("hidden"),g_AppItemParser=new ItemParser(g_AppInfo.childAppSeq),g_AppItemParser.load({"filter.query_items":"ibc_change_application","filter.parent_items":"general_title,general_end_date,application_info,general_director,general_expt,ibc_general_experiment"},dataMappingFunc)}));