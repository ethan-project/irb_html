var changeInfoTemplate,changeMemberTemplate,changeEndDateTemplate;"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof ipsap_item_module_js&&document.write("<script src='/assets/js/ipsap/ipsap_item_module.js'><\/script>"),document.write("<script src='../researcher/application_new-0.js'><\/script>");const animal_is_seq=104,member_is_seq=111,end_date_is_seq=112;function dataMappingFunc(e){var t=e.getItemData("application_info");$(".register_num").text(t.getStringValue("application_no"));t=e.getParentItemData("general_title");$("#name_ko").text(t.getStringValue("name_ko")),$("#name_en").text(t.getStringValue("name_en")),$(".task_title_ko").text(g_AppInfo.appObj.name_ko+" "+g_AppInfo.appObj.sub_title);{t=e.getParentItemData("application_info");let a=Number(t.getStringValue("approved_dttm"));$("#approved_dttm").text(getDttm(a).dt)}t=e.getParentItemData("general_end_date");function a(e,t){for(let a=0;a<e.length;++a)if(e[a].is_seq==t)return e[a].contents;return"Error!!"}function n(e,t){for(let a=0;a<e.length;++a)if(e[a].file_idx==t)return e[a]}$("#general_end_date").text(t.getStringValue("0"));{var d=e.getItemData("ca_regular_file");let c=(t=e.getItemData("ca_regular_item")).dataObj.saved_data.data;for(const[e,o]of Object.entries(c)){let c=n(d.dataObj.saved_data.data,Number(e)),s=changeInfoTemplate.clone();s.find("span").eq(0).text("[정규]"),s.find("span").eq(1).text(a(t.dataObj.codes,Number(e)));var i,r=JSON.parse(o);104==Number(e)?(i=s.find(".data").eq(1).children("div").first().clone(),s.find(".data").eq(1).empty()):s.find(".data").eq(1).text(r[1]),s.find(".data").eq(2).text(r[2]),s.find("span").eq(2).text(IPSAP.APP_MAIN_TAG_NAME[r[0]]);var p=`newWindowPopup('./_popup_application-info.html#form_${r[0]}')`;if(s.find("a").first().attr("onclick",p),null==c?s.find(".data").eq(3).text(""):(s.find(".data").eq(3).text(c.org_file_name),s.find(".data").eq(3).attr("href",c.src)),104==Number(e)){var l=JSON.parse(r[1]);for(let e=0;e<l.length;++e){let t=i.clone();t.find("span").eq(0).text(l[e][0]),t.find("span").eq(3).text(l[e][1]),t.find("span").eq(5).text(l[e][2]),t.find("span").eq(6).text(l[e][3]),t.find("span").eq(9).text(l[e][4]),t.find("span").eq(11).text(l[e][5]),s.find(".data").eq(1).append(t)}}$("#change_application").append(s)}Object.keys(c).length>0?$("#btn_finish_review_fast").hide():$("#btn_finish_review").hide()}{d=e.getItemData("ca_fast_file");let i=(t=e.getItemData("ca_fast_item")).dataObj.saved_data.data;for(const[l,y]of Object.entries(i)){let i=n(d.dataObj.saved_data.data,Number(l));r=JSON.parse(y);let T={};var c=3;if(111==Number(l)){T=changeMemberTemplate.clone(),T.find(".data").eq(2).text(r[2]);var o=T.find(".data").find("tbody").eq(0),s=T.find(".data").find("tbody").eq(1),_=o.children("tr").eq(0),f=s.children("tr").eq(0);T.find(".data").find("tbody").empty();var m=[],g=e.getParentItemData("general_director");m.push(g.dataObj.saved_data.data[0]);for(var h=g.dataObj.saved_data.data[0].user_seq,u=e.getParentItemData("general_expt"),q=0;q<Object.keys(u.dataObj.saved_data.data).length;q++)m.push(u.dataObj.saved_data.data[q]);$.each(m,(function(e,t){var a=_.clone(),n=t.info;n.tmp_phoneno=n.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),h==t.user_seq?a.children("td").eq(0).find("input").prop("checked",!0):(a.children("td").eq(0).find("input").prop("checked",!1),a.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?a.children("td").eq(1).find("input").prop("checked",!0):(a.children("td").eq(1).find("input").prop("checked",!1),a.children("td").eq(1).find("input").prop("disabled",!0)),a.children("td").eq(2).text(n.name),a.children("td").eq(3).text(n.dept_str),a.children("td").eq(4).text(n.position_str),a.children("td").eq(5).text(n.major_field_str),a.children("td").eq(6).text(n.tmp_phoneno),a.children("td").eq(7).text(t.exp_year_code_str),o.append(a)}));var b=[],x=e.getItemData("general_director");b.push(x.dataObj.saved_data.data[0]);var v=x.dataObj.saved_data.data[0].user_seq,j=e.getItemData("general_expt");for(q=0;q<Object.keys(j.dataObj.saved_data.data).length;q++)b.push(j.dataObj.saved_data.data[q]);$.each(b,(function(e,t){var a=f.clone(),n=t.info;n.tmp_phoneno=n.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),v==t.user_seq?a.children("td").eq(0).find("input").prop("checked",!0):(a.children("td").eq(0).find("input").prop("checked",!1),a.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?a.children("td").eq(1).find("input").prop("checked",!0):(a.children("td").eq(1).find("input").prop("checked",!1),a.children("td").eq(1).find("input").prop("disabled",!0)),a.children("td").eq(2).text(n.name),a.children("td").eq(3).text(n.dept_str),a.children("td").eq(4).text(n.position_str),a.children("td").eq(5).text(n.major_field_str),a.children("td").eq(6).text(n.tmp_phoneno),a.children("td").eq(7).text(t.exp_year_code_str),s.append(a)}))}else if(112==Number(l)){T=changeEndDateTemplate.clone();var I=e.getParentItemData("application_info");let t=getTimeStrFromDateType(new Date(getDttm(Number(I.getStringValue("approved_dttm"))).dt));var D=e.getParentItemData("general_end_date"),O=getTimeStrFromDateType(new Date(D.getStringValue("0"))),P=e.getItemData("general_end_date"),k=getTimeStrFromDateType(new Date(P.getStringValue("0")));T.find(".data").eq(2).text(t+"~"+O),T.find(".data").eq(3).text(t+"~"+k),T.find(".data").eq(4).text(r[2]),c=5}else T=changeInfoTemplate.clone(),T.removeClass("regular_review"),T.addClass("simple_review"),T.find(".blue_deep").addClass("green"),T.find(".blue_deep").removeClass("blue_deep"),T.find("span").eq(0).text("[신속]"),T.find("span").eq(1).text(a(t.dataObj.codes,Number(l))),T.find(".data").eq(1).text(r[1]),T.find(".data").eq(2).text(r[2]),T.find("span").eq(2).text(IPSAP.APP_MAIN_TAG_NAME[r[0]]);null==i?T.find(".data").eq(c).text(""):(T.find(".data").eq(c).text(i.org_file_name),T.find(".data").eq(c).attr("href",i.src));p=`newWindowPopup('./_popup_application-info.html#form_${r[0]}')`;T.find("a").first().attr("onclick",p),$("#change_application").append(T)}}}$((function(){g_global_mapping=!1,loadApplicationParams();var e=$.urlParam("as");if(IPSAP.DEMO_MODE);else{$(".task_director_all").text(`(연구 책임자 : ${g_AppInfo.appObj.user_name})`),changeInfoTemplate=$("#change_application").children("ul").first().clone(),changeMemberTemplate=$("#change_application").children("ul").eq(2).clone(),changeEndDateTemplate=$("#change_application").children("ul").eq(3).clone(),$("#change_application").empty(),$("#change_application").removeClass("hidden");let t={"filter.query_items":"change_application,application_info","filter.parent_items":"general_title,general_end_date,application_info,general_director,general_expt"};g_AppItemParser=new ItemParser(e),g_AppItemParser.load(t,dataMappingFunc)}}));