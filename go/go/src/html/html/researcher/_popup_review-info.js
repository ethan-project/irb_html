var g_trTemplete;"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof ipsap_item_module_js&&document.write("<script src='/assets/js/ipsap/ipsap_item_module.js'><\/script>"),document.write("<script src='/html/researcher/application_new-0.js'><\/script>");var user_info=JSON.parse(COMM.getCookie(CONST.COOKIE.IPSAP_USER_INFO)),inst_info=JSON.parse(COMM.getCookie(CONST.COOKIE.IPSAP_INST_INFO));function originalJSFunction(e){}function sumPoint(e){var t=0,a="fail";e.each((function(e,a){if("undefined"==$(a).text()||"-"==$(a).text())return 0;t+=parseInt($(a).text())})),a=t>=parseInt(inst_info.ia_base_score)?"pass":a,$("#total_sum").html(`<span class="${a}">${t}</span> / 100`)}function sumAccount(e){var t=0,a="fail";e.each((function(e,a){"적합"==$(a).text()&&t++})),a=t>=parseInt(inst_info.ia_base_item)?"pass":a,$("#total_account").html(`<span class="${a}">${t}</span> / 10`)}function dataMappingFunc(e){(t=e.getItemData("final_judge_result")).makeHtmlRadioType(IPSAP.COL.ALL,0);var t=e.getItemData("general_title",!0);$("#coding_title_area").children("div").eq(0).children("span").text(t.getStringValue("name_ko")),$("#coding_title_area").children("div").eq(1).children("span").text(t.getStringValue("name_en"));t=e.getItemData("general_end_date",!0);"0"==g_AppInfo.appObj.approved_dttm?$("#coding_title_area").children("div").eq(2).children("span").text("위원회 승인일 ~ "+t.getStringValue("0")):$("#coding_title_area").children("div").eq(2).children("span").text(getDttm(g_AppInfo.appObj.approved_dttm).dt+" ~ "+t.getStringValue("0")),(t=e.getItemData("expert_review_total_review")).applyTextValueReadOnly();{t=e.getItemData("expert_review_result");let x=0;try{x=Number(t.dataObj.saved_data.data[0].select_ids[0])}catch(q){}let b="";try{b=t.dataObj.saved_data.data[0].inputs[String(x)][1]}catch(j){}let O="";for(let S=0;S<t.dataObj.items.length;++S)if(t.dataObj.items[S].id==x){O=t.dataObj.items[S].value;break}$("#expert_review_result_text").prev(".custom-radio").find("label").text(O),""!=b?$("#expert_review_result_text").text(b):$("#expert_review_result_text").remove()}{t=e.getItemData("expert_member");try{t.dataObj.saved_data.data[0].info.name}catch(w){}$("#experter").text(spaceAddStr("***"));var a=0;try{a=t.dataObj.saved_data.data[0].user_seq}catch(y){}var i=e.getItemData("expert_review_dttm");const I=new Date(1e3*i.dataObj.saved_data.data[String(a)]);$("#expert_submit_date").text(getTimeStrFromDateType(I))}let n,r=!0;{var s=e.getItemData("expert_review_opinion",!0),d=e.getItemData("expert_review_evaluation",!0);let A=$(".list_table").first().find("tbody");n=d.dataObj.codes;for(let D=0;D<n.length;++D){let C=g_trTemplete.clone();C.children("td").eq(0).text(n[D].contents);let P=C.children("td").eq(1),T=P.children("ul").children("li").first().clone();P.children("ul").empty();for(let E=0;E<n[D].sub_items.length;++E){let k=T.clone();k.text(n[D].sub_items[E].contents),P.children("ul").append(k)}try{let M=s.dataObj.saved_data.data[n[D].is_seq];var l=JSON.parse(M);let R=C.children("td").eq(2);R.empty();let F="";for(let V=0;V<l.select.length;++V){let J=l.select[V],L=s.dataObj.codes[D].sub_items;for(let H=0;H<L.length;++H)if(J==L[H].is_seq){""!=F&&(F+="<br>"),F+=L[H].contents;break}}R.removeClass("noComment"),R.append(`<div class="review_numbers">${F}</div>`),R.append(`<div class="review_desc text-wrap">${l.text}</div>`)}catch(U){}let N=C.children("td").eq(3);if(N.hasClass("evaluation_score")){let K=`review_point_${n[D].is_seq}`;N.attr("name",K)}else{let Y=`review_pass_${n[D].is_seq}`;N.attr("name",Y),r=!1}A.append(C)}}{var o=$(".list_table").eq(1).children("tbody").children("tr").first().clone();$(".list_table").eq(1).children("tbody").empty();var _=e.getItemData("normal_review_result",!0),c=e.getItemData("committee_in_member",!0),m=e.getItemData("committee_ex_member",!0),p=e.getItemData("normal_review_dttm",!0);let z=1;const B=c.dataObj.saved_data.data,G=m.dataObj.saved_data.data;var u,h,v=[0,0,0];if(null!=B)for(let Q=0;Q<B.length;++Q){u=void 0;try{u=_.dataObj.saved_data.data[String(B[Q].info.user_seq)]}catch(W){}h=void 0;try{h=p.dataObj.saved_data.data[String(B[Q].info.user_seq)]}catch(X){}v[f(z++,B[Q],"내부",u,h)]++}if(null!=G)for(let Z=0;Z<G.length;++Z){u=void 0;try{u=_.dataObj.saved_data.data[String(G[Z].info.user_seq)]}catch(ee){}h=void 0;try{h=p.dataObj.saved_data.data[String(G[Z].info.user_seq)]}catch(te){}v[f(z++,G[Z],"외부",u,h)]++}var g=$(".list_table").eq(1).children("tfoot");function f(e,t,a,i,n){var r=0,s=o.clone();s.removeClass("agree");let d=0;if(s.attr("user_seq",t.user_seq),s.children("td").eq(d++).text(e),s.children("td").eq(d++).text("* * *"),s.children("td").eq(d++).text(a),null!=i&&n>0)if(s.children("td").eq(d++).text(getYMDHMSFromUnixtime(n,!0)),"1"==i.select_ids[0]){let e=i.inputs[1][1];s.addClass("agree"),s.children("td").eq(d++).text("찬성"),s.children("td").eq(d++).html(`\n          <a href="javascript:void(0);" onclick="onClickShowAgreeReason('${e}');" class="blue_deep">\n            <i class="fas fa-comment-dots mRight5"></i>${stringShortDot(e,15)}\n          </a>`)}else{r=1,s.addClass("disagree");let e=i.inputs[2][1];s.children("td").eq(d++).text("반대"),s.children("td").eq(d++).html(`\n            <a href="javascript:void(0);" onclick="onClickShowOpposeReason('${e}');" class="red">\n              <i class="fas fa-comment-dots mRight5"></i>${stringShortDot(e,15)}\n            </a>`)}else r=2,s.addClass("timeout"),s.children("td").eq(d++).text("-"),s.children("td").eq(d++).text("-"),s.children("td").eq(d++).text("미이행");return $(".list_table").eq(1).children("tbody").append(s),r}g.children("tr").children("td").eq(1).children("span").eq(0).children("span").text(v[0]),g.children("tr").children("td").eq(1).children("span").eq(1).children("span").text(v[1]),g.children("tr").children("td").eq(1).children("span").eq(2).children("span").text(v[2])}{t=e.getItemData("final_judge_result");let ae=0;try{ae=Number(t.dataObj.saved_data.data[0].select_ids[0])}catch(re){}let ie="";try{ie=t.dataObj.saved_data.data[0].inputs[String(ae)][1]}catch(se){}let ne="";for(let de=0;de<t.dataObj.items.length;++de)if(t.dataObj.items[de].id==ae){ne=t.dataObj.items[de].value;break}$("#final_judge_result_text").prev(".custom-radio").find("label").text(ne),""!=ie?$("#final_judge_result_text").text(ie):$("#final_judge_result_text").switchClass("mTop5","red").text("최종심의 미완료")}originalJSFunction();for(let le=0;le<n.length;++le)if(r){let oe=`review_point_${n[le].is_seq}`;try{let _e=d.dataObj.saved_data.data[n[le].is_seq];_e<2?_e=2:_e||(_e="-"),$(`td[name=${oe}]`).text(`${_e}`)}catch(ce){}}else{let me=`review_pass_${n[le].is_seq}`;try{d.dataObj.saved_data.data[n[le].is_seq]>0?$(`td[name=${me}]`).text("적합"):$(`td[name=${me}]`).addClass("fail").text("부적합")}catch(pe){}}sumPoint($("td.evaluation_score").not(":last")),sumAccount($("td.evaluation_yn").not(":last"))}function onClickShowAgreeReason(e){$(".agree_reason").text(e),$("#modal_agree_comment").modal("show")}function onClickShowOpposeReason(e){$(".oppose_reason").text(e),$("#modal_disagree_comment").modal("show")}$((function(){loadApplicationParams(),function(e){if(IPSAP.DEMO_MODE)originalJSFunction();else{inst_info.ia_evaluation_method==IPSAP.EVALUATION_METHOD.SCORE?$(".evaluation_yn").remove():inst_info.ia_evaluation_method==IPSAP.EVALUATION_METHOD.YN?$(".evaluation_score").remove():inst_info.ia_evaluation_method==IPSAP.EVALUATION_METHOD.NONE?($(".evaluation_score").remove(),$(".evaluation_yn").remove(),e.find("tfoot").find(".text-right").text("")):alert("Error!!!");let t=$(".list_table").first().find("tbody");g_trTemplete=t.children("tr").first().clone(),t.empty();let a={"filter.query_items":"general_title,general_end_date,final_judge_result,expert_review_opinion,expert_review,expert_member,committee_in_member,committee_ex_member,normal_review_result,normal_review_dttm"};g_AppItemParser=new ItemParser(g_AppInfo.appSeq),g_AppItemParser.load(a,dataMappingFunc)}}($(".page-content"))}));