function originalJSFunction(){}function dataMappingFunc(e){var t=e.getItemData("animal_type_bring").dataObj.saved_data.data,a=e.getItemData("br_supplement");$("#br_supplement").text(a.getStringValue("0"));a=e.getParentItemData("general_title");$("#name_ko").text(a.getStringValue("name_ko")),$("#name_en").text(a.getStringValue("name_en"));{a=e.getParentItemData("application_info");let h=Number(a.getStringValue("approved_dttm"));$("#approved_dttm").text(getDttm(h).dt)}a=e.getParentItemData("general_end_date");$("#general_end_date").text(a.getStringValue("0"));a=e.getItemData("additional_reporting");$("#additional_reporting").text(a.getStringValue("0"));{let q=(a=e.getItemData("reporting_date")).getStringValue("0");$("#reporting_date").val(q)}$(".register_num").text(g_AppInfo.appObj.application_no);var n=JSON.parse(COMM.getCookie(CONST.COOKIE.IPSAP_USER_INFO));$(".reviewer").text(spaceAddStr(n.name));{var i=e.getParentItemData("animal_type"),r=e.getParentItemData("animal_type_final"),l=e.getParentItemData("animal_type_bring"),d=e.getParentItemData("animal_sum").dataObj.saved_data.data,p=r.dataObj.saved_data.data;0==p.length&&(p=i.dataObj.saved_data.data);let v=l.dataObj.saved_data.data;if(v.length>0){function c(e){for(let t=0;t<p.length;++t)if(p[t].animal_code_str==e)return!0;return!1}for(let b=0;b<v.length;++b)c(v[b].animal_code_str)||p.push(v[b])}function _(e){return t[e]}function s(e){var t=0,a=0;for(let n=0;n<v.length;++n)v[n].animal_code_str==e&&(t+=parseInt(v[n].male_cnt),a+=parseInt(v[n].female_cnt));return{m:t,f:a}}var o=$(".list_table").eq(0).children("tbody"),m=$(".list_table").eq(1).children("tbody"),g=o.children("tr").first().clone(),u=m.children("tr").first().clone();o.empty().removeClass("hidden"),m.empty().removeClass("hidden");for(let I=0;I<d.length;++I){let x=s(d[I].animal_code_str);(f=g.clone()).children("td").eq(0).text(d[I].animal_code_str),f.children("td").eq(1).text(d[I].male_cnt),f.children("td").eq(2).text(d[I].female_cnt),f.children("td").eq(3).text(parseInt(d[I].male_cnt)+parseInt(d[I].female_cnt)),f.children("td").eq(4).text(x.m),f.children("td").eq(5).text(x.f),f.children("td").eq(6).text(x.m+x.f),f.children("td").eq(7).text(d[I].male_cnt-x.m),f.children("td").eq(8).text(d[I].female_cnt-x.f),f.children("td").eq(9).text(parseInt(d[I].male_cnt)+parseInt(d[I].female_cnt)-x.m-x.f),o.append(f)}for(let P=0;P<p.length;++P){let y=s(p[P].animal_code_str);{var f;(f=u.clone()).children("td").eq(0).text(p[P].animal_code_str);let S=p[P].male_cnt-y.m,A=p[P].female_cnt-y.f;if(S+A>0){f.children("td").eq(1).children("input").attr("max",S),f.children("td").eq(1).children("input").attr("placeholder","최대 "+S),f.children("td").eq(2).children("input").attr("max",A),f.children("td").eq(2).children("input").attr("placeholder","최대 "+A);let O=makeComboList("supplier_type_"+P,"<option selected disabled>종류 선택</option>",i.dataObj.codes,"supplier_type");f.children("td").eq(4).empty(),f.children("td").eq(4).append(O),f.children("td").eq(6).children("input").val();let N=_(P);null!=N&&(f.children("td").eq(1).children("input").val(N.male_cnt),f.children("td").eq(2).children("input").val(N.female_cnt),f.children("td").eq(3).children("input").val(Number(N.male_cnt)+Number(N.female_cnt)),f.children("td").eq(4).children("select").val(N.supplier_type).prop("selected",!0),f.children("td").eq(5).children("input").val(N.supplier_name),f.children("td").eq(6).children("input").val(N.genetic_type)),m.append(f)}}}$("input.check_change-01").on("keyup, change",(function(){let e=$(this).attr("max");if(null!=e){Number($(this).val())>Number(e)&&$(this).val(e);var t=$(this).parent().parent();let a=Number(t.children("td").eq(1).find("input").val())+Number(t.children("td").eq(2).find("input").val());t.children("td").eq(3).find("input").val(a)}}))}}function setAppChangeInfo(){urlPath=CONST.API.APPLICATION_CHANGE.ANIMALINFO,app_seq=g_AppItemParser.app_seq,API.load({url:urlPath.replace("${app_seq}",app_seq),type:CONST.API_TYPE.GET,success:function(e){if(!e)return;e.length>0&&$(".trace_label").removeClass("hidden");var t=$("#trace_changing").find(".changing-list").clone().clone();$("#trace_changing").empty();var a=1;let n=e;for(const[e,d]of Object.entries(n)){t.find(".list-num").text(a),a++,t.find(".list-date").text(d.approved_dttm);var i,r=JSON.parse(d.contents);i=t.find(".data").eq(1).children("div").first().clone(),t.find(".data").eq(1).empty(),t.find(".data").eq(2).text(r[2]),d.filepath?(t.find(".data").eq(3).text(d.org_file_name),t.find(".data").eq(3).attr("href",d.src)):t.find(".data").eq(3).text("");var l=JSON.parse(r[1]);for(let e=0;e<l.length;++e){let a=i.clone();a.find("span").eq(0).text(l[e][0]),a.find("span").eq(3).text(l[e][1]),a.find("span").eq(5).text(l[e][2]),a.find("span").eq(6).text(l[e][3]),a.find("span").eq(9).text(l[e][4]),a.find("span").eq(11).text(l[e][5]),t.find(".data").eq(1).append(a)}$("#trace_changing").append(t)}},error:function(){},complete:function(){}})}function onClickSubmit(){if(!$("#check_01").is(":checked"))return alert("제출 동의를 확인해 주세요."),void $("#check_01").focus();if(!$("#reporting_date").val())return alert("보고 일자를 선택해 주세요."),void $("#reporting_date").focus();var e=[];if($(".list_table").eq(1).children("tbody").children("tr").each((function(t,a){let n={animal_code:0,lmo_flag:0,animal_code_str:$(a).children("td").eq(0).text(),male_cnt:Number($(a).children("td").eq(1).find("input").val()),female_cnt:Number($(a).children("td").eq(2).find("input").val()),supplier_type:$(a).children("td").eq(4).find("select option:selected").val(),supplier_type_str:$(a).children("td").eq(4).find("select option:selected").text(),supplier_name:$(a).children("td").eq(5).find("input").val(),genetic_type:$(a).children("td").eq(6).find("input").val(),mb_grade:0,mb_grade_str:"",breeding_place:0,breeding_place_str:"",ibc_num:"",lmo_type:0,lmo_type_str:"",strain:"",week_age:0,weight_gram:0,age_unit:0,weight_unit:0,size:0,size_unit:0};if(n.male_cnt+n.female_cnt==0)return!0;e.push(n)})),0!=e.length){g_AppItemParser.targetSavedItemNames=[],g_AppItemParser.addMoreSaveTag("animal_type_bring",{data:e});var t={},a={};t[String(0)]=$("#additional_reporting").val(),a[String(0)]=$("#reporting_date").val(),g_AppItemParser.addMoreSaveTag("additional_reporting",{data:t}),g_AppItemParser.addMoreSaveTag("reporting_date",{data:a}),appItemSubmit(onCompleteSubmit,IPSAP.APP_SUBMIT_TYPE_PARAM.CHILD_SUBMIT)}else alert("반입신청한 내용이 없습니다.\n\n입력 내용중에 반입 수량을 확인하세요.")}function onCompleteSubmit(e,t,a){e?window.location.href="./experiment_list.html":alert(`반입보고서 제출을 실패했습니다.\n(${t.em})`)}"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof ipsap_item_module_js&&document.write("<script src='/assets/js/ipsap/ipsap_item_module.js'><\/script>"),document.write("<script src='/html/researcher/application_new-0.js'><\/script>"),$((function(){if(g_global_mapping=!1,loadApplicationParams(),$(".task_director_all").text(`(연구 책임자 : ${g_AppInfo.appObj.user_name})`),$(".task_title_ko").text(g_AppInfo.appObj.name_ko),IPSAP.DEMO_MODE)originalJSFunction(),$(".list_table tbody").removeClass("hidden");else{let e={"filter.query_items":"animal_type_bring,br_supplement,additional_reporting,reporting_date","filter.parent_items":"general_title,general_end_date,application_info,animal_type,animal_type_final,animal_type_bring,animal_sum"};g_AppItemParser=new ItemParser(g_AppInfo.childAppSeq),g_AppItemParser.load(e,dataMappingFunc)}setAppChangeInfo()}));