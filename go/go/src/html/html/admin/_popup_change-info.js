var changeInfoTemplate,changeMemberTemplate,changeEndDateTemplate;"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof ipsap_item_module_js&&document.write("<script src='/assets/js/ipsap/ipsap_item_module.js'><\/script>"),document.write("<script src='../researcher/application_new-0.js'><\/script>");const animal_is_seq=104,member_is_seq=111,end_date_is_seq=112;function dataMappingFunc(e){var t=e.getItemData("application_info");$(".register_num").text(t.getStringValue("application_no"));t=e.getParentItemData("general_title");$("#name_ko").text(t.getStringValue("name_ko")),$("#name_en").text(t.getStringValue("name_en")),$(".task_title_ko").text(g_AppInfo.appObj.name_ko+" "+g_AppInfo.appObj.sub_title);{t=e.getParentItemData("application_info");let a=Number(t.getStringValue("approved_dttm"));$("#approved_dttm").text(getDttm(a).dt)}t=e.getParentItemData("general_end_date");function a(e,t){for(let a=0;a<e.length;++a)if(e[a].is_seq==t)return e[a].contents;return"Error!!"}function n(e,t){for(let a=0;a<e.length;++a)if(e[a].file_idx==t)return e[a]}$("#general_end_date").text(t.getStringValue("0"));{var i=e.getItemData("ca_regular_file");let c=(t=e.getItemData("ca_regular_item")).dataObj.saved_data.data;for(const[e,o]of Object.entries(c)){let c=n(i.dataObj.saved_data.data,Number(e)),s=changeInfoTemplate.clone();s.find("span").eq(0).text("[정규]"),s.find("span").eq(1).text(a(t.dataObj.codes,Number(e)));var d,r=JSON.parse(o);104==Number(e)?(d=s.find(".data").eq(1).children("div").first().clone(),s.find(".data").eq(1).empty()):s.find(".data").eq(1).text(r[1]),s.find(".data").eq(2).text(r[2]),s.find("span").eq(2).text(IPSAP.APP_MAIN_TAG_NAME[r[0]]);var p=`newWindowPopup('./_popup_application-info.html#form_${r[0]}')`;if(s.find("a").first().attr("onclick",p),null==c?s.find(".data").eq(3).text(""):(s.find(".data").eq(3).text(c.org_file_name),s.find(".data").eq(3).attr("href",c.src)),104==Number(e)){var l=JSON.parse(r[1]);for(let e=0;e<l.length;++e){let t=d.clone();t.find("span").eq(0).text(l[e][0]),t.find("span").eq(3).text(l[e][1]),t.find("span").eq(5).text(l[e][2]),t.find("span").eq(6).text(l[e][3]),t.find("span").eq(9).text(l[e][4]),t.find("span").eq(11).text(l[e][5]),s.find(".data").eq(1).append(t)}}$("#change_application").append(s)}Object.keys(c).length>0?$("#btn_finish_review_fast").hide():$("#btn_finish_review").hide()}{i=e.getItemData("ca_fast_file");let d=(t=e.getItemData("ca_fast_item")).dataObj.saved_data.data;for(const[l,b]of Object.entries(d)){let d=n(i.dataObj.saved_data.data,Number(l));r=JSON.parse(b);let I={};var c=3;if(111==Number(l)){I=changeMemberTemplate.clone(),I.find(".data").eq(2).text(r[2]);var o=I.find(".data").find("tbody").eq(0),s=I.find(".data").find("tbody").eq(1),_=o.children("tr").eq(0),f=s.children("tr").eq(0);I.find(".data").find("tbody").empty();let t=CONST.API.APPLICATION_CHANGE.BEFORECHANGE_MEMBER,a=r[1];API.load({url:t.replace("${app_seq}",a),type:CONST.API_TYPE.GET,success:function(e){var t=[];for(let a=0;a<e.length;a++)t.push(e[a]);$.each(t,(function(e,t){var a=_.clone(),n=t.info;n.tmp_phoneno=n.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),1==t.user_seq?a.children("td").eq(0).find("input").prop("checked",!0):(a.children("td").eq(0).find("input").prop("checked",!1),a.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?a.children("td").eq(1).find("input").prop("checked",!0):(a.children("td").eq(1).find("input").prop("checked",!1),a.children("td").eq(1).find("input").prop("disabled",!0)),a.children("td").eq(2).text(n.name),a.children("td").eq(3).text(n.dept_str),a.children("td").eq(4).text(n.position_str),a.children("td").eq(5).text(n.major_field_str),a.children("td").eq(6).text(n.tmp_phoneno),a.children("td").eq(7).text(t.exp_year_code_str),o.append(a)}))},error:function(){},complete:function(){}});var m=[],g=e.getItemData("general_director");m.push(g.dataObj.saved_data.data[0]);for(var u=g.dataObj.saved_data.data[0].user_seq,h=e.getItemData("general_expt"),q=0;q<Object.keys(h.dataObj.saved_data.data).length;q++)m.push(h.dataObj.saved_data.data[q]);$.each(m,(function(e,t){var a=f.clone(),n=t.info;n.tmp_phoneno=n.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),u==t.user_seq?a.children("td").eq(0).find("input").prop("checked",!0):(a.children("td").eq(0).find("input").prop("checked",!1),a.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?a.children("td").eq(1).find("input").prop("checked",!0):(a.children("td").eq(1).find("input").prop("checked",!1),a.children("td").eq(1).find("input").prop("disabled",!0)),a.children("td").eq(2).text(n.name),a.children("td").eq(3).text(n.dept_str),a.children("td").eq(4).text(n.position_str),a.children("td").eq(5).text(n.major_field_str),a.children("td").eq(6).text(n.tmp_phoneno),a.children("td").eq(7).text(t.exp_year_code_str),s.append(a)}))}else if(112==Number(l)){var x;I=changeEndDateTemplate.clone();let t=CONST.API.APPLICATION_CHANGE.BEFORECHANGE_ENDDATE,a=r[1];API.load({url:t.replace("${app_seq}",a),type:CONST.API_TYPE.GET,success:function(t){var a=e.getParentItemData("application_info");let n=getTimeStrFromDateType(new Date(getDttm(Number(a.getStringValue("approved_dttm"))).dt));x=getTimeStrFromDateType(new Date(t[0][0]));var i=e.getItemData("general_end_date"),d=getTimeStrFromDateType(new Date(i.getStringValue("0")));I.find(".data").eq(2).text(n+"~"+x),I.find(".data").eq(3).text(n+"~"+d),I.find(".data").eq(4).text(r[2])},error:function(){},complete:function(){}}),c=5}else I=changeInfoTemplate.clone(),I.removeClass("regular_review"),I.addClass("simple_review"),I.find(".blue_deep").addClass("green"),I.find(".blue_deep").removeClass("blue_deep"),I.find("span").eq(0).text("[신속]"),I.find("span").eq(1).text(a(t.dataObj.codes,Number(l))),I.find(".data").eq(1).text(r[1]),I.find(".data").eq(2).text(r[2]),I.find("span").eq(2).text(IPSAP.APP_MAIN_TAG_NAME[r[0]]);null==d?I.find(".data").eq(c).text(""):(I.find(".data").eq(c).text(d.org_file_name),I.find(".data").eq(c).attr("href",d.src));p=`newWindowPopup('./_popup_application-info.html#form_${r[0]}')`;I.find("a").first().attr("onclick",p),$("#change_application").append(I)}}}$((function(){g_global_mapping=!1,loadApplicationParams();var e=$.urlParam("as");if(IPSAP.DEMO_MODE);else{$(".task_director_all").text(`(연구 책임자 : ${g_AppInfo.appObj.user_name})`),changeInfoTemplate=$("#change_application").children("ul").first().clone(),changeMemberTemplate=$("#change_application").children("ul").eq(2).clone(),changeEndDateTemplate=$("#change_application").children("ul").eq(3).clone(),$("#change_application").empty(),$("#change_application").removeClass("hidden");let t={"filter.query_items":"change_application,application_info","filter.parent_items":"general_title,general_end_date,application_info,general_director,general_expt"};g_AppItemParser=new ItemParser(e),g_AppItemParser.load(t,dataMappingFunc)}}));