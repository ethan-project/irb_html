"undefined"==typeof ipsap_common_js&&document.write("<script src='/assets/js/ipsap/ipsap_common.js'><\/script>"),"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof ipsap_application_common_js&&document.write("<script src='/assets/js/ipsap/ipsap_application_common.js'><\/script>");var inst_seq=COMM.getStor("inst_seq");function getListPayment(){$("#modal_payment_history").find("tbody").empty();let e=CONST.API.INSTITUTION.LIST_PAYMENT;API.load({url:e.replace("${inst_seq}",inst_seq),type:CONST.API_TYPE.GET,success:function(e){$.each(e.value,(function(e,t){let o="",a="";[1,2].indexOf(t.order_type)>-1?(o="approved",a="승인"):(o="canceled",a="취소");let d="";"CARD"==t.pay_method?d="신용카드":"BANK"==t.pay_method&&(d="계좌이체"),$("#modal_payment_history").find("tbody").append(`<tr data-url="./payment_list-info.html" data-order="${t.order_seq}" class="${o}">\n            <td>${moment(t.auth_date,"YY-MM-DD hh:mm:ss").format("YYYY-MM-DD hh:mm:ss")}</td>\n            <td class="ipsapNo">${t.moid}</td>\n            <td>${t.pname}</td>\n            <td class="text-right pRight10">${setComma(t.amount)}</td>\n            <td class="text-center">${d}</td>\n            <td class="status">${a}</td>\n          </tr>`)}))},complete:function(){$.fn.dataTable.isDataTable("#datatable")?(setTriggerTrDataUrlOnClick(),$("#modal_payment_history").modal("show")):(initDataTable("#datatable"),setTriggerTrDataUrlOnClick(),$("#modal_payment_history").modal("show"))}})}moment.locale("ko",{weekdays:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],weekdaysShort:["일","월","화","수","목","금","토"]}),$((function(){IPSAP.DEMO_MODE?$("#bodyForm").removeClass("hidden"):(API.load({url:eval("`"+CONST.API.INSTITUTION.DETAIL+"`"),type:CONST.API_TYPE.GET,success:function(e){if(0==Number(e.service_status)?($(".org_status").eq(0).removeClass("hidden"),$(".using_period, .using_dday, .used_period").addClass("hidden")):1==Number(e.service_status)?($(".org_status").eq(1).removeClass("hidden"),$(".using_period").text(`: ${moment(e.expiration_date,"YYYYMMDD").format("YYYY-MM-DD (ddd)")} 까지 이용가능`),$(".using_dday").text(`(D ${moment().diff(moment(e.expiration_date),"days")}일)`),$(".used_period").addClass("hidden")):2==Number(e.service_status)?($(".org_status").eq(2).removeClass("hidden"),$(".using_period, .using_dday").addClass("hidden"),$(".used_period").text(`: ${moment(e.expiration_date,"YYYYMMDD").format("YYYY-MM-DD (ddd)")} 까지 이용`)):($(".org_status").eq(3).removeClass("hidden"),$(".using_period, .using_dday").addClass("hidden"),$(".used_period").text(`: ${moment(e.expiration_date,"YYYYMMDD").format("YYYY-MM-DD (ddd)")} 까지 이용`)),e.institution_type.length>0){let t=$(`input:radio[name="org_type"][value="${e.institution_type}"]`);t.prop("checked","checked"),t.prop("readonly","readonly"),$(`input:radio[name="org_type"][value!="${e.institution_type}"]`).prop("disabled","disabled")}$(".formrow1").children().find(".data").text(e.name_ko),$(".formrow2").children().find(".data").text(e.name_en),$(".formrow3").children().find(".data").text(e.institution_code);let t=`(${e.zipcode}) ${e.addr1} ${e.addr2}`;$(".formrow4").children().find(".data").text(t),$(".formrow5").children().find(".data").html(`<a href="${e.homepage_url}" target="_blank">${e.homepage_url}</a>`),e.logo_file_src?($(".formrow6").children().find(".data").eq(0).html(`<a href="${e.logo_file_src}" target="_blank"><img src="${e.logo_file_src}" id="org_logo_file"></a>`),$("#org_logo_file").on({load:e=>{if($("#org_logo_file_size").length){let e=$("#org_logo_file").width(),t=$("#org_logo_file").height();$("#org_logo_file_size").text(`${e}px X ${t}px`)}else $("#org_logo_file_size").text("File 없음")}})):($(".formrow6").children().find(".data").eq(0).html(""),$(".formrow6").children().find("#org_logo_file_size").parent().html(""));var o=$(".man_div").clone();if($(".man_div").remove(),$.each(e.user_list,(function(e,t){var a=o.clone();a.find(".formrow7").children().find(".data").eq(0).text(t.user_name),a.find(".formrow7").children().find(".data").eq(1).text(t.user_name_en),a.find(".formrow8").children().find(".data").text(t.email),a.find(".formrow9").children().find(".data").eq(0).text(t.dept_str),a.find(".formrow9").children().find(".data").eq(1).text(t.position_str),a.find(".formrow10").children().find(".data").eq(0).text(t.telno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3")),a.find(".formrow10").children().find(".data").eq(1).text(t.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3")),"1"==t.agree_email&&a.find(".agree_email").prop("checked",!0),"1"==t.agree_sms&&a.find(".agree_sms").prop("checked","checked"),"1"==t.agree_pri_open&&a.find(".agree_info").prop("checked","checked"),$("#officer_list").append(a)})),e.judge_type.length>0){let t=[];t.push(e.judge_type.split(",")),$.each(t[0],(function(e,t){let o=$(`input:checkbox[name="evaluation_type"][value="${t}"]`);o.attr("checked",!0),o.attr("readonly",!0)})),$('input:checkbox[name="evaluation_type"]').not(":checked").attr("disabled",!0)}if(1==e.ia_evaluation_method?($("#org_rule_1_1").prop("checked","checked"),$("#org_rule_1_1").prop("readonly","readonly"),$("#org_rule_1_2").prop("disabled","disabled"),$("#org_rule_1_3").prop("disabled","disabled"),$("#IACUC_agree_point").val(e.ia_base_score),$("#IACUC_agree_count").val("")):2==e.ia_evaluation_method?($("#org_rule_1_2").prop("checked","checked"),$("#org_rule_1_2").prop("readonly","readonly"),$("#org_rule_1_1").prop("disabled","disabled"),$("#org_rule_1_3").prop("disabled","disabled"),$("#IACUC_agree_count").val(e.ia_base_item),$("#IACUC_agree_point").val("")):($("#org_rule_1_3").prop("checked","checked"),$("#org_rule_1_3").prop("readonly","readonly"),$("#org_rule_1_1").prop("disabled","disabled"),$("#org_rule_1_2").prop("disabled","disabled"),$("#IACUC_agree_point").val(""),$("#IACUC_agree_count").val("")),$("#IACUC_agree_point").prop("disabled",!0),$("#IACUC_agree_count").prop("disabled",!0),1==e.ia_final_director?($("#org_rule_2_1").prop("checked","checked"),$("#org_rule_2_1").prop("readonly","readonly"),$("#org_rule_2_2").prop("disabled","disabled")):($("#org_rule_2_2").prop("checked","checked"),$("#org_rule_2_2").prop("readonly","readonly"),$("#org_rule_2_1").prop("disabled","disabled")),$(".formrow14").children().find(".data").eq(0).text(e.business_num),$(".formrow14").children().find(".data").eq(1).html(`<a href="${e.business_file_src}" target="_blank">${e.business_file_org_name}</a>`),e.payment_method.length>0){let t=e.payment_method.split(",");$.each(t,(function(e,t){let o=$(`input:checkbox[name="payment_type"][value="${t}"]`);o.attr("checked",!0),o.attr("readonly",!0)})),$('input:checkbox[name="payment_type"]').not(":checked").attr("disabled",!0)}if(e.invoice_flag.length>0){let t=$(`input:radio[name="org_invoice"][value="${e.invoice_flag}"]`);t.prop("checked","checked"),t.prop("readonly","readonly"),$(`input:radio[name="org_invoice"][value!="${e.invoice_flag}"]`).prop("disabled","disabled")}$("#bodyForm").removeClass("hidden")},complete:function(){}}),$("#btn_payment_history").on("click",(function(e){e.stopPropagation(),getListPayment()})))}));