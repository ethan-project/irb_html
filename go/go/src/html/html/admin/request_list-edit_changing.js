"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof date_utils_js&&document.write("<script src='/assets/js/common/util/date_utils.js'><\/script>"),"undefined"==typeof ipsap_item_module_js&&document.write("<script src='/assets/js/ipsap/ipsap_item_module.js'><\/script>");var reqsvc_seq=IPSAP.getStor("reqsvc_seq");function getInfo(){API.load({url:eval("`"+CONST.API.REQUEST.DETAIL+"`"),type:CONST.API_TYPE.GET,success:function(e){var a="";e.tmp_approved_dttm=getDttm(e.approved_dttm),e.tmp_phoneno=e.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),e.tmp_telno=e.telno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),a="0"==e.request_status?"미처리":"1"==e.request_status?"처리중":"2"==e.request_status?`처리보류: ${e.tmp_approved_dttm.dt}`:`처리완료: ${e.tmp_approved_dttm.dt}`,$(".apptype_date").text(a),$(".req_memo").text(e.approved_comment),$("#org_registration_num").val(`${e.business_num}`),$("label.custom-file-label").text(`${e.business_file_org_name}`);var r=e.payment_method.split(",");if($('input:checkbox[name="payment_type"]').each((function(){-1!=$.inArray(this.value,r)?this.checked=!0:this.checked=!1})),"1"==e.invoice_flag?$('input:radio[name="org_invoice"][value="1"]').prop("checked",!0):$('input:radio[name="org_invoice"][value="2"]').prop("checked",!0),e.institution_type.length>0){let a=$(`input:radio[name="org_type"][value="${e.institution_type}"]`);a.prop("checked","checked"),a.prop("readonly","readonly"),$(`input:radio[name="org_type"][value!="${e.institution_type}"]`).prop("disabled","disabled")}$(".formrow1").find("span.data").text(`${e.name_ko}`),$(".formrow2").find("span.data").text(`${e.name_en}`),$(".formrow3").find("span.data").text(`${e.institution_code}`),$(".formrow4").find("span.data").text(`(${e.zipcode}) ${e.addr1} ${e.addr2}`),$(".formrow5").find("span.data").html(`<a href="${e.homepage_url}" target="_blank">${e.homepage_url}</a>`),$(".formrow6").find("span.data").html(`<a href="${e.logo_file_src}" target="_blank"><img src="${e.logo_file_path}" id="org_logo_file"></a>`),$(".formrow7").find("span.data").eq(0).text(`${e.user_name}`),$(".formrow7").find("span.data").eq(1).text(`${e.user_name_en}`),$(".formrow8").find("span.data").text(`${e.email}`),$(".formrow9").find("span.data").eq(0).text(`${e.dept_str}`),$(".formrow9").find("span.data").eq(1).text(`${e.position_str}`),$(".formrow10").find("span.data").eq(0).text(`${e.tmp_telno}`),$(".formrow10").find("span.data").eq(1).text(`${e.tmp_phoneno}`),"1"==e.agree_email?($("#agree_email").prop("checked",!0),$("#agree_email").prop("readonly",!0)):($("#agree_email").prop("checked",!1),$("#agree_email").prop("disabled",!0)),"1"==e.agree_sms?($("#agree_sms").prop("checked",!0),$("#agree_sms").prop("readonly",!0)):($("#agree_sms").prop("checked",!1),$("#agree_sms").prop("disabled",!0)),"1"==e.agree_pri_open?($("#agree_info").prop("checked",!0),$("#agree_info").prop("readonly",!0)):($("#agree_info").prop("checked",!1),$("#agree_info").prop("disabled",!0));var t=e.judge_type.split(",");$('input:checkbox[name="evaluation_type"]').each((function(){-1!=$.inArray(this.value,t)?(this.checked=!0,this.readOnly=!0):(this.checked=!1,this.disabled=!0)})),"1"==e.ia_evaluation_method?($('input:radio[name="org_rule_1"][value="1"]').prop("checked",!0),$('input:radio[name="org_rule_1"][value="1"]').prop("readonly",!0),$('input:radio[name="org_rule_1"][value="2"]').prop("checked",!1),$('input:radio[name="org_rule_1"][value="2"]').prop("disabled",!0),$("#IACUC_agree_point").val(`${e.ia_base_score}`),$("#IACUC_agree_point").prop("readonly",!0),$("#IACUC_agree_count").prop("disabled",!0)):($('input:radio[name="org_rule_1"][value="2"]').prop("checked",!0),$('input:radio[name="org_rule_1"][value="2"]').prop("readonly",!0),$('input:radio[name="org_rule_1"][value="1"]').prop("checked",!1),$('input:radio[name="org_rule_1"][value="1"]').prop("disabled",!0),$("#IACUC_agree_count").val(`${e.ia_base_item}`),$("#IACUC_agree_count").prop("readonly",!0),$("#IACUC_agree_point").prop("disabled",!0)),"1"==e.ia_final_director?($('input:radio[name="org_rule_2"][value="1"]').prop("checked",!0),$('input:radio[name="org_rule_2"][value="1"]').prop("readonly",!0),$('input:radio[name="org_rule_2"][value="2"]').prop("disabled",!0)):($('input:radio[name="org_rule_2"][value="2"]').prop("checked",!0),$('input:radio[name="org_rule_2"][value="2"]').prop("readonly",!0),$('input:radio[name="org_rule_2"][value="1"]').prop("disabled",!0))},error:function(e){}})}function serviceSave(){var business_file=$("#org_registration_file")[0].files[0],payment_method_arr=[];$('input:checkbox[name="payment_type"]').each((function(){this.checked&&payment_method_arr.push(this.value)}));var paymentObj=new Object;paymentObj.business_num=$("#org_registration_num").val().replaceAll("-",""),paymentObj.invoice_flag=parseInt($("input:radio[name=org_invoice]:checked").val()),paymentObj.payment_method=payment_method_arr.toString();var sendingJson=JSON.stringify(paymentObj),formData=new FormData;formData.append("business_file",business_file),formData.append("param",sendingJson),API.load({url:eval("`"+CONST.API.REQUEST.PATCH+"`"),type:CONST.API_TYPE.PATCH,enctype:"multipart/form-data",data:formData,contentType:!1,processData:!1,success:function(e){window.location.replace("./request_list-info_changing.html")},error:function(e){$("#modal_error_code").text(e.responseText),$("#modal_register_error").modal("show")}})}$((function(){if(!IPSAP.DEMO_MODE){var e=$(".page-content");$("#org_registration_file").on("change",(function(){!function(){var a=e.find("#bodyForm").find("#org_registration_file")[0].files[0];if(""!=$("#org_registration_file").val()){let e=a.name.split(".").pop().toLowerCase();if(-1==$.inArray(e,["jpg","png","jpeg","ico","tiff","svg","pdf"]))return alert(".jpg, .png, .pdf, .tiff 등 이미지 파일 형식으로 첨부해 주십시오."),void $("#org_registration_file").val("");if(a.size>20971520)$("#modal_file_alert").modal("show"),$("#org_registration_file").val("")}}()})),$("#btn_save").on("click",(function(){serviceSave()})),getInfo()}}));