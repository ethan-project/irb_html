"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>");var g_inst_seq,user_seq=IPSAP.getStor("user_seq");function getInfoMember(){if(IPSAP.DEMO_MODE)$(".card").removeClass("hidden");else{var e=CONST.API.USER.DETAIL;API.load({url:e.replace("${user_seq}",user_seq),type:CONST.API_TYPE.GET,success:function(e){g_inst_seq=e.institution_seq,$(".org_name_kr").text(e.institution_name_ko),$(".org_name_en").text(e.institution_name_en),$(".org_code").text(e.institution_code);let t=e.user_type.split(","),n=t.length;for(var a=0;a<n;a++)$('input:checkbox[name="auth"]').each((function(){t[a]==this.value&&(this.checked=!0)}));switch($(".dept").val(e.dept_str),$(".position").val(e.position_str),$(".major").val(e.major_field_str),parseInt(e.user_status)){case 2:$("#usr_status_1").attr("checked",!0);break;case 4:$("#usr_status_2").attr("checked",!0);break;case 5:$("#usr_status_3").attr("checked",!0)}$(".man_name").text(e.name),$(".man_phone").val(e.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3")),$(".man_email").text(e.email),"1"==e.agree_email&&$("#agree_to_receive-email").prop("checked","checked"),"1"==e.agree_sms&&$("#agree_to_receive-sms").prop("checked","checked"),"1"==e.agree_pri_open&&$("#agree_to_open-info").prop("checked","checked"),$("#training_date").val(e.edu_date.replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3")),$(".edu_inst").val(e.edu_institution_str),$(".edu_num").val(e.edu_course_num),$(".card").removeClass("hidden")},complete:function(){userAuthCheckInit(),userAuthCheckchange()}})}}function userAuthCheckInit(){$("#auth_05").is(":checked")&&$("#auth_04").prop("disabled",!0),$("#auth_04").is(":checked")&&$("#auth_05").prop("disabled",!0)}function userAuthCheckchange(){var e=$('input:checkbox[name="auth"]');$(e).on("change",(function(){e.eq(3).is(":checked")?e.eq(4).prop("disabled",!0):e.eq(4).prop("disabled",!1),e.eq(4).is(":checked")?e.eq(3).prop("disabled",!0):e.eq(3).prop("disabled",!1)}))}function initPw(){if(!IPSAP.DEMO_MODE){var e=CONST.API.ADMIN.PATCH_PASS;API.load({url:e.replace("${user_seq}",user_seq),type:CONST.API_TYPE.PATCH,success:function(e){$("#modal_init_pw").modal("hide")},error:function(e){}})}}function setInstList(){var e=$("#modal_all_joining").find(".info_table").eq(0).clone();$("#modal_all_joining").find(".modal-body").empty();var t=CONST.API.PLATFORM.REGI_USER_INST_LIST;API.load({url:t.replace("${user_seq}",user_seq),type:CONST.API_TYPE.GET,success:function(t){$("#modal_all_joining").find(".modal-body").append('<div class="text-center">\n        현재 접속한 기관 외에 내가 소속된 타기관 목록입니다. <span class="blue_vivid">소속 기관 정보 보기</span>를 클릭하여 해당 기관의 사용자 정보를 확인할 수 있습니다.\n      </div>'),$.each(t,(function(t,n){var a=e.clone();a.find(".modal_org_name").text(n.institution_name_ko),a.find(".modal_org_name_en").text(n.institution_name_en),a.find("button").attr("onclick",`change_user_info(${n.user_seq})`),a.find(".modal_org_code").text(n.institution_code);let s="",i=[];i.push(n.user_type_str.split(",")),$.each(i[0],(function(e,t){s+='<span class="label auth_label">',s+=t+"</span>"})),a.find(".modal_org_label").html(s),a.find(".modal_org_dept").text(n.dept_str),a.find(".modal_org_position").text(n.position_str),a.find(".modal_org_major").text(n.major_field_str),$("#modal_all_joining").find(".text-center").after(a)}))}})}function change_user_info(e){IPSAP.setStor("user_seq",e),location.replace("./user_list-edit.html")}function setInfoMember(){$("#btn_save").on("click",(function(){var e=new Object;$("#agree_to_receive-email").is(":checked")?e.agree_email=parseInt($("#agree_to_receive-email").val()):e.agree_email=0,$("#agree_to_open-info").is(":checked")?e.agree_pri_open=parseInt($("#agree_to_open-info").val()):e.agree_pri_open=0,$("#agree_to_receive-sms").is(":checked")?e.agree_sms=parseInt($("#agree_to_receive-sms").val()):e.agree_sms=0,e.dept=$(".dept").val(),e.edu_course_num=$(".edu_num").val(),e.edu_date=$("#training_date").val().replaceAll("-",""),e.edu_institution=$(".edu_inst").val(),e.major_field=$(".major").val(),e.phoneno=$(".man_phone").val().replaceAll("-",""),e.position=$(".position").val();let t=[];$('input:checkbox[name="auth"]').each((function(){this.checked&&t.push(this.value)})),e.user_type=t.toString(),e.user_status=parseInt($('input:radio[name="usr_status"]:checked').val()),e.user_seq=user_seq,e.institution_seq=parseInt(g_inst_seq);var n=e;API.load({url:CONST.API.PLATFORM.REGI_USER_PATCH,type:CONST.API_TYPE.PATCH,data:n,success:function(e){$("#modal_saved").modal("show")},error:function(e){}})}))}$((function(){$(".page-content");getInfoMember(),setInstList(),$("#btn_init_pw").on("click",(function(){initPw()})),setInfoMember()}));