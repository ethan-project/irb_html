"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>");var instArr=[];function getInstList(){API.load({url:CONST.API.INSTITUTION.LIST,type:CONST.API_TYPE.GET,success:function(e){for(var t=0;t<e.length;t++){var s=new Object;s.inst_code=e[t].institution_code,s.institution_seq=e[t].institution_seq,instArr.push(s)}},complete:function(){}})}function fileUpLoad(e){var t=new FileReader;t.onload=function(){var e=t.result,s=XLSX.read(e,{type:"binary"}),r=s.SheetNames[0],n=s.Sheets[r];var i=XLSX.utils.sheet_to_json(n,{header:["institution_code","user_type1","user_type2","user_type3","user_type4","user_type5","phoneno","email"]});i=i.splice(1);var u=[];if($.each(i,(function(e,t){var s=[],r="",n="",i="",o="",p="",_="";if($.each(instArr,(function(e,s){if(t.institution_code==s.inst_code)return _=s.institution_seq,!1})),""==_)return!1;if("y"==t.user_type1)r="1",s.push(r);else if("y"!=t.user_type1&&"n"!=t.user_type1)return!1;if("y"==t.user_type2)n="2",s.push(n);else if("y"!=t.user_type2&&"n"!=t.user_type2)return!1;if("y"==t.user_type3)i="3",s.push(i);else if("y"!=t.user_type3&&"n"!=t.user_type3)return!1;if("y"==t.user_type4)o="4",s.push(o);else if("y"!=t.user_type4&&"n"!=t.user_type4)return!1;if("y"==t.user_type5)p="5",s.push(p);else if("y"!=t.user_type5&&"n"!=t.user_type5)return!1;var a={email:t.email,institution_seq:parseInt(_),phoneno:t.phoneno.replaceAll("-",""),user_type:s.toString()};u.push(a)})),i.length!=u.length)return $("#modal_new_user").modal("hide"),alert("Excel 파일 내 데이터 값이 유효하지 않습니다."),!1;var o={userArr:u};API.load({url:CONST.API.PLATFORM.REGI_USER_CREATE_BATCH,type:CONST.API_TYPE.POST,data:o,success:function(e){window.location.href="./user_list.html"},error:function(e){$("#modal_new_user").modal("hide"),$("#failure_message").text(e.responseJSON.em),$("#modal_failure").modal("show")}})},t.readAsBinaryString(e)}$((function(){$(".page-content");$("#btn_register_batch").on("click",(function(){fileUpLoad($("#register_member_file")[0].files[0])})),getInstList()}));