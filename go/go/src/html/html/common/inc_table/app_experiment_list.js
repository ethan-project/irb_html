var saved_list;"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>");var btnClass="",btnText="";function loadApprovedApplicationList(t,a,e){var s=location.search,i=new URLSearchParams(s),n=i.get("filter.start_index"),p=i.get("search_words"),_=0;n&&(_=n);var P=e,A={"filter.app_view_type":a};A["filter.start_index"]=_,A["filter.row_cnt"]=P,A.search_words=p;let r=$("#datatable").find("tbody");r.empty(),API.load({url:CONST.API.APPLICATION.LIST_APPROVED,type:CONST.API_TYPE.GET,data:A,success:function(t){var a="";$.each(t.list,(function(e,s){switch(saved_list=t.list,parseInt(s.application_step)){case IPSAP.APPLICATION_STEP.WRITE:if(parseInt(s.application_result)===IPSAP.APPLICATION_RESULT.SUPPLEMENT)a="supplement";break;case IPSAP.APPLICATION_STEP.FINAL:if(parseInt(s.application_result)===IPSAP.APPLICATION_RESULT.REJECT)a="denied";break;case IPSAP.APPLICATION_STEP.PERFORMANCE:switch(parseInt(s.application_result)){case IPSAP.APPLICATION_RESULT.EXPERIMENT_ING_A:a=0==s.check_user_seq?"inProgress":"inProgress, assigned";break;case IPSAP.APPLICATION_RESULT.EXPERIMENT_ING_AC:a="inProgress",a=0==s.check_user_seq?"inProgress":"inProgress, assigned";break;case IPSAP.APPLICATION_RESULT.TASK_FINISH:a="completed";break;case IPSAP.APPLICATION_RESULT.EXPERIMENT_FINISH:a="closed"}}parseInt(s.application_result)==IPSAP.APPLICATION_RESULT.JUDGE_DELAY&&(a="delayed"),$.each(s.sub_list,(function(t,i){i.tmp_approved_dttm=getDttm(i.approved_dttm),r.append(`\n          <tr data-url="" onclick='onClickApplication(${e}, ${t}, ${i.judge_type}, ${i.application_type})' class="${i.judge_type_str}">\n            <td>${s.application_seq}</td>\n            <td>${s.name_ko}</td>\n            <td class="title noIcon" data-title="${s.name_ko}">${i.sub_title}</td>\n            <td>${i.application_no}</td>\n            <td>${i.tmp_approved_dttm.dt}</td>\n            <td class="committee_color thick">${i.judge_type_str}</td>\n            <td>${i.application_type_str}</td>\n            <td>${i.application_step_str}</td>\n            <td class="status">${i.application_result_str}</td>\n            <td>${i.user_name}</td>\n            <td>${i.istt_name_ko}</td>\n            <td>${i.user_dept_str}</td>\n          </tr>`);let n=i.application_no.split("-");n.pop();let p=n.join("-");r.children().last().data({appno:p,period:`${s.approved_dttm} ~ ${s.general_end_date}`,key:s.application_seq,status:a})}))}));var e=t.pageInfo.totalCnt;t=0;if(e>(t=0==_?P*(_+1):P+parseInt(_))&&setBlockBtn("next",t,P),_>0&&setBlockBtn("before",t,P,_),e>t||_>0){let t=$(".search_form"),a=$(".dataTables_filter");setServerSearch(t,a)}initDataTable("#datatable")},complete:function(){}})}function modalAssign(t){$("#other-staff").empty();var a=CONST.API.APPLICATION.INSPECTOR;API.load({url:a.replace("${app_seq}",t),type:CONST.API_TYPE.GET,success:function(a){$.each(a,(function(a,e){var s="",i="";"참여"==e.join_str?(s='<tr data-url="" class="tippy-btn researcher" title="실험 참여자는 점검위원으로 지정할 수 없습니다." data-tippy-placement="top-start" data-tippy-animation="shift-away" data-tippy-arrow="true">',i=""):1==e.selected?(s='<tr data-url="" class="tippy-btn assigned" title="현재 점검위원입니다." data-tippy-placement="top-start" data-tippy-animation="shift-away" data-tippy-arrow="true">',i='<span class="mLeft5">[현 점검위원]</span>'):(s=`<tr data-url="" onclick='setInspector(${t},${e.user_seq})'>`,i=""),$("#other-staff").append(`\n        ${s}\n          <td>${e.join_str}</td>\n          <td class="text-left">${e.user_type_str.replace(/,/gi,", ")}${i}</td>\n          <td>${e.name}</td>\n          <td>${e.dept_str}</td>\n          <td>${e.position_str}</td>\n          <td>${e.major_field_str}</td>\n          <td>${e.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3")}</td>\n          <td>${e.email}</td>\n          <td>${e.edu_course_num}</td>\n        </tr>`)})),$(".tippy-btn").each((function(t,a){tippy(a,{arrow:!0})}))},complete:function(){}}),$("#modal_assign").modal("show")}function setInspector(t,a){var e=CONST.API.APPLICATION.PATCH_INSPECTOR;e=(e=e.replace("${app_seq}",t)).replace("${user_seq}",a),API.load({url:e,type:CONST.API_TYPE.PATCH,success:function(t){}}),$("#modal_assign").modal("hide"),location.reload()}function onClickApplication(t,a,e,s){switch(e){case IPSAP.JUDGE_TYPE.IACUC:switch(s){case IPSAP.APPLICATION_TYPE.NEW:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./application_list-info.html");break;case IPSAP.APPLICATION_TYPE.CHANGE:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./experiment_list-info_change.html");break;case IPSAP.APPLICATION_TYPE.RENEW:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./experiment_list-info_renew.html");break;case IPSAP.APPLICATION_TYPE.BRING:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./experiment_list-info_bring.html");break;case IPSAP.APPLICATION_TYPE.CHECKLIST:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./experiment_list-info_inspection.html");break;case IPSAP.APPLICATION_TYPE.END:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./experiment_list-info_end.html")}break;case IPSAP.JUDGE_TYPE.IRB:switch(s){case IPSAP.APPLICATION_TYPE.NEW:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./IRB/application_list-IRB_info.html");break;case IPSAP.APPLICATION_TYPE.CHANGE:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./IRB/experiment_list-IRB_info_change.html");break;case IPSAP.APPLICATION_TYPE.MAINTANACE:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./IRB/experiment_list-IRB_info_renew.html");break;case IPSAP.APPLICATION_TYPE.ADVERSE:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./IRB/experiment_list-IRB_info_adverse.html");break;case IPSAP.APPLICATION_TYPE.VIOLATION:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./IRB/experiment_list-IRB_info_violation.html");break;case IPSAP.APPLICATION_TYPE.PROBLEM_OCCUR:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./IRB/experiment_list-IRB_info_problem.html");break;case IPSAP.APPLICATION_TYPE.END:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./IRB/experiment_list-IRB_info_end.html")}break;case IPSAP.JUDGE_TYPE.IBC:switch(s){case IPSAP.APPLICATION_TYPE.NEW:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./IBC/application_list-IBC_info.html");break;case IPSAP.APPLICATION_TYPE.CHANGE:g_AppInfo.initWithAppObj(saved_list[t].sub_list[a]),g_AppInfo.saveParamsAndNavigate("./IBC/experiment_list-IBC_info_change.html")}break;default:alert("아직 지원하지 않는 심사유형입니다.")}}