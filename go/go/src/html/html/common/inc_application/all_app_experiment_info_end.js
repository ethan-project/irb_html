var changeInfoTemplate;function loadApplicationExperimentInfoEnd(){if(IPSAP.DEMO_MODE)e();else{g_AppInfo.loadParams();let t={"filter.query_items":"end_app_summary,final_judge_result,application_info","filter.parent_items":"general_title,general_end_date,application_info,animal_sum,pain_grage,euthanasia_method"};g_AppItemParser=new ItemParser(g_AppInfo.childAppSeq),g_AppItemParser.load(t,(function(t){var a="",n=t.getParentItemData("general_title");$("#name_ko").text(n.getStringValue("name_ko")),$("#name_en").text(n.getStringValue("name_en"));{n=t.getParentItemData("application_info");let e=Number(n.getStringValue("approved_dttm"));$("#approved_dttm").text(getDttm(e).dt),a=getDttm(e).dt+" ~ ";let d=n.getStringValue("application_no");""!=d&&($(".register_num").text(d),$(".register_num2").text(d))}n=t.getParentItemData("general_end_date");$("#general_end_date").text(n.getStringValue("0")),a+=n.getStringValue("0");var d=t.getItemData("end_app_summary"),r=JSON.parse(d.getStringValue("0")),i=$(".list_table").eq(0).children("tbody");i.children("tr").eq(0).children("td").eq(1).text(a),i.children("tr").eq(0).children("td").eq(2).text(r[0]);var p=[],l=[],c=0,_=t.getParentItemData("animal_sum").dataObj.saved_data.data;for(let e=0;e<_.length;++e)p.push(_[e].animal_code_str),isInArray(l,_[e].mb_grade_str)||l.push(_[e].mb_grade_str),c+=parseInt(_[e].male_cnt),c+=parseInt(_[e].female_cnt);i.children("tr").eq(1).children("td").eq(1).text(p.join()),i.children("tr").eq(1).children("td").eq(2).text(r[1]),i.children("tr").eq(2).children("td").eq(1).text(l.join()),i.children("tr").eq(2).children("td").eq(2).text(r[2]),i.children("tr").eq(3).children("td").eq(1).text(c),i.children("tr").eq(3).children("td").eq(2).text(r[3]);var s=t.getParentItemData("pain_grage"),o=String.fromCharCode(64+Number(s.dataObj.saved_data.data[0].select_ids[0]));i.children("tr").eq(4).children("td").eq(1).text(o),i.children("tr").eq(4).children("td").eq(2).text(r[4]);var m=t.getParentItemData("euthanasia_method"),f=getValueFromCode(m.dataObj.items,m.dataObj.saved_data.data[0].select_ids[0]);i.children("tr").eq(5).children("td").eq(1).text(f),i.children("tr").eq(5).children("td").eq(2).text(r[5]),i.children("tr").eq(6).children("td").eq(2).text(r[6]),$(".agree_date").eq(0).text(getDate(g_AppInfo.appObj.submit_dttm)),$(".reviewer").eq(0).text(spaceAddStr(g_AppInfo.appObj.user_name)),$(".task_title_ko").text(g_AppInfo.appObj.name_ko),$(".task_director_all").text(`(연구 책임자 : ${g_AppInfo.appObj.user_name})`);let h=$(".card-footer").children().eq(0),g=$(".card-footer").children().eq(1),q=$(".card-footer").children().eq(2),I=g.add(q),P=$(".card-footer").children().eq(3);switch(parseInt(g_AppInfo.appObj.application_result)){case IPSAP.APPLICATION_RESULT.SUPPLEMENT:$(".apptype_date").text("보완중"),h.remove(),I.remove(),P.remove();break;case IPSAP.APPLICATION_RESULT.CHECKING:case IPSAP.APPLICATION_RESULT.CHECKING_2:$(".apptype_date").text("검토중"),h.remove(),I.remove(),P.remove();break;case IPSAP.APPLICATION_RESULT.JUDGE_ING:case IPSAP.APPLICATION_RESULT.JUDGE_ING_2:$(".apptype_date").text("심사중"),h.remove(),I.remove(),P.remove();break;case IPSAP.APPLICATION_RESULT.DECISION_ING:$(".apptype_date").text("심의중"),h.remove(),I.remove(),P.remove();break;case IPSAP.APPLICATION_RESULT.REJECT:$(".apptype_area").addClass("denied"),$(".apptype_date").text("반려"),h.remove(),I.remove(),P.remove();break;case IPSAP.APPLICATION_RESULT.REQUIRE_RETRY:$(".apptype_area").addClass("denied"),$(".apptype_date").text("보완후 재심"),h.remove();break;case IPSAP.APPLICATION_RESULT.EXPERIMENT_ING_A:$(".apptype_date").text("실험중 (승인)"),h.remove();break;case IPSAP.APPLICATION_RESULT.EXPERIMENT_ING_AC:$(".apptype_date").text("실험중 (조건부 승인)"),h.remove();break;case IPSAP.APPLICATION_RESULT.EXPERIMENT_FINISH:$(".apptype_date").text("실험 만료"),h.remove();break;case IPSAP.APPLICATION_RESULT.TASK_FINISH:$(".apptype_date").text("실험 종료"),h.remove();break;case IPSAP.APPLICATION_RESULT.ACCEPT:$(".apptype_date").text("승인 : "+getDttm(g_AppInfo.appObj.approved_dttm).dt),h.remove();break;case IPSAP.APPLICATION_RESULT.ACCEPT_AC:$(".apptype_date").text("조건부 승인 : "+getDttm(g_AppInfo.appObj.approved_dttm).dt),h.remove();break;default:h.remove(),I.remove(),P.remove()}switch(parseInt(g_AppInfo.appObj.application_step)){case 0:default:$(".progress_area").children().removeClass("active"),$(".progress_area").children().eq(0).addClass("active");break;case 1:$(".progress_area").children().removeClass("active"),$(".progress_area").children().eq(1).addClass("active");break;case 4:$(".progress_area").children().removeClass("active"),$(".progress_area").children().eq(2).addClass("active")}e(),setAppChangeInfo()}))}function e(){$(".card").removeClass("hidden")}}function setAppChangeInfo(){urlPath=CONST.API.APPLICATION_CHANGE.ALLINFO,app_seq=g_AppInfo.appSeq;var e=$("#trace_changing").find(".changing-list").clone(),t=$("#trace_changing").find(".changing-list").children("ul").eq(0).clone(),a=$("#trace_changing").find(".changing-list").children("ul").eq(1).clone(),n=$("#trace_changing").find(".changing-list").children("ul").eq(2).clone(),d=$("#trace_changing").find(".changing-list").children("ul").eq(3).clone();$("#trace_changing").empty(),API.load({url:urlPath.replace("${app_seq}",app_seq),type:CONST.API_TYPE.GET,success:function(r){if(!r)return;$(".trace_label").removeClass("hidden");var i=1;let p=r.approved_dttm,l=r.change_apps;listHeader='<div class="flexMid mBot10 mTop20">\n                      <h4 class="card-title"><i class="fas fa-plus-square mRight10"></i>변경 내역 <span class="list-num">1</span></h4>\n                      <div class="header_comment mLeft25">변경 승인일:<span class="blue_deep mLeft10 list-date">2021-03-02</span></div>\n                    </div>',e.empty();for(const[r,A]of Object.entries(p)){var c=e.clone();c.append(listHeader),c.find(".list-num").text(i),i++,c.find(".list-date").text(A);for(const[e,r]of Object.entries(l)){var _=t.clone();if(_.find("span").eq(1).text(r.main_title),A==r.approved_dttm)if("ca_regular_item"==r.item_name){_.find("span").eq(0).text("[정규]");var s,o=JSON.parse(r.contents);"104"==r.target_item?(s=_.find(".data").eq(1).children("div").first().clone(),_.find(".data").eq(1).empty()):_.find(".data").eq(1).text(o[1]),_.find(".data").eq(2).text(o[2]),_.find("span").eq(2).text(IPSAP.APP_MAIN_TAG_NAME[o[0]]);var m=`newWindowPopup('./_popup_application-info.html#form_${o[0]}')`;if(_.find("a").first().attr("onclick",m),r.src?(_.find(".data").eq(3).text(r.org_file_name),_.find(".data").eq(3).attr("href",r.src)):_.find(".data").eq(3).text(""),"104"==r.target_item){var f=JSON.parse(o[1]);for(let e=0;e<f.length;++e){let t=s.clone();t.find("span").eq(0).text(f[e][0]),t.find("span").eq(3).text(f[e][1]),t.find("span").eq(5).text(f[e][2]),t.find("span").eq(6).text(f[e][3]),t.find("span").eq(9).text(f[e][4]),t.find("span").eq(11).text(f[e][5]),_.find(".data").eq(1).append(t)}}c.append(_)}else if("ca_fast_item"==r.item_name){let e={};o=JSON.parse(r.contents);var h=3;if("111"==r.target_item){e=n.clone(),e.find("span").eq(1).text(r.main_title),e.find(".data").eq(2).text(o[2]);var g=e.find(".data").find("tbody").eq(0),q=e.find(".data").find("tbody").eq(1),I=g.children("tr").eq(0),P=q.children("tr").eq(0);e.find(".data").find("tbody").empty(),$.each(r.member_org,(function(e,t){var a=I.clone(),n=t.info;n.tmp_phoneno=n.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),1==t.general_director?a.children("td").eq(0).find("input").prop("checked",!0):(a.children("td").eq(0).find("input").prop("checked",!1),a.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?a.children("td").eq(1).find("input").prop("checked",!0):(a.children("td").eq(1).find("input").prop("checked",!1),a.children("td").eq(1).find("input").prop("disabled",!0)),a.children("td").eq(2).text(n.name),a.children("td").eq(3).text(n.dept_str),a.children("td").eq(4).text(n.position_str),a.children("td").eq(5).text(n.major_field_str),a.children("td").eq(6).text(n.tmp_phoneno),g.append(a)})),$.each(r.member_after,(function(e,t){var a=P.clone(),n=t.info;n.tmp_phoneno=n.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),1==t.general_director?a.children("td").eq(0).find("input").prop("checked",!0):(a.children("td").eq(0).find("input").prop("checked",!1),a.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?a.children("td").eq(1).find("input").prop("checked",!0):(a.children("td").eq(1).find("input").prop("checked",!1),a.children("td").eq(1).find("input").prop("disabled",!0)),a.children("td").eq(2).text(n.name),a.children("td").eq(3).text(n.dept_str),a.children("td").eq(4).text(n.position_str),a.children("td").eq(5).text(n.major_field_str),a.children("td").eq(6).text(n.tmp_phoneno),q.append(a)}))}else"112"==r.target_item?(e=d.clone(),e.find("span").eq(1).text(r.main_title),e.find(".data").eq(2).text(r.approved_dttm+"~"+r.end_date_org),e.find(".data").eq(3).text(r.approved_dttm+"~"+r.end_date_after),e.find(".data").eq(4).text(o[2]),h=5):(e=a.clone(),e.find("span").eq(1).text(r.main_title),e.removeClass("regular_review"),e.addClass("simple_review"),e.find(".blue_deep").addClass("green"),e.find(".blue_deep").removeClass("blue_deep"),e.find("span").eq(0).text("[신속]"),e.find(".data").eq(1).text(o[1]),e.find(".data").eq(2).text(o[2]),e.find("span").eq(2).text(IPSAP.APP_MAIN_TAG_NAME[o[0]]));r.src?(e.find(".data").eq(h).text(r.org_file_name),e.find(".data").eq(h).attr("href",r.src)):e.find(".data").eq(h).text("");m=`newWindowPopup('./_popup_application-info.html#form_${o[0]}')`;e.find("a").first().attr("onclick",m),c.append(e)}}$("#trace_changing").append(c)}},error:function(){},complete:function(){}})}"undefined"==typeof ipsap_common_func_js&&document.write("<script src='/assets/js/ipsap/ipsap_common_func.js'><\/script>");