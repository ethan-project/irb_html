var g_other_userlist;"undefined"==typeof ipsap_common_func_js&&document.write("<script src='/assets/js/ipsap/ipsap_common_func.js'><\/script>");var view_more_obj=$(".view_more").clone(),user_info=JSON.parse(COMM.getCookie(CONST.COOKIE.IPSAP_USER_INFO));const A="ibc_risk_pathogen",B="ibc_risk_resistant_gene",C="ibc_risk_toxin_gene",D="ibc_risk_toxin_handling",targetA=".ibc-3-1-A",targetB=".ibc-3-1-B",targetC=".ibc-3-1-C",targetD=".ibc-3-1-D";var g_templateA,g_templateB,g_templateC,g_templateD,g_inserted_data_cnt_A=0,g_inserted_data_cnt_B=0,g_inserted_data_cnt_C=0,g_inserted_data_cnt_D=0,g_min_value=0;function checkValidateAndSave(e){if($("#ibc_general_experiment_cnt").val())if($("#ibc_general_experiment_degree").val())if($("#ibc_general_fund_org-main_check").is(":checked")||$("#ibc_general_fund_org_name").val()){if(g_min_value<11){if(!$("#ibc_plan_classification").find("input:checkbox").is(":checked"))return void alert("2-2. 실험 구분의 해당 항목을 하나 이상 체크해 주세요.");if(!$("#ibc_plan_purpose_perf_text").val())return void alert("2-3. 연구목적 및 예상 성과를 작성해 주세요.");if(!$("#ibc_plan_content_range_text").val())return void alert("2-4. 연구내용 및 범위를 작성해 주세요.");if(!$("#ibc_plan_method_text").val())return void alert("2-5. 연구방법을 작성해 주세요.")}if(g_min_value<9){if(!$('input:checkbox[name="ibc_risk_bio_grade"]').is(":checked"))return void alert("생물안전등급을 하나 이상 체크해 주세요.");if(!$("#ibc_risk_bio_reason").val())return void alert("생물안전등급의 판단 근거를 작성해 주세요.");savedDataMappingA(),savedDataMappingB(),savedDataMappingC(),savedDataMappingD()}e?(g_AppItemParser.addMoreSaveTag("supplement",makeSupplementData()),appItemSubmit(submitCallback)):(g_AppItemParser.addMoreSaveTag("supplement",makeSupplementData()),appItemSaveTemporary(finalNavigationCallback))}else alert("연구비를 지원받는 경우, 기관명을 입력해 주세요.");else alert("동물 실험의 총 차수를 입력해 주세요.");else alert("동물 실험 총 횟수를 입력해 주세요.")}function insertNewDataA(e){g_inserted_data_cnt_A++;var t=g_templateA.html().replaceAll("03-1-A",`03-1-A-${g_inserted_data_cnt_A}`);t.replaceAll("input_03-1-A",`input_03-1-A-${g_inserted_data_cnt_A}`);var a,i=$(t);if(""!=e&&1==(a=JSON.parse(e)).v){let e=i.children("div").eq(1);e.find("input:text:first").val(a.d[1]),e.find("input:text").eq(1).val(a.d[2]);for(let t=0;t<4;t++)try{a.d[3][t]>0&&e.find("input:checkbox").eq(t).prop("checked",!0)}catch(e){}for(let t=0;t<4;t++)try{a.d[4][t]>0&&e.find("input:checkbox").eq(4+t).prop("checked",!0)}catch(e){}e.find(`input:radio[name='radio_03-1-A-${g_inserted_data_cnt_A}_5']:radio[value='${a.d[5]}']`).prop("checked",!0),e.find("input:text").eq(2).val(a.d[6]),e.find("input:text").eq(3).val(a.d[7]),e.find("input:text").eq(4).val(a.d[8]),e.find(`input:radio[name='radio_03-1-A-${g_inserted_data_cnt_A}_9']:radio[value='${a.d[9].R}']`).prop("checked",!0),e.find("input:text").eq(5).val(a.d[9].T1),e.find("input:text").eq(6).val(a.d[9].T2),e.find(`input:radio[name='radio_03-1-A-${g_inserted_data_cnt_A}_10']:radio[value='${a.d[10].R}']`).prop("checked",!0),e.find("input:text").eq(7).val(a.d[10].T1),e.find("textarea").eq(0).val(a.d[11]),e.find("textarea").eq(1).val(a.d[12]),a.d[13]>0&&e.find("input:checkbox").eq(8).prop("checked",!0);for(let t=0;t<4;t++)try{a.d[14][t]>0&&e.find("input:checkbox").eq(9+t).prop("checked",!0)}catch(e){}a.d[15]>0&&e.find("input:checkbox").eq(13).prop("checked",!0);for(let t=0;t<3;t++)try{a.d[16][t]>0&&e.find("input:checkbox").eq(14+t).prop("checked",!0)}catch(e){}}($(`.${A}`).append(i),""!=e)&&(1==(a=JSON.parse(e)).v&&(1==a.d[9].R&&$(`#radio_03-1-A-${g_inserted_data_cnt_A}_9-1`).siblings().addClass("show"),4==a.d[9].R&&$(`#radio_03-1-A-${g_inserted_data_cnt_A}_9-4`).siblings().addClass("show"),1!=a.d[9].R&&$(`#radio_03-1-A-${g_inserted_data_cnt_A}_9-1`).siblings().removeClass("show"),3==a.d[10].R&&$(`#radio_03-1-A-${g_inserted_data_cnt_A}_10-3`).siblings().addClass("show"),a.d[13]>0&&($(`#input_03-1-A-${g_inserted_data_cnt_A}_13_group`).removeClass("show"),$(`#input_03-1-A-${g_inserted_data_cnt_A}_13_group`).addClass("collapse")),a.d[15]>0&&($(`#input_03-1-A-${g_inserted_data_cnt_A}_14_group`).removeClass("show"),$(`#input_03-1-A-${g_inserted_data_cnt_A}_14_group`).addClass("collapse"))));i.find(".item_remove_btn").on({click:function(e){$(this).closest(".content_wrapper").remove()}}),collapseFun()}function insertNewDataB(e){g_inserted_data_cnt_B++;var t=g_templateB.html().replaceAll("03-1-B",`03-1-B-${g_inserted_data_cnt_B}`);t.replaceAll("input_03-1-B",`input_03-1-B-${g_inserted_data_cnt_B}`);var a,i=$(t);if(""!=e)if(1==(a=JSON.parse(e)).v){let e=i.children("div").eq(1);e.find("input:text").first().val(a.d[1]),a.d[2].C>0&&(e.find("input:checkbox").eq(0).prop("checked",!0),e.find("input:text").eq(1).val(a.d[2].T1)),a.d[3].C>0&&(e.find("input:checkbox").eq(1).prop("checked",!0),e.find("input:text").eq(2).val(a.d[3].T1)),a.d[4].C>0&&(e.find("input:checkbox").eq(2).prop("checked",!0),e.find("input:text").eq(3).val(a.d[4].T1)),a.d[5].R>0&&(e.find(`input:radio[name='radio_03-1-B-${g_inserted_data_cnt_B}_3']:radio[value='${a.d[5].R}']`).prop("checked",!0),e.find("input:text").eq(4).val(a.d[5].T1)),a.d[6].R>0&&(e.find(`input:radio[name='radio_03-1-B-${g_inserted_data_cnt_B}_4']:radio[value='${a.d[6].R}']`).prop("checked",!0),e.find("input:text").eq(5).val(a.d[6].T1),e.find("input:text").eq(6).val(a.d[6].T2)),a.d[7].R>0&&(e.find(`input:radio[name='radio_03-1-B-${g_inserted_data_cnt_B}_5']:radio[value='${a.d[7].R}']`).prop("checked",!0),e.find("input:text").eq(7).val(a.d[7].T1)),e.find("textarea").eq(0).val(a.d[8]),e.find("textarea").eq(1).val(a.d[9])}else alert("Data version Error!!");($(`.${B}`).append(i),""!=e)&&(1==(a=JSON.parse(e)).v&&(a.d[2].C>0&&$(`#check_03-1-B-${g_inserted_data_cnt_B}_2-1`).siblings().eq(1).css("display","block"),a.d[3].C>0&&$(`#check_03-1-B-${g_inserted_data_cnt_B}_2-2`).siblings().eq(1).css("display","block"),a.d[4].C>0&&$(`#check_03-1-B-${g_inserted_data_cnt_B}_2-3`).siblings().eq(1).css("display","block"),4==a.d[5].R&&$(`#radio_03-1-B-${g_inserted_data_cnt_B}_3-4`).siblings().eq(1).css("display","block"),4==a.d[6].R&&$(`#radio_03-1-B-${g_inserted_data_cnt_B}_4-4`).siblings().addClass("show"),1==a.d[6].R&&$(`#radio_03-1-B-${g_inserted_data_cnt_B}_4-1`).siblings().removeClass("hidden"),1!=a.d[6].R&&$(`#radio_03-1-B-${g_inserted_data_cnt_B}_4-1`).siblings().removeClass("show"),3==a.d[7].R&&$(`#radio_03-1-B-${g_inserted_data_cnt_B}_5-3`).siblings().addClass("show")));i.find(".item_remove_btn").on({click:function(e){$(this).closest(".content_wrapper").remove()}}),collapseFun(),setTriggerCheckBoxOnChange(),setTriggerRadioOnChange()}function insertNewDataC(e){g_inserted_data_cnt_C++;var t=g_templateC.html().replaceAll("03-1-C",`03-1-C-${g_inserted_data_cnt_C}`);t.replaceAll("input_03-1-C",`input_03-1-C-${g_inserted_data_cnt_C}`);var a,i=$(t);if(""!=e&&1==(a=JSON.parse(e)).v){let e=i.children("div").eq(1);e.find("input:text").eq(0).val(a.d[1]),a.d[2].C1>0&&(e.find("input:checkbox").eq(0).prop("checked",!0),e.find("input:text").eq(1).val(a.d[2].T1)),a.d[2].C2>0&&(e.find("input:checkbox").eq(1).prop("checked",!0),e.find("input:text").eq(2).val(a.d[2].T2)),a.d[2].C3>0&&(e.find("input:checkbox").eq(2).prop("checked",!0),e.find("input:text").eq(3).val(a.d[2].T3)),e.find(`input:radio[name='radio_03-1-C-${g_inserted_data_cnt_C}_3']:radio[value='${a.d[3].R}']`).prop("checked",!0),e.find("input:text").eq(4).val(a.d[3].T1),e.find("input:text").eq(5).val(a.d[4]),e.find(`input:radio[name='radio_03-1-C-${g_inserted_data_cnt_C}_5']:radio[value='${a.d[5].R}']`).prop("checked",!0),e.find("input:text").eq(6).val(a.d[5].T1),e.find("input:text").eq(7).val(a.d[5].T2),e.find(`input:radio[name='radio_03-1-C-${g_inserted_data_cnt_C}_6']:radio[value='${a.d[6].R}']`).prop("checked",!0),e.find("input:text").eq(8).val(a.d[6].T1),e.find("textarea").eq(0).val(a.d[7]),e.find("textarea").eq(1).val(a.d[8])}($(`.${C}`).append(i),""!=e)&&(1==(a=JSON.parse(e)).v&&1==a.v&&(a.d[2].C1>0&&$(`#check_03-1-C-${g_inserted_data_cnt_C}_2-1`).siblings().eq(1).css("display","block"),a.d[2].C2>0&&$(`#check_03-1-C-${g_inserted_data_cnt_C}_2-2`).siblings().eq(1).css("display","block"),a.d[2].C3>0&&$(`#check_03-1-C-${g_inserted_data_cnt_C}_2-3`).siblings().eq(1).css("display","block"),3==a.d[3].R&&$(`#radio_03-1-C-${g_inserted_data_cnt_C}_3-3`).siblings().eq(1).css("display","block"),4==a.d[5].R&&$(`#radio_03-1-C-${g_inserted_data_cnt_C}_5-4`).siblings().addClass("show"),1==a.d[5].R&&$(`#radio_03-1-C-${g_inserted_data_cnt_C}_5-1`).siblings().removeClass("hidden"),1!=a.d[5].R&&$(`#radio_03-1-C-${g_inserted_data_cnt_C}_5-1`).siblings().removeClass("show"),3==a.d[6].R&&$(`#radio_03-1-C-${g_inserted_data_cnt_C}_6-3`).siblings().addClass("show")));i.find(".item_remove_btn").on({click:function(e){$(this).closest(".content_wrapper").remove()}}),collapseFun(),setTriggerCheckBoxOnChange(),setTriggerRadioOnChange()}function insertNewDataD(e){g_inserted_data_cnt_D++;var t=g_templateD.html().replaceAll("03-1-D",`03-1-D-${g_inserted_data_cnt_D}`);t.replaceAll("input_03-1-D",`input_03-1-D-${g_inserted_data_cnt_D}`);var a,i=$(t);if(""!=e&&1==(a=JSON.parse(e)).v){let e=i.children("div").eq(1);e.find("input:text").eq(0).val(a.d[1]),e.find("input:text").eq(1).val(a.d[2]),e.find("input:text").eq(2).val(a.d[3]),e.find("input:text").eq(3).val(a.d[4]),e.find(`input:radio[name='radio_03-1-D-${g_inserted_data_cnt_D}_5']:radio[value='${a.d[5].R}']`).prop("checked",!0),e.find("input:text").eq(4).val(a.d[5].T1),e.find("input:text").eq(5).val(a.d[5].T2),e.find(`input:radio[name='radio_03-1-D-${g_inserted_data_cnt_D}_6']:radio[value='${a.d[6].R}']`).prop("checked",!0),e.find("input:text").eq(6).val(a.d[6].T1),e.find("textarea").eq(0).val(a.d[7]),e.find("textarea").eq(1).val(a.d[8]),a.d[9]>0&&e.find("input:checkbox").eq(0).prop("checked",!0);for(let t=0;t<3;t++)try{a.d[10][t]>0&&e.find("input:checkbox").eq(1+t).prop("checked",!0)}catch(e){}}($(`.${D}`).append(i),""!=e)&&(1==(a=JSON.parse(e)).v&&(4==a.d[5].R&&$(`#radio_03-1-D-${g_inserted_data_cnt_D}_5-4`).siblings().addClass("show"),1==a.d[5].R&&$(`#radio_03-1-D-${g_inserted_data_cnt_D}_5-1`).siblings().removeClass("hidden"),1!=a.d[5].R&&$(`#radio_03-1-D-${g_inserted_data_cnt_D}_5-1`).siblings().removeClass("show"),3==a.d[6].R&&$(`#radio_03-1-D-${g_inserted_data_cnt_D}_6-3`).siblings().addClass("show"),a.d[9]>0&&($(`#input_03-1-D-${g_inserted_data_cnt_D}_9_group`).removeClass("show"),$(`#input_03-1-D-${g_inserted_data_cnt_D}_9_group`).addClass("collapse"))));i.find(".item_remove_btn").on({click:function(e){$(this).closest(".content_wrapper").remove()}}),collapseFun(),setTriggerCheckBoxOnChange(),setTriggerRadioOnChange()}function remakeApplicationInfo(e,t){var a="ibc_all";for(let t=0;t<e.length;++t)a=a+","+e[t];let n={"filter.query_items":a};if(isInArray(e,"supplement")){for(const[e,t]of Object.entries(IPSAP.IBC_REVIEW_TAG)){let a="app_supplement_"+e;html=`\n      <div class="col-sm-9 mTop20">\n        <div class="checkbox checkbox-danger">\n          <input type="checkbox" id="${a}" value="1" checked readonly>\n          <label>${t}</label>\n        </div>\n        <span class="data officer" id="${"app_supplement_text_"+e}">${""}</span>\n      </div>\n      `,$("#"+a).replaceWith(html)}}else for(const[e,t]of Object.entries(IPSAP.IBC_REVIEW_TAG))$("#app_supplement_"+e).remove();g_AppItemParser=new ItemParser(g_AppInfo.appSeq),g_AppItemParser.load(n,(function(a){(function(t){if(!isInArray(e,"supplement"))return;var a=t.getItemData("supplement");for(const[e,t]of Object.entries(IPSAP.IBC_REVIEW_TAG)){let t=a.dataObj.saved_data.data[e];if(null==t||""==t)continue;let i="app_supplement_"+e,n="app_supplement_text_"+e;0==t.substring(0,1)?($("#"+i).prop({checked:!1,disabled:!0}).removeAttr("checked readonly"),$("#"+i).parent().removeClass("checkbox-danger"),$("#"+n).addClass("collapse"),$("#"+n).removeClass("show")):$("#"+n).text(t.substring(2))}})(a),$("#list_li").empty(),API.load({url:CONST.API.APPLICATION.LIST,type:CONST.API_TYPE.GET,data:{"filter.app_view_type":12},success:function(e){if(0==e.list.length)$("#list_li").append("<li>참조할 신청서가 없습니다.</li>");else if(e.list.length<4)$.each(e.list,(function(e,t){$("#list_li").append(`<li><a href="#" data-seq="${t.application_seq}" onclick="copyIACUCApplication(${t.application_seq});">${t.name_ko}<span class="mLeft10">( ${t.application_no}, <span class="comment_date">${getDttm(t.approved_dttm).dt}</span> )</span></a></li>`)}));else{for(var t=0;t<3;t++)$("#list_li").append(`<li><a href="#" data-seq="${e.list[t].application_seq}" onclick="copyIACUCApplication(${e.list[t].application_seq});">${e.list[t].name_ko}<span class="mLeft10">( ${e.list[t].application_no}, <span class="comment_date">${getDttm(e.list[t].approved_dttm).dt}</span> )</span></a></li>`);$("#list_li").after('<button type="button" class="btn btn-primary btn_xxs mTop10 mLeft25" id="btn_IACUC_all" data-toggle="modal" data-target="#modal_allApp_list"><i class="far fa-file mRight5"></i>모든 IACUC 신청서에서 선택하기</button>')}}}),$(".available_app").empty(),API.load({url:CONST.API.APPLICATION.LIST,type:CONST.API_TYPE.GET,data:{"filter.app_view_type":12},success:function(e){e.list.length?$("#modal_allApp_list").find(".comment_alt").html('신청서를 선택하면, 신청서 정보가 자동으로 입력됩니다.<br><span class="comment">※ 자동 입력은 입력편의를 위한 기능이며, 참조 신청서 원본에는 영향이 없습니다.</span>'):$("#modal_allApp_list").find(".comment_alt").text("선택 가능한 신청서가 없습니다."),$.each(e.list,(function(e,t){$(".available_app").append(`<a href="#" class="list-group-item hidden" onclick="copyIACUCApplication(${t.application_seq});"><i class="far fa-file-alt text-secondary mr-2"></i>${t.name_ko}</a>`)}))},complete:function(){$("[data-val-name=init_visible_count]").text(CONST.VISIBLE_AVAILABLE_ITEMS),$(".available_app").each((function(e,t){var a=$(t).find("a");for(let e=0;e<CONST.VISIBLE_AVAILABLE_ITEMS;e++)a.eq(e).removeClass("hidden");a.length>CONST.VISIBLE_AVAILABLE_ITEMS&&$(t).append(view_more_obj.clone(!0))}))}});var n="general_title";(_=a.getItemData(n)).applyTextMapValue(n+"_name_ko","name_ko"),_.applyTextMapValue(n+"_name_en","name_en");n="general_end_date";(_=a.getItemData(n)).applyCalanderValue(n),function(){let e=new Date;e.setDate(e.getDate()+7);let t=moment(new Date).format("YYYY-MM-DD");$("#general_end_date").val(t);let a=new Date;a.setDate(a.getDate()+1095),$("#general_end_date").on("change",(function(){let i=$("#general_end_date").val().split("-"),n=new Date(i[0],parseInt(i[1]-1),i[2]);e.getTime()>n.getTime()?(alert("오늘로부터 일주일 이후 날짜부터 선택이 가능합니다."),$("#general_end_date").val(t)):a.getTime()<n.getTime()&&(alert("연구 기간은 신청일 기준 3년까지 가능합니다."),$("#general_end_date").val(t))}))}();n="ibc_general_experiment_cnt";(_=a.getItemData(n)).applyTextValue();n="ibc_general_experiment_degree";(_=a.getItemData(n)).applyTextValue();n="ibc_general_fund_org";var _=a.getItemData(n);(p=_.applyMainCheckValueInCheckBox("ibc_general_fund_org-main_check"))&&$("#input_01-3_group").addClass("collapse").removeClass("show");n="ibc_general_fund_org_name";(_=a.getItemData(n)).applyTextValue();n="ibc_general_fund_start_date";(_=a.getItemData(n)).applyCalanderValue(n);n="ibc_general_fund_end_date";(_=a.getItemData(n)).applyCalanderValue(n);n="ibc_general_fund_conflict";null!=(_=a.getItemData(n))&&_.makeHtmlRadioType();(function(e){var t="general_director",a=e.getItemData(t);if(null==a.dataObj.saved_data)return;a.dataObj.saved_data.data[0].animal_mng_flag=0,a.initMembersIBC();let i=a.dataObj.saved_data.data[0];i.info.tmp_phoneno=i.info.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),i.info.tmp_edu_date=i.info.edu_date.replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3"),$("#general_director_name").text(i.info.name),$("#general_director_email").text(i.info.email),$("#general_director_dept").text(i.info.dept_str),$("#general_director_edu_date").text(i.info.tmp_edu_date),$("#general_director_position").text(i.info.position_str),$("#general_director_edu_instition").text(i.info.edu_institution_str),$("#general_director_major_field").text(i.info.major_field_str),$("#general_director_edu_course_num").text(i.info.edu_course_num),$("#general_director_phoneno").text(i.info.tmp_phoneno),$("#director_course_info").append(makeCourseList(i.user_seq)),""!=i.edu_course&&mappingCourseList(i.user_seq,JSON.parse(i.edu_course))})(a),function(e){var t="general_expt",a=e.getItemData(t);if(null==a.dataObj.saved_data)return;a.initMembersIBC(),makeExptUserList()}(a),mappingIbcFacility(a);var c="ibc_general_experiment",d=(_=a.getItemData(c)).getStringValue("0"),s=[];""!=d&&(s=d.split(","));for($.each(s,(function(e,t){let a="check_01-3-"+(Number(t)+1);$("#"+a).prop("checked",!0).prop("readonly",!0),$("#"+a).attr("onclick","return false")})),i=0;i<$("input:checkbox[id*=check_01-3]").length;i++)0==$("#check_01-3-"+(i+1)).is(":checked")&&$("#check_01-3-"+(i+1)).prop("disabled",!0);n="ibc_general_animal_flag",_=a.getItemData(n);(p=_.applyMainCheckValueInCheckBox("ibc_general_animal_flag-main_check"))&&$("#input_01-4_group").addClass("collapse").removeClass("show");n="ibc_general_animal_name";(_=a.getItemData(n)).applyTextValue(n);n="ibc_general_animal_iacuc_num";(_=a.getItemData(n)).applyTextValue(n);n="ibc_general_animal_iacuc_flag";null!=(_=a.getItemData(n))&&(_.makeHtmlRadioType(IPSAP.COL.EVEN),_.makeHtmlRadioType(IPSAP.COL.ODD));n="ibc_general_animal_exp_flag";null!=(_=a.getItemData(n))&&(_.makeHtmlRadioType(IPSAP.COL.EVEN),_.makeHtmlRadioType(IPSAP.COL.ODD));n="ibc_general_animal_purpose";(_=a.getItemData(n)).applyTextValue(n);n="ibc_general_ref";(_=a.getItemData(n)).applyMultiFileValue(5,n,"관련 자료"),$("#general_title_name_ko_2").text($("#general_title_name_ko").val()),$("#general_title_name_en_2").text($("#general_title_name_en").val());{let e=$("#general_director").clone();$("#general_director_2").empty();n="general_director";let t=(_=a.getItemData(n)).dataObj.saved_data.data[0],i="<td>";if(""!=t.edu_course){let e=JSON.parse(t.edu_course);for(key in e)i+=`\n            <div class="flexMid">\n              <span class="min_w120">${key}</span>\n              <span class="mLeft10">${e[key]}</span>\n            </div>`}i+="</td>",e.find("tr:last").children("td:last").replaceWith(i),$("#general_director_2").replaceWith(e)}c="ibc_general_experiment",d=(_=a.getItemData(c)).getStringValue("0"),s=[];""!=d&&(s=d.split(","));if(s.length>0){ibcResetLeftNavi(s);var r=Math.min.apply(null,s);g_min_value=r,r>=0&&r<4?$("#classification").text("국가 승인 실험"):r>=4&&r<9?$("#classification").text("기관 승인 실험"):r>=9&&r<11?($("#classification").text("기관 신고 실험"),$("#form_03").addClass("hidden"),$("#app_divider_2").addClass("hidden"),a.deleteSaveTag(["ibc_risk_organisms_substance","ibc_risk_bio"])):($("#form_02").addClass("hidden"),$("#form_03").addClass("hidden"),$("#app_divider_1").addClass("hidden"),$("#app_divider_2").addClass("hidden"),$("#classification").text("면제실험"),a.deleteSaveTag(["ibc_plan_project","ibc_plan_classification","ibc_plan_purpose_performance","ibc_plan_content_range","ibc_plan_method"]),a.deleteSaveTag(["ibc_risk_organisms_substance","ibc_risk_bio"]))}a.deleteSaveTag(["ibc_general_experiment"]);n="ibc_plan_classification";(_=a.getItemData(n)).makeHtmlCheckList(n);n="ibc_plan_purpose_perf_text";(_=a.getItemData(n)).applyTextValue(n);n="ibc_plan_purpose_perf_file";(_=a.getItemData(n)).applyMultiFileValue(5,n,"관련 자료");n="ibc_plan_content_range_text";(_=a.getItemData(n)).applyTextValue(n);n="ibc_plan_content_range_file";(_=a.getItemData(n)).applyMultiFileValue(5,n,"관련 자료");n="ibc_plan_method_text";(_=a.getItemData(n)).applyTextValue(n);n="ibc_plan_method_file";if((_=a.getItemData(n)).applyMultiFileValue(5,n,"관련 자료"),g_min_value<9){n="ibc_risk_pathogen_check",_=a.getItemData(n);if(p=_.applyMainCheckValueInCheckBox("ibc_risk_pathogen_check-main_check"))$("#main-3-1-A").removeClass("show");else{var l=(_=a.getItemData(A)).dataObj.saved_data.data;for(const[e,t]of Object.entries(l))insertNewDataA(t);0==g_inserted_data_cnt_A&&insertNewDataA("")}$("#main-3-1-A").removeClass("hidden");n="ibc_risk_resistant_gene_check",_=a.getItemData(n);if(p=_.applyMainCheckValueInCheckBox("ibc_risk_resistant_gene_check-main_check"))$("#main-3-1-B").removeClass("show");else{l=(_=a.getItemData(B)).dataObj.saved_data.data;for(const[e,t]of Object.entries(l))insertNewDataB(t);0==g_inserted_data_cnt_B&&insertNewDataB("")}$("#main-3-1-B").removeClass("hidden");n="ibc_risk_toxin_gene_check",_=a.getItemData(n);if(p=_.applyMainCheckValueInCheckBox("ibc_risk_toxin_gene_check-main_check"))$("#main-3-1-C").removeClass("show");else{l=(_=a.getItemData(C)).dataObj.saved_data.data;for(const[e,t]of Object.entries(l))insertNewDataC(t);0==g_inserted_data_cnt_C&&insertNewDataC("")}$("#main-3-1-C").removeClass("hidden");n="ibc_risk_toxin_handling_check",_=a.getItemData(n);if(p=_.applyMainCheckValueInCheckBox("ibc_risk_toxin_handling_check-main_check"))$("#main-3-1-D").removeClass("show");else{l=(_=a.getItemData(D)).dataObj.saved_data.data;for(const[e,t]of Object.entries(l))insertNewDataD(t);0==g_inserted_data_cnt_D&&insertNewDataD("")}$("#main-3-1-D").removeClass("hidden");c="ibc_risk_bio_matters_check",d=(_=a.getItemData(c)).getStringValue("0"),s=new Object;""!=d&&(s=d.split(",")),$("input:checkbox[name=ibc_risk_bio_matters_check]").each((function(e){isInArray(s,this.value)&&(this.checked=!0)}));n="ibc_risk_bio_mask_check";var p=(_=a.getItemData(n)).applyMainCheckValueInCheckBox("ibc_risk_bio_mask_check-main_check"),o="ibc_risk_bio_mask_input";a.getItemData(o).applyTextValue(),p?($("#input_03-2_7-6_group").addClass("show"),$("#ibc_risk_bio_mask_input").css("display","block")):$(`#${o}`).val("");n="ibc_risk_bio_etc_protection_check",p=(_=a.getItemData(n)).applyMainCheckValueInCheckBox("ibc_risk_bio_etc_protection_check-main_check"),o="ibc_risk_bio_etc_protection_input";a.getItemData(o).applyTextValue(),p?($("#input_03-2_7-7_group").addClass("show"),$("#ibc_risk_bio_etc_protection_input").css("display","block")):$(`#${o}`).val("");n="ibc_risk_bio_safety_workstation_check",p=(_=a.getItemData(n)).applyMainCheckValueInCheckBox("ibc_risk_bio_safety_workstation_check-main_check"),o="ibc_risk_bio_safety_workstation_input";a.getItemData(o).applyTextValue(),p?($("#input_03-2_8-5_group").addClass("show"),$("#ibc_risk_bio_safety_workstation_input").css("display","block")):$(`#${o}`).val("");n="ibc_risk_bio_etc_safety_check",p=(_=a.getItemData(n)).applyMainCheckValueInCheckBox("ibc_risk_bio_etc_safety_check-main_check"),o="ibc_risk_bio_etc_safety_input";a.getItemData(o).applyTextValue(),p?($("#input_03-2_8-7_group").addClass("show"),$("#ibc_risk_bio_etc_safety_input").css("display","block")):$(`#${o}`).val("");c="ibc_risk_bio_grade",d=(_=a.getItemData(c)).getStringValue("0"),s=new Object;""!=d&&(s=d.split(",")),$("input:checkbox[name=ibc_risk_bio_grade]").each((function(e){isInArray(s,this.value)&&(this.checked=!0)}));n="ibc_risk_bio_reason";(_=a.getItemData(n)).applyTextValue();n="ibc_risk_bios_disinf_sterlztn";(_=a.getItemData(n)).applyTextValue();n="ibc_risk_bio_inf_treatment";(_=a.getItemData(n)).applyTextValue();n="ibc_risk_bio_countermeasure";(_=a.getItemData(n)).applyTextValue();n="ibc_risk_bio_disposal";(_=a.getItemData(n)).applyTextValue(),mappingIbcInfectionChance(a),mappingIbcEmergencyNetwork(a);n="ibc_risk_bios_prvnt_check",_=a.getItemData(n);(p=_.applyMainCheckValueInCheckBox("ibc_risk_bios_prvnt_check-main_check"))&&($("#input_03-2_5-1_group").addClass("show"),$("#ibc_risk_bios_prvnt_input").css("display","block"));n="ibc_risk_bios_prvnt_input";(_=a.getItemData(n)).applyTextValue();n="ibc_risk_bios_treatment_check",_=a.getItemData(n);(p=_.applyMainCheckValueInCheckBox("ibc_risk_bios_treatment_check-main_check"))&&($("#input_03-2_5-2_group").addClass("show"),$("#ibc_risk_bios_treatment_input").css("display","block"));n="ibc_risk_bios_treatment_input";(_=a.getItemData(n)).applyTextValue();n="ibc_risk_bios_prvnt_list";(_=a.getItemData(n)).applyMultiFileValue(5,n,"예방백신 명단 제출","mRight10 mBot0 mTop10 w120");n="ibc_risk_bio_transport_check",_=a.getItemData(n);(p=_.applyMainCheckValueInCheckBox("ibc_risk_bio_transport_check-main_check"))&&($("#input_03-2_10-1_group").addClass("show"),$("#ibc_risk_bio_transport_input").css("display","block"));n="ibc_risk_bio_transport_input";(_=a.getItemData(n)).applyTextValue();n="ibc_risk_bio_packing";(_=a.getItemData(n)).applyTextValue();n="ibc_risk_bio_storage_check",_=a.getItemData(n);(p=_.applyMainCheckValueInCheckBox("ibc_risk_bio_storage_check-main_check"))&&($("#input_03-2_10-2_group").addClass("show"),$("#ibc_risk_bio_storage_input").css("display","block"));n="ibc_risk_bio_storage_input";(_=a.getItemData(n)).applyTextValue();n="ibc_risk_bio_keeping";(_=a.getItemData(n)).applyTextValue();n="ibc_risk_bio_lmo";(_=a.getItemData(n)).applyTextValue()}n="ibc_director_pledge",p=(_=a.getItemData(n)).applyMainCheckValueInCheckBox("ibc_director_pledge-main_check");setAgreeDate(),null!=t&&t(a);setTriggerDataMoveTo(),setAgreeDate(),collapseFun(),setTriggerRadioOnChange(),$(".card").removeClass("hidden")})),getStaff(),deleteStaff()}function copyIACUCApplication(e){let t=CONST.API.APPLICATION.COPY_IACUC,a=g_AppInfo.appObj.application_seq;a||(a=0),API.load({url:t.replace("${app_seq}",a),type:CONST.API_TYPE.POST,data:{application_seq:e},success:function(e){g_AppInfo.appObj=e.new_info,location.reload()}})}function viewHiddenApp(e){$(e).siblings(".hidden").removeClass("hidden"),$(e).add($(e).closest(".modal-body").find(".more_comment")).remove()}function getStaff(){let e=CONST.API.INSTITUTION.USER;API.load({url:e.replace("${inst_seq}",g_AppInfo.appObj.institution_seq),data:{"filter.user_type":IPSAP.USER_TYPE.RESEARCHER},type:CONST.API_TYPE.GET,success:function(e){g_other_userlist=e}})}function deleteStaff(){$(document).on("click",".btn-staff-delete",(function(){var e=$(this).closest("tr").attr("data-id"),t=$(this).closest("tr").attr("item_name");g_AppItemParser.removeMembers(t,e),$(this).closest("tr").remove()}))}function makeExptUserList(){var e="general_expt",t=g_AppItemParser.getItemData(e),a='<tbody id="general_expt">';let i=g_AppItemParser.managedItems[e].member;$.each(i,(function(e,t){t.info.tmp_phoneno=t.info.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),t.info.tmp_edu_date=t.info.edu_date.replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3");var i=`general_expt_${t.user_seq}_radio`,n=makeCourseList(t.user_seq);a+=`\n      <tr data-id="${t.user_seq}" item_name="general_expt">\n        <td>\n          <div class="custom-radio">\n            <input type="radio" id="${i}" name="exp_manager" value="${t.user_seq}">\n          </div>\n        </td>\n        <td>${t.info.name}</td>\n        <td>${t.info.dept_str}</td>\n        <td>${t.info.position_str}</td>\n        <td>${t.info.major_field_str}</td>\n        <td>${t.info.tmp_phoneno}</td>\n        <td>${t.info.email}</td>\n        <td>${n}</td>\n        <td>\n          <a href="javascript:void(0);" class="btn btn-xs btn-outline-danger btn-staff-delete"><i class="far fa-trash-alt mRight5"></i>삭제</a>\n        </td>\n      </tr>`})),a+='\n  <tr class="add_row">\n    <td colspan="11">\n      <a href="javascript:void(0);" onclick="openModelOtherStaff();" class="btn btn-xs btn-outline-primary" ><i class="fas fa-user-plus mRight5"></i>실험 수행자 선택 추가</a>\n    </td>\n  </tr>\n  </tbody>',$("#general_expt").replaceWith(a),$("#general_expt").replaceWith(a),$("#general_expt").children().eq(0).find("input").prop("checked",!0),$.each(i,(function(e,t){var a=`general_expt_${t.user_seq}_radio`;t.animal_mng_flag>0&&$("#"+a).prop("checked",!0),""!=t.edu_course&&mappingCourseList(t.user_seq,JSON.parse(t.edu_course))})),$("input[name=exp_manager]").on("change",(function(){var e=Number($(this).val());t.changeAttrForMember(e,"animal_mng_flag",1)}))}function openModelOtherStaff(){makeOtherStaffList(),$("#modal_staff").modal("show");var e="general_expt";let t=g_AppItemParser.managedItems[e].member;$.each(t,(function(t,a){g_AppItemParser.managedItems[e].member[t].edu_course=makeEduCourse(a.user_seq)}))}function onStaffSelect(e){$.each(g_other_userlist,(function(t,a){if(Number(a.user_seq)==e&&!g_AppItemParser.hasMemberExists(a.user_seq))return g_AppItemParser.insertMemberIBC("general_expt",a),makeExptUserList(),void $("#modal_staff").modal("hide")}))}function makeOtherStaffList(){let e='<tbody id="other-staff">';$.each(g_other_userlist,(function(t,a){g_AppItemParser.hasMemberExists(a.user_seq)||(a.tmp_phoneno=a.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),e+=`\n        <tr class="staff-row" onclick="onStaffSelect(${a.user_seq})">\n          <td>${a.user_type_str}</td>\n          <td>${a.name}</td>\n          <td>${a.dept_str}</td>\n          <td>${a.position_str}</td>\n          <td>${a.major_field_str}</td>\n          <td>${a.tmp_phoneno}</td>\n          <td>${a.email}</td>\n          <td>${a.edu_course_num}</td>\n          <td>${a.edu_institution_str}</td>\n        </tr>`)})),e+="</tbody>",$("#other-staff").replaceWith(e)}function setAgreeDate(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,i=e.getDate(),n=t+"년 "+(a=a>=10?a:"0"+a)+"월 "+(i=i>=10?i:"0"+i)+"일";$(".agree_date").text(n),$(".task_director").text(g_AppInfo.appObj.user_name)}function finalNavigationCallback(e,t,a){if(!e)return alert("임시저장을 실패했습니다."),!1;$("#modal_tempSave").modal("show")}function submitCallback(e,t,a){e?location.replace("/html/researcher/application_list.html"):appSubmitHandleError("저장을 실패했습니다.",t)}function makeSupplementData(){var e={};for(const[t,a]of Object.entries(IPSAP.IBC_REVIEW_TAG)){let a="app_supplement_text_"+t,i=$("#"+("app_supplement_"+t)).is(":checked"),n=$("#"+a).text();if(i||(n=""),!i||""!=n){let a="0|";i&&(a="1|"),a+=n,e[t]=a}}return{data:e}}function savedDataMappingA(){var e={};$(`.${A}`).children("div").each((function(t,a){if($("#ibc_risk_pathogen_check-main_check").is(":checked"))return;let i=$(a).children("div").eq(1),n={v:1,d:{1:i.find("input:text:first").val(),2:i.find("input:text").eq(1).val(),3:[i.find("input:checkbox").eq(0).is(":checked")?"1":"0",i.find("input:checkbox").eq(1).is(":checked")?"1":"0",i.find("input:checkbox").eq(2).is(":checked")?"1":"0",i.find("input:checkbox").eq(3).is(":checked")?"1":"0"],4:[i.find("input:checkbox").eq(4).is(":checked")?"1":"0",i.find("input:checkbox").eq(5).is(":checked")?"1":"0",i.find("input:checkbox").eq(6).is(":checked")?"1":"0",i.find("input:checkbox").eq(7).is(":checked")?"1":"0"],5:i.find("input:radio:checked").eq(0).val(),6:i.find("input:text").eq(2).val(),7:i.find("input:text").eq(3).val(),8:i.find("input:text").eq(4).val(),9:{R:i.find("input:radio:checked").eq(1).val(),T1:i.find("input:text").eq(5).val(),T2:i.find("input:text").eq(6).val()},10:{R:i.find("input:radio:checked").eq(2).val(),T1:i.find("input:text").eq(7).val()},11:i.find("textarea").eq(0).val(),12:i.find("textarea").eq(1).val(),13:i.find("input:checkbox").eq(8).is(":checked")?"1":"0",14:[i.find("input:checkbox").eq(9).is(":checked")?"1":"0",i.find("input:checkbox").eq(10).is(":checked")?"1":"0",i.find("input:checkbox").eq(11).is(":checked")?"1":"0",i.find("input:checkbox").eq(12).is(":checked")?"1":"0"],15:i.find("input:checkbox").eq(13).is(":checked")?"1":"0",16:[i.find("input:checkbox").eq(14).is(":checked")?"1":"0",i.find("input:checkbox").eq(15).is(":checked")?"1":"0",i.find("input:checkbox").eq(16).is(":checked")?"1":"0"]}};e[String(t)]=JSON.stringify(n),t++})),g_AppItemParser.addMoreSaveTag(A,{data:e})}function savedDataMappingB(){var e={};$(`.${B}`).children("div").each((function(t,a){if($("#ibc_risk_resistant_gene_check-main_check").is(":checked"))return;let i=$(a).children("div").eq(1),n={v:1,d:{1:i.find("input:text").first().val(),2:{C:i.find("input:checkbox").eq(0).is(":checked")?"1":"0",T1:i.find("input:text").eq(1).val()},3:{C:i.find("input:checkbox").eq(1).is(":checked")?"1":"0",T1:i.find("input:text").eq(2).val()},4:{C:i.find("input:checkbox").eq(2).is(":checked")?"1":"0",T1:i.find("input:text").eq(3).val()},5:{R:i.find("input:radio:checked").eq(0).val(),T1:i.find("input:text").eq(4).val()},6:{R:i.find("input:radio:checked").eq(1).val(),T1:i.find("input:text").eq(5).val(),T2:i.find("input:text").eq(6).val()},7:{R:i.find("input:radio:checked").eq(2).val(),T1:i.find("input:text").eq(7).val()},8:i.find("textarea").eq(0).val(),9:i.find("textarea").eq(1).val()}};e[String(t)]=JSON.stringify(n),t++})),g_AppItemParser.addMoreSaveTag(B,{data:e})}function savedDataMappingC(){var e={};$(`.${C}`).children("div").each((function(t,a){if($("#ibc_risk_toxin_gene_check-main_check").is(":checked"))return;let i=$(a).children("div").eq(1),n={v:1,d:{1:i.find("input:text").eq(0).val(),2:{C1:i.find("input:checkbox").eq(0).is(":checked")?"1":"0",T1:i.find("input:text").eq(1).val(),C2:i.find("input:checkbox").eq(1).is(":checked")?"1":"0",T2:i.find("input:text").eq(2).val(),C3:i.find("input:checkbox").eq(2).is(":checked")?"1":"0",T3:i.find("input:text").eq(3).val()},3:{R:i.find("input:radio:checked").eq(0).val(),T1:i.find("input:text").eq(4).val()},4:i.find("input:text").eq(5).val(),5:{R:i.find("input:radio:checked").eq(1).val(),T1:i.find("input:text").eq(6).val(),T2:i.find("input:text").eq(7).val()},6:{R:i.find("input:radio:checked").eq(2).val(),T1:i.find("input:text").eq(8).val()},7:i.find("textarea").eq(0).val(),8:i.find("textarea").eq(1).val()}};e[String(t)]=JSON.stringify(n),t++})),g_AppItemParser.addMoreSaveTag(C,{data:e})}function savedDataMappingD(){var e={};$(`.${D}`).children("div").each((function(t,a){if($("#ibc_risk_toxin_handling_check-main_check").is(":checked"))return;let i=$(a).children("div").eq(1),n={v:1,d:{1:i.find("input:text").eq(0).val(),2:i.find("input:text").eq(1).val(),3:i.find("input:text").eq(2).val(),4:i.find("input:text").eq(3).val(),5:{R:i.find("input:radio:checked").eq(0).val(),T1:i.find("input:text").eq(4).val(),T2:i.find("input:text").eq(5).val()},6:{R:i.find("input:radio:checked").eq(1).val(),T1:i.find("input:text").eq(6).val()},7:i.find("textarea").eq(0).val(),8:i.find("textarea").eq(1).val(),9:i.find("input:checkbox").eq(0).is(":checked")?"1":"0",10:[i.find("input:checkbox").eq(1).is(":checked")?"1":"0",i.find("input:checkbox").eq(2).is(":checked")?"1":"0",i.find("input:checkbox").eq(3).is(":checked")?"1":"0"]}};e[String(t)]=JSON.stringify(n),t++})),g_AppItemParser.addMoreSaveTag(D,{data:e})}function makeCourseList(e){let t=$("#general_director").data("course-title").split(","),a=`\n    <button class="btn btn-xs btn-outline-primary course_${e} show w100p" data-toggle="collapse" data-target=".course_${e}">교육이수 정보 입력</button>\n    <div class="course_${e} collapse">`;for(course_no in t)a+=`\n      <div class="flexMid text-left">\n        <span class="w110 left mRight5">${t[course_no]}</span>\n        <input type="text" id="${t[course_no]}_${e}" class="form-control form-control-sm w150">\n      </div>\n    `;return a+=`\n      <button class="btn btn-xs btn-outline-secondary w100p mTop5" data-toggle="collapse" data-target=".course_${e}">입력 취소</button>\n    </div>`,a}function mappingCourseList(e,t){let a=!1;$.each(t,(function(t,i){$(`input[id='${t}_${e}']`).val(i),i&&(a=!0)})),a&&$(`.course_${e}`).click()}$(document).ready((function(){$(".ibc-3-1-A").wrap(`<span class="${A}"></span>`),g_templateA=$(`.${A}`).clone(),$(".ibc-3-1-A").remove(),$(".ibc-3-1-B").wrap(`<span class="${B}"></span>`),g_templateB=$(`.${B}`).clone(),$(".ibc-3-1-B").remove(),$(".ibc-3-1-C").wrap(`<span class="${C}"></span>`),g_templateC=$(`.${C}`).clone(),$(".ibc-3-1-C").remove(),$(".ibc-3-1-D").wrap(`<span class="${D}"></span>`),g_templateD=$(`.${D}`).clone(),$(".ibc-3-1-D").remove(),$(".item_new_btn_A").on({click:function(e){insertNewDataA("")}}),$(".item_new_btn_B").on({click:function(e){insertNewDataB("")}}),$(".item_new_btn_C").on({click:function(e){insertNewDataC("")}}),$(".item_new_btn_D").on({click:function(e){insertNewDataD("")}}),$("#ins_temp_save").on({click:function(e){checkValidateAndSave(!1)}}),$("#ins_submit").on({click:function(e){checkValidateAndSave(!0)}})}));