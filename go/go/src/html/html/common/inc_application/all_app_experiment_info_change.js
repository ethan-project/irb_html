var changeInfoTemplate,changeMemberTemplate,changeEndDateTemplate;"undefined"==typeof ipsap_common_func_js&&document.write("<script src='/assets/js/ipsap/ipsap_common_func.js'><\/script>");const animal_is_seq=104,member_is_seq=111,end_date_is_seq=112;function loadApplicationExperimentInfoChange(){if(IPSAP.DEMO_MODE)$(".card-body").removeClass("hidden"),$("#change_application").removeClass("hidden"),e();else{g_AppInfo.loadParams();let e={"filter.query_items":"change_application,judge_expert_deadline,application_info","filter.parent_items":"general_title,general_end_date,application_info,general_director,general_expt"};changeInfoTemplate=$("#change_application").children("ul").first().clone(),changeMemberTemplate=$("#change_application").children("ul").eq(2).clone(),changeEndDateTemplate=$("#change_application").children("ul").eq(3).clone(),$("#change_application").empty().removeClass("hidden"),g_AppItemParser=new ItemParser(g_AppInfo.childAppSeq),g_AppItemParser.load(e,(function(e){var a=e.getItemData("ca_regular_item");0==Object.keys(a.dataObj.saved_data.data).length&&$("#fast_hide_area").remove();var t=e.getParentItemData("general_title");$("#name_ko").text(t.getStringValue("name_ko")),$("#name_en").text(t.getStringValue("name_en"));{t=e.getParentItemData("application_info");let a=Number(t.getStringValue("approved_dttm"));$("#approved_dttm").text(getDttm(a).dt)}{let a=(t=e.getItemData("application_info")).getStringValue("application_no");""!=a&&($(".register_num").text(a),$(".register_num2").text(a))}t=e.getParentItemData("general_end_date");function n(e,a){for(let t=0;t<e.length;++t)if(e[t].is_seq==a)return e[t].contents;return"Error!!"}function d(e,a){for(let t=0;t<e.length;++t)if(e[t].file_idx==a)return e[t]}$("#general_end_date").text(t.getStringValue("0"));{var r=e.getItemData("ca_regular_file");let a=(t=e.getItemData("ca_regular_item")).dataObj.saved_data.data;for(const[e,l]of Object.entries(a)){let a=d(r.dataObj.saved_data.data,Number(e)),o=changeInfoTemplate.clone();o.find("span").eq(0).text("[정규]"),o.find("span").eq(1).text(n(t.dataObj.codes,Number(e)));var i,p=JSON.parse(l);104==Number(e)?(i=o.find(".data").eq(1).children("div").first().clone(),o.find(".data").eq(1).empty()):o.find(".data").eq(1).text(p[1]),o.find(".data").eq(2).text(p[2]),o.find("span").eq(2).text(IPSAP.APP_MAIN_TAG_NAME[p[0]]);var c=`newWindowPopup('./_popup_application-info.html#form_${p[0]}')`;if(o.find("a").first().attr("onclick",c),null==a?o.find(".data").eq(3).text(""):(o.find(".data").eq(3).text(a.org_file_name),o.find(".data").eq(3).attr("href",a.src)),104==Number(e)){var s=JSON.parse(p[1]);for(let e=0;e<s.length;++e){let a=i.clone();a.find("span").eq(0).text(s[e][0]),a.find("span").eq(3).text(s[e][1]),a.find("span").eq(5).text(s[e][2]),a.find("span").eq(6).text(s[e][3]),a.find("span").eq(9).text(s[e][4]),a.find("span").eq(11).text(s[e][5]),o.find(".data").eq(1).append(a)}}$("#change_application").append(o)}}{r=e.getItemData("ca_fast_file");let a=(t=e.getItemData("ca_fast_item")).dataObj.saved_data.data;for(const[i,s]of Object.entries(a)){let a=d(r.dataObj.saved_data.data,Number(i));p=JSON.parse(s);let u={};var l=3;if(111==Number(i)){u=changeMemberTemplate.clone(),u.find(".data").eq(2).text(p[2]);var o=u.find(".data").find("tbody").eq(0),_=u.find(".data").find("tbody").eq(1),f=o.children("tr").eq(0),h=_.children("tr").eq(0);u.find(".data").find("tbody").empty();let a=CONST.API.APPLICATION_CHANGE.BEFORECHANGE_MEMBER,t=p[1];API.load({url:a.replace("${app_seq}",t),type:CONST.API_TYPE.GET,success:function(e){var a=[];for(let t=0;t<e.length;t++)a.push(e[t]);$.each(a,(function(e,a){var t=f.clone(),n=a.info;n.tmp_phoneno=n.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),1==a.user_seq?t.children("td").eq(0).find("input").prop("checked",!0):(t.children("td").eq(0).find("input").prop("checked",!1),t.children("td").eq(0).find("input").prop("disabled",!0)),1==a.animal_mng_flag?t.children("td").eq(1).find("input").prop("checked",!0):(t.children("td").eq(1).find("input").prop("checked",!1),t.children("td").eq(1).find("input").prop("disabled",!0)),t.children("td").eq(2).text(n.name),t.children("td").eq(3).text(n.dept_str),t.children("td").eq(4).text(n.position_str),t.children("td").eq(5).text(n.major_field_str),t.children("td").eq(6).text(n.tmp_phoneno),t.children("td").eq(7).text(a.exp_year_code_str),o.append(t)}))},error:function(){},complete:function(){}});var m=[],g=e.getItemData("general_director");m.push(g.dataObj.saved_data.data[0]);for(var I=g.dataObj.saved_data.data[0].user_seq,q=e.getItemData("general_expt"),P=0;P<Object.keys(q.dataObj.saved_data.data).length;P++)m.push(q.dataObj.saved_data.data[P]);$.each(m,(function(e,a){var t=h.clone(),n=a.info;n.tmp_phoneno=n.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),I==a.user_seq?t.children("td").eq(0).find("input").prop("checked",!0):(t.children("td").eq(0).find("input").prop("checked",!1),t.children("td").eq(0).find("input").prop("disabled",!0)),1==a.animal_mng_flag?t.children("td").eq(1).find("input").prop("checked",!0):(t.children("td").eq(1).find("input").prop("checked",!1),t.children("td").eq(1).find("input").prop("disabled",!0)),t.children("td").eq(2).text(n.name),t.children("td").eq(3).text(n.dept_str),t.children("td").eq(4).text(n.position_str),t.children("td").eq(5).text(n.major_field_str),t.children("td").eq(6).text(n.tmp_phoneno),t.children("td").eq(7).text(a.exp_year_code_str),_.append(t)}))}else if(112==Number(i)){var A;u=changeEndDateTemplate.clone();let a=CONST.API.APPLICATION_CHANGE.BEFORECHANGE_ENDDATE,t=p[1];API.load({url:a.replace("${app_seq}",t),type:CONST.API_TYPE.GET,success:function(a){var t=e.getParentItemData("application_info");let n=getTimeStrFromDateType(new Date(getDttm(Number(t.getStringValue("approved_dttm"))).dt));A=getTimeStrFromDateType(new Date(a[0][0]));var d=e.getItemData("general_end_date"),r=getTimeStrFromDateType(new Date(d.getStringValue("0")));u.find(".data").eq(2).text(n+"~"+A),u.find(".data").eq(3).text(n+"~"+r),u.find(".data").eq(4).text(p[2])},error:function(){},complete:function(){}}),l=5}else u=changeInfoTemplate.clone(),u.removeClass("regular_review"),u.addClass("simple_review"),u.find(".blue_deep").addClass("green"),u.find(".blue_deep").removeClass("blue_deep"),u.find("span").eq(0).text("[신속]"),u.find("span").eq(1).text(n(t.dataObj.codes,Number(i))),u.find(".data").eq(1).text(p[1]),u.find(".data").eq(2).text(p[2]),u.find("span").eq(2).text(IPSAP.APP_MAIN_TAG_NAME[p[0]]);null==a?u.find(".data").eq(l).text(""):(u.find(".data").eq(l).text(a.org_file_name),u.find(".data").eq(l).attr("href",a.src));c=`newWindowPopup('./_popup_application-info.html#form_${p[0]}')`;u.find("a").first().attr("onclick",c),$("#change_application").append(u)}}switch($(".agree_date").eq(0).text(getDate(g_AppInfo.appObj.submit_dttm)),$(".reviewer").eq(0).text(spaceAddStr(g_AppInfo.appObj.user_name)),$(".task_title_ko").text(g_AppInfo.appObj.name_ko),$(".task_director_all").text(`(연구 책임자 : ${g_AppInfo.appObj.user_name})`),parseInt(g_AppInfo.appObj.application_result)){case IPSAP.APPLICATION_RESULT.SUPPLEMENT:$(".apptype_date").text("보완중"),$(".card-footer").children().eq(0).css("display","none"),$(".card-footer").children().eq(1).css("display","none");break;case IPSAP.APPLICATION_RESULT.CHECKING:case IPSAP.APPLICATION_RESULT.CHECKING_2:$(".apptype_date").text("검토중"),$(".card-footer").children().eq(0).css("display","none"),$(".card-footer").children().eq(1).css("display","none");break;case IPSAP.APPLICATION_RESULT.JUDGE_ING:case IPSAP.APPLICATION_RESULT.JUDGE_ING_2:$(".apptype_date").text("심사중"),$(".card-footer").children().eq(0).css("display","none"),$(".card-footer").children().eq(1).css("display","none");break;case IPSAP.APPLICATION_RESULT.DECISION_ING:$(".apptype_date").text("심의중"),$(".card-footer").children().eq(0).css("display","none"),$(".card-footer").children().eq(1).css("display","none");break;case IPSAP.APPLICATION_RESULT.REJECT:$(".apptype_area").addClass("denied"),$(".apptype_date").text("반려"),$(".card-footer").children().eq(0).css("display","none"),$(".card-footer").children().eq(1).css("display","block");break;case IPSAP.APPLICATION_RESULT.REQUIRE_RETRY:$(".apptype_area").addClass("denied"),$(".apptype_date").text("보완후 재심"),$(".card-footer").children().eq(0).css("display","none"),$(".card-footer").children().eq(1).css("display","block");break;case IPSAP.APPLICATION_RESULT.EXPERIMENT_ING_A:$(".apptype_date").text("실험중 (승인)"),$(".card-footer").children().eq(0).css("display","none"),$(".card-footer").children().eq(1).css("display","block");break;case IPSAP.APPLICATION_RESULT.EXPERIMENT_ING_AC:$(".apptype_date").text("실험중 (조건부 승인)"),$(".card-footer").children().eq(0).css("display","none"),$(".card-footer").children().eq(1).css("display","block");break;case IPSAP.APPLICATION_RESULT.EXPERIMENT_FINISH:$(".apptype_date").text("실험 만료"),$(".card-footer").children().eq(0).css("display","none"),$(".card-footer").children().eq(1).css("display","block");break;case IPSAP.APPLICATION_RESULT.TASK_FINISH:$(".apptype_date").text("실험 종료"),$(".card-footer").children().eq(0).css("display","none"),$(".card-footer").children().eq(1).css("display","block");break;case IPSAP.APPLICATION_RESULT.ACCEPT:$(".apptype_date").text("승인 : "+getDttm(g_AppInfo.appObj.approved_dttm).dt),$(".card-footer").children().eq(0).css("display","none"),$(".card-footer").children().eq(1).css("display","block");break;case IPSAP.APPLICATION_RESULT.ACCEPT_AC:$(".apptype_date").text("조건부 승인 : "+getDttm(g_AppInfo.appObj.approved_dttm).dt),$(".card-footer").children().eq(0).css("display","none"),$(".card-footer").children().eq(1).css("display","block");break;default:$(".card-footer").children().eq(0).css("display","none"),$(".card-footer").children().eq(1).css("display","none")}switch(parseInt(g_AppInfo.appObj.application_step)){case 0:default:$(".progress_area").children().removeClass("active"),$(".progress_area").children().eq(0).addClass("active");break;case 1:$(".progress_area").children().removeClass("active"),$(".progress_area").children().eq(1).addClass("active");break;case 2:$(".progress_area").children().removeClass("active"),$(".progress_area").children().eq(2).addClass("active");break;case 3:$(".progress_area").children().removeClass("active"),$(".progress_area").children().eq(3).addClass("active");break;case 4:$(".progress_area").children().removeClass("active"),$(".progress_area").children().eq(4).addClass("active");break;case 5:$(".progress_area").children().removeClass("active"),$(".progress_area").children().eq(5).addClass("active")}}))}function e(){$(".card").removeClass("hidden")}e()}