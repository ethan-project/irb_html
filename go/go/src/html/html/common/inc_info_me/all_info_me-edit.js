var user_info=JSON.parse(COMM.getCookie(CONST.COOKIE.IPSAP_USER_INFO)),user_seq=user_info.user_seq,tbody1=$(".info_table_content").eq(0).find("tbody"),tbody2=$(".info_table_content").eq(1).find("tbody"),tbody3=$(".info_table_content").eq(2).find("tbody");function loadUserInfo(user_type){switch(null==user_type&&(user_type=IPSAP.USER_TYPE.RESEARCHER),user_type){case IPSAP.USER_TYPE.RESEARCHER:case IPSAP.USER_TYPE.ADMIN_OFFICER:case IPSAP.USER_TYPE.OFFICER:case IPSAP.USER_TYPE.CHAIRMAN:case IPSAP.USER_TYPE.COMMITTEE:}IPSAP.DEMO_MODE||API.load({url:eval("`"+CONST.API.USER.DETAIL+"`"),type:CONST.API_TYPE.GET,success:function(e){tbody1.find("tr").eq(0).find(".data").find("span").eq(1).text(e.institution_name_ko),tbody1.find("tr").eq(0).find(".data").find("span").eq(4).text(e.institution_name_en),tbody1.find("tr").eq(1).find(".data").text(e.institution_code);let t=tbody1.find("tr").eq(2).find(".data"),n="",a=[];a.push(e.user_type_str.split(",")),$.each(a[0],(function(e,t){n+='<span class="label auth_label">',n+=t+"</span>"})),t.html(n),tbody1.find("tr").eq(3).find("input:text").val(e.dept_str),tbody1.find("tr").eq(4).find("input:text").val(e.position_str),tbody1.find("tr").eq(5).find("input:text").val(e.major_field_str),tbody2.find("tr").eq(0).find(".data").text(e.name),tbody2.find("tr").eq(1).find("input:text").val(e.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3")),tbody2.find("tr").eq(2).find(".data").text(e.email),"1"==e.agree_email&&$("#agree_to_receive-email").prop("checked","checked"),"1"==e.agree_sms&&$("#agree_to_receive-sms").prop("checked","checked"),"1"==e.agree_pri_open&&$("#agree_to_open-info").prop("checked","checked"),tbody3.find("tr").eq(0).find("input").val(e.edu_date.replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3")),tbody3.find("tr").eq(1).find("input:text").val(e.edu_institution_str),tbody3.find("tr").eq(2).find("input:text").val(e.edu_course_num)},complete:function(){}})}var pwdValidFlag=!0;function validPwd(){$("#old_password"),$("#new_password"),$("#renew_password")}function changePassword(){var old_password=$("#old_password"),new_password=$("#new_password"),param=$("form").serialize();param=COMM.paramStr2Object(param),param.new_pw=COMM.getEncrypt(COMM.getCookie(CONST.COOKIE.IPSAP_TMP_KEY),new_password.val()),param.old_pw=COMM.getEncrypt(COMM.getCookie(CONST.COOKIE.IPSAP_TMP_KEY),old_password.val()),API.load({url:eval("`"+CONST.API.USER.PATCH_PASS+"`"),type:CONST.API_TYPE.PATCH,data:param,success:function(e){$("#modal_changed_pw").modal("show")},error:function(){alert("입력한 비밀번호가 올바르지 않습니다.\n비밀번호를 다시 확인해주세요.")},complete:function(){$("#modal_change_pw").modal("hide")}})}function setInfo(){var myInfoObj=new Object;$("#agree_to_receive-email").is(":checked")?myInfoObj.agree_email=parseInt($("#agree_to_receive-email").val()):myInfoObj.agree_email=0,$("#agree_to_open-info").is(":checked")?myInfoObj.agree_pri_open=parseInt($("#agree_to_open-info").val()):myInfoObj.agree_pri_open=0,$("#agree_to_receive-sms").is(":checked")?myInfoObj.agree_sms=parseInt($("#agree_to_receive-sms").val()):myInfoObj.agree_sms=0,myInfoObj.dept=tbody1.find("tr").eq(3).find("input:text").val(),myInfoObj.edu_course_num=tbody3.find("tr").eq(2).find("input:text").val(),myInfoObj.edu_date=tbody3.find("tr").eq(0).find("input").val().replaceAll("-",""),myInfoObj.edu_institution=tbody3.find("tr").eq(1).find("input:text").val(),myInfoObj.major_field=tbody1.find("tr").eq(5).find("input:text").val(),myInfoObj.phoneno=tbody2.find("tr").eq(1).find("input:text").val().replaceAll("-",""),myInfoObj.position=tbody1.find("tr").eq(4).find("input:text").val();var param=myInfoObj;API.load({url:eval("`"+CONST.API.USER.PATCH+"`"),type:CONST.API_TYPE.PATCH,data:param,success:function(e){$("#modal_saved").modal("show")},error:function(e){}})}$((function(){$("#modal_change_pw").on("hidden.bs.modal",(function(){$("#modal_change_pw").find(".modal-body").find("input").val(""),$("#valid1").attr("hidden",!0),$("#valid2").attr("hidden",!0),$("#invalid1").attr("hidden",!0),$("#invalid2").attr("hidden",!0)})),$("#modal_change_pw").on("hidden",(function(){$("#modal_change_pw").find(".modal-body").find("input").val(""),$("#valid1").attr("hidden",!0),$("#valid2").attr("hidden",!0),$("#invalid1").attr("hidden",!0),$("#invalid2").attr("hidden",!0)})),$("#btn_change_pw").removeAttr("disabled"),$("#btn_change_pw").on("click",(function(e){e.stopPropagation(),changePassword()})),$("#btn_info_change").on("click",(function(e){e.stopPropagation(),setInfo()}))}));