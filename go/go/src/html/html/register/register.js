"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>");var pwdValidFlag=!1;function pwdValidCheck(){var e=$("#man_pw").val(),a=$("#man_re_pw").val();!/[a-zA-Z]/.test(e)||!/[0-9]/.test(e)||!/[~!@\#$%<>^&*]/.test(e)||e.length<8||e.length>24?($("#modal_pwd").find(".invalid_1").css("display","block"),$("#modal_pwd").find(".invalid_2").css("display","none"),$("#modal_pwd").find(".valid_pwd").css("display","none"),$("#modal_pwd").modal("show"),e="",a=""):(pwdValidFlag=!0,$("#pwdValid").prop("disabled",!0)),e!=a?($("#modal_pwd").find(".invalid_1").css("display","none"),$("#modal_pwd").find(".invalid_2").css("display","block"),$("#modal_pwd").find(".valid_pwd").css("display","none"),$("#modal_pwd").modal("show"),e="",a=""):e.length&&e==a&&($("#modal_pwd").find(".invalid_1").css("display","none"),$("#modal_pwd").find(".invalid_2").css("display","none"),$("#modal_pwd").find(".valid_pwd").css("display","block"),$("#modal_pwd").modal("show"),pwdValidFlag=!0,$("#pwdValid").prop("disabled",!0))}function getInfoSvrMgr(){API.load({url:CONST.API.PLATFORM.ADMIN_USER_INFO,type:CONST.API_TYPE.GET,data:{"filter.user_auth":10},success:function(e){$(".svrMgrPhone").text(e.telno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"))}})}function getInfoSysMgr(){API.load({url:CONST.API.PLATFORM.ADMIN_USER_INFO,type:CONST.API_TYPE.GET,data:{"filter.user_auth":11},success:function(e){$(".sysMgrPhone").text(e.telno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"))}})}$((function(){var e=$(".page-content");$("#org_code").on("input",(function(){$("#org_code").val().length>=3&&$("#org_code").val().length<6?$("#btn-dup-check").attr("disabled",!1):$("#btn-dup-check").attr("disabled",!0)})),$("#btn-dup-check").on("click",(function(){!function(){var e=$("#org_code").val();if(""==e)return $("#modalCode").find(".valid").css("display","none"),void $("#modalCode").find(".invalid > h5").text("입력하신 코드가 없습니다.");if(e.length<3)return $("#modalCode").find(".valid").css("display","none"),void $("#modalCode").find(".invalid > h5").text("최소 3자리 이상 입력이 필요합니다.");API.load({url:CONST.API.COMMON.DUP_CHECK.INST_CODE,type:CONST.API_TYPE.GET,data:{institution_code:e},success:function(e){"ok"==e.rt&&($("#modalCode").find(".valid").css("display","block"),$("#modalCode").find(".invalid").css("display","none"),$("#dup-checked").val("y"))},error:function(e){3==e.responseJSON.e&&($("#modalCode").find(".valid").css("display","none"),$("#modalCode").find(".invalid > h5").text("이미 등록된 기관 코드입니다. 기관 코드를 다시 확인해주세요."),$("#org_code").val(""))}})}()})),$("#man_pw, #man_re_pw").on("input",(function(){$("#pwdValid").prop("disabled",!1)})),$("#org_name_kr").on("keyup",(function(){$(this).val($(this).val().replace(/[^가-힣0-9\s]/gi,""))})),$("#man_name_kr").on("keyup",(function(){$(this).val($(this).val().replace(/[^가-힣0-9]/gi,""))})),$("#org_name_en").on("keyup",(function(){$(this).val($(this).val().replace(/[^a-zA-Z0-9\s]/gi,""))})),$("#man_name_en").on("keyup",(function(){$(this).val($(this).val().replace(/[^a-zA-Z0-9\s-]/gi,""))})),$("#org_code").on("keyup",(function(){$(this).val($(this).val().replace(/[^A-Z0-9]/g,""))})),$("#org_logo_file").on("change",(function(){!function(){var a=e.find("#bodyForm").find("#org_logo_file")[0].files[0];if(""!=$("#org_logo_file").val()){let e=a.name.split(".").pop().toLowerCase();if(-1==$.inArray(e,["jpg","png","jpeg","ico","tiff","svg"]))return alert(".jpg, .png, .jpeg, .tiff 등 이미지 파일 형식으로 첨부해 주십시오."),void $("#org_logo_file").val("");if(a.size>20971520)$("#modal_file_alert").modal("show"),$("#org_logo_file").val("")}}()})),$("#org_registration_file").on("change",(function(){!function(){var a=e.find("#bodyForm").find("#org_registration_file")[0].files[0];if(""!=$("#org_registration_file").val()){let e=a.name.split(".").pop().toLowerCase();if(-1==$.inArray(e,["jpg","png","jpeg","ico","tiff","svg","pdf"]))return alert(".jpg, .png, .pdf, .tiff 등 이미지 파일 형식으로 첨부해 주십시오."),void $("#org_registration_file").val("");if(a.size>20971520)$("#modal_file_alert").modal("show"),$("#org_registration_file").val("")}}()})),$("input:radio[name=org_rule_1]").on("click",(function(){"1"==$("input:radio[name=org_rule_1]:checked").val()?($("#IACUC_agree_point").attr("disabled",!1),$("#IACUC_agree_count").attr("disabled",!0),$("#IACUC_agree_count").val(0)):"2"==$("input:radio[name=org_rule_1]:checked").val()?($("#IACUC_agree_count").attr("disabled",!1),$("#IACUC_agree_point").attr("disabled",!0),$("#IACUC_agree_point").val(0)):"3"==$("input:radio[name=org_rule_1]:checked").val()&&($("#IACUC_agree_count").attr("disabled",!0),$("#IACUC_agree_point").attr("disabled",!0),$("#IACUC_agree_count").val(0),$("#IACUC_agree_point").val(0))})),$(".btn-file-delete").on("click",(function(){var e=$(this).siblings().find("input:file"),a=$(this).siblings().find("label");e.val(""),a[0].innerHTML="File을 선택해 주세요."})),$("#register").on("click",(function(){return""==$("#dup-checked").val()?(getInfoSysMgr(),$("#modal_error_code").text("기관코드 중복 확인을 해주세요."),$("#modal_register_error").modal("show"),!1):0==pwdValidFlag?(getInfoSysMgr(),$("#modal_error_code").text("비밀번호 확인을 다시 진행해주세요."),$("#modal_register_error").modal("show"),!1):void(1==pwdValidFlag&&function(){var a=e.find("#bodyForm").find("#org_logo_file")[0].files[0],n=e.find("#bodyForm").find("#org_registration_file")[0].files[0],i=[];$('input:checkbox[name="evaluation_type"]').each((function(){this.checked&&i.push(this.value)}));var o=[];$('input:checkbox[name="payment_type"]').each((function(){this.checked&&o.push(this.value)}));var l=new Object;l.addr1=$("#addr_str_1").text(),l.addr2=$("#addr_str_2").val(),l.business_num=$("#org_registration_num").val().replaceAll("-",""),l.homepage_url=$("#org_url").val(),l.ia_base_item=parseInt($("#IACUC_agree_count").val()),l.ia_base_score=parseInt($("#IACUC_agree_point").val()),l.ia_evaluation_method=parseInt($("input:radio[name=org_rule_1]:checked").val()),l.ia_final_director=parseInt($("input:radio[name=org_rule_2]:checked").val()),l.institution_code=$("#org_code").val(),l.institution_type=parseInt($("input:radio[name=org_type]:checked").val()),l.invoice_flag=parseInt($("input:radio[name=org_invoice]:checked").val()),l.judge_type=i.toString(),l.name_en=$("#org_name_en").val(),l.name_ko=$("#org_name_kr").val(),l.payment_method=o.toString(),l.zipcode=$("#org_zipcode").val();var t=new Object;t.agree_email=parseInt($("#agree_email").val()),t.agree_pri_open=parseInt($("#agree_info").val()),t.agree_sms=parseInt($("#agree_sms").val()),t.dept=$("#man_part").val(),t.email=$("#man_id").val(),t.name=$("#man_name_kr").val(),t.name_en=$("#man_name_en").val(),t.phoneno=$("#man_cell").val().replaceAll("-",""),t.position=$("#man_position").val(),t.pwd=$("#man_pw").val(),t.telno=$("#man_tel").val().replaceAll("-","");var d=new Object;d.institution=l,d.user=t;var r=JSON.stringify(d),s=new FormData;s.append("logo_file",a),s.append("business_file",n),s.append("request_service",r),API.load({url:CONST.API.REQUEST.SERVICE,type:CONST.API_TYPE.POST,enctype:"multipart/form-data",data:s,contentType:!1,processData:!1,success:function(e){getInfoSvrMgr(),$("#modal_register_completed").modal("show")},complete:function(){},error:function(e){getInfoSysMgr(),$("#modal_error_code").text("필수 항목 미기재"),$("#modal_register_error").modal("show")}})}())}))}));