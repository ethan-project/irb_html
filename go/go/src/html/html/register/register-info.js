"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>");var user_info=JSON.parse(COMM.getCookie(CONST.COOKIE.IPSAP_USER_INFO));if(user_info)var user_seq=user_info.user_seq,institution_seq=user_info.institution_seq,user_status=user_info.user_status;var tmp_key=COMM.getCookie(CONST.COOKIE.IPSAP_TMP_KEY),tbody1=$(".info_table_content").eq(0).find("tbody"),tbody2=$(".info_table_content").eq(1).find("tbody"),tbody3=$(".info_table_content").eq(2).find("tbody");function getInfo(t){let e=CONST.API.USER.DETAIL;API.load({url:e.replace("${user_seq}",user_seq),type:CONST.API_TYPE.GET,success:function(e){tbody1.find("tr").eq(0).find(".data").find("span").eq(1).text(e.institution_name_ko),tbody1.find("tr").eq(0).find(".data").find("span").eq(4).text(e.institution_name_en),tbody1.find("tr").eq(1).find(".data").text(e.institution_code);let n=tbody1.find("tr").eq(2).find(".data"),i="",o=[];o.push(e.user_type_str.split(",")),$.each(o[0],(function(t,e){i+='<span class="label auth_label">',i+=e+"</span>"})),n.html(i),tbody1.find("tr").eq(3).find("input:text").val(e.dept_str),tbody1.find("tr").eq(4).find("input:text").val(e.position_str),tbody1.find("tr").eq(5).find("input:text").val(e.major_field_str);let d=tbody2.find("tr").eq(0).find("input:text");d.val(e.name),3==t&&d.prop("readonly",!0);let a=tbody2.find("tr").eq(1).find("input:text");a.val(e.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3")),3==t&&a.prop("readonly",!0),tbody2.find("tr").eq(2).find(".data").text(e.email),3==t&&tbody2.find("tr").eq(3).css("display","none"),tbody3.find("tr").eq(0).find("input").val(e.edu_date.replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3")),tbody3.find("tr").eq(1).find("input:text").val(e.edu_institution_str),tbody3.find("tr").eq(2).find("input:text").val(e.edu_course_num)},complete:function(){$(".card").removeClass("hidden"),validPassword()}})}function validPassword(){var t=$("#new_password"),e=$("#renew_password");$("#renew_password").on("keyup",(function(n){if(t.val()==e.val())$(".blue_deep").removeAttr("hidden"),$(".pwd_red").attr("hidden",!0);else if(t.val()!=e.val())return $(".blue_deep").attr("hidden",!0),$(".pwd_red").removeAttr("hidden"),!1}))}function setInfo(user_status){var myInfoObj=new Object;if(myInfoObj.agree_email=parseInt($("#agree_to_receive-email").val()),myInfoObj.agree_pri_open=parseInt($("#agree_to_open-info").val()),myInfoObj.agree_sms=parseInt($("#agree_to_receive-sms").val()),myInfoObj.dept=tbody1.find("tr").eq(3).find("input:text").val(),myInfoObj.edu_course_num=tbody3.find("tr").eq(2).find("input:text").val(),myInfoObj.edu_date=tbody3.find("tr").eq(0).find("input").val().replaceAll("-",""),myInfoObj.edu_institution=tbody3.find("tr").eq(1).find("input:text").val(),myInfoObj.major_field=tbody1.find("tr").eq(5).find("input:text").val(),myInfoObj.phoneno=tbody2.find("tr").eq(1).find("input:text").val().replaceAll("-",""),myInfoObj.position=tbody1.find("tr").eq(4).find("input:text").val(),1==user_status){if(myInfoObj.name=tbody2.find("tr").eq(0).find("input:text").val(),myInfoObj.tmp_key=tmp_key,myInfoObj.institution_seq=parseInt(institution_seq),$("#new_password").val()!=$("#renew_password").val())return void alert("입력하신 비밀번호가 일치하지 않습니다.");myInfoObj.pwd=COMM.getEncrypt(tmp_key,$("#new_password").val());var param=myInfoObj;API.load({url:eval("`"+CONST.API.USER.REGISTER+"`"),type:CONST.API_TYPE.PATCH,data:param,success:function(t){COMM.clearCookie(),window.location.href="/index.html"},error:function(t){alert("필수 정보를 입력해주세요.")}})}else if(3==user_status){var param=myInfoObj;API.load({url:eval("`"+CONST.API.USER.PATCH+"`"),type:CONST.API_TYPE.PATCH,data:param,success:function(t){},error:function(t){},complete:function(){COMM.clearCookie(),window.location.href="/index.html"}})}}$((function(){if(IPSAP.DEMO_MODE)$(".card").removeClass("hidden");else{$("page-content");$("#btn_register").on("click",(function(){setInfo(user_status)})),user_info&&getInfo(user_status)}}));