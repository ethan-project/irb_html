var g_trTemplete;"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof ipsap_item_module_js&&document.write("<script src='/assets/js/ipsap/ipsap_item_module.js'><\/script>"),document.write("<script src='/html/researcher/application_new-0.js'><\/script>");var user_info=JSON.parse(COMM.getCookie(CONST.COOKIE.IPSAP_USER_INFO)),inst_info=JSON.parse(COMM.getCookie(CONST.COOKIE.IPSAP_INST_INFO));function originalJSFunction(e){}function sumPoint(e){var t=0,a="fail";e.each((function(e,a){if("undefined"==$(a).text()||"-"==$(a).text())return 0;t+=parseInt($(a).text())})),a=t>=parseInt(inst_info.ia_base_score)?"pass":a,$("#total_sum").html(`<span class="${a}">${t}</span> / 100`)}function sumAccount(e){var t=0,a="fail";e.each((function(e,a){"적합"==$(a).text()&&t++})),a=t>=parseInt(inst_info.ia_base_item)?"pass":a,$("#total_account").html(`<span class="${a}">${t}</span> / 10`)}function dataMappingFunc(e){(t=e.getItemData("final_judge_result")).makeHtmlRadioType(IPSAP.COL.ALL,0);var t=e.getItemData("general_title",!0);$("#coding_title_area").children("div").eq(0).children("span").text(t.getStringValue("name_ko")),$("#coding_title_area").children("div").eq(1).children("span").text(t.getStringValue("name_en"));t=e.getItemData("general_end_date",!0);"0"==g_AppInfo.appObj.approved_dttm?$("#coding_title_area").children("div").eq(2).children("span").text("위원회 승인일 ~ "+t.getStringValue("0")):$("#coding_title_area").children("div").eq(2).children("span").text(getDttm(g_AppInfo.appObj.approved_dttm).dt+" ~ "+t.getStringValue("0")),(t=e.getItemData("expert_review_total_review")).applyTextValueReadOnly();{t=e.getItemData("expert_review_result");let b=0;try{b=Number(t.dataObj.saved_data.data[0].select_ids[0])}catch(j){}let O="";try{O=t.dataObj.saved_data.data[0].inputs[String(b)][1]}catch(S){}let q="";for(let I=0;I<t.dataObj.items.length;++I)if(t.dataObj.items[I].id==b){q=t.dataObj.items[I].value;break}$("#expert_review_result_text").prev(".custom-radio").find("label").text(q),""!=O?$("#expert_review_result_text").text(O):$("#expert_review_result_text").remove()}{t=e.getItemData("expert_member");var a="";try{a=t.dataObj.saved_data.data[0].info.name}catch(y){}$("#experter").text(spaceAddStr(a));var i=0;try{i=t.dataObj.saved_data.data[0].user_seq}catch(A){}var n=e.getItemData("expert_review_dttm");const w=new Date(1e3*n.dataObj.saved_data.data[String(i)]);$("#expert_submit_date").text(getTimeStrFromDateType(w))}let r,s=!0;{var d=e.getItemData("expert_review_opinion",!0),l=e.getItemData("expert_review_evaluation",!0);let D=$(".list_table").first().find("tbody");r=l.dataObj.codes;for(let C=0;C<r.length;++C){let P=g_trTemplete.clone();P.children("td").eq(0).text(r[C].contents);let N=P.children("td").eq(1),T=N.children("ul").children("li").first().clone();N.children("ul").empty();for(let k=0;k<r[C].sub_items.length;++k){let M=T.clone();M.text(r[C].sub_items[k].contents),N.children("ul").append(M)}try{let R=d.dataObj.saved_data.data[r[C].is_seq];var o=JSON.parse(R);let F=P.children("td").eq(2);F.empty();let V="";for(let J=0;J<o.select.length;++J){let L=o.select[J],H=d.dataObj.codes[C].sub_items;for(let U=0;U<H.length;++U)if(L==H[U].is_seq){""!=V&&(V+="<br>"),V+=H[U].contents;break}}F.removeClass("noComment"),F.append(`<div class="review_numbers">${V}</div>`),F.append(`<div class="review_desc text-wrap">${o.text}</div>`)}catch(K){}let E=P.children("td").eq(3);if(E.hasClass("evaluation_score")){let Y=`review_point_${r[C].is_seq}`;E.attr("name",Y)}else{let z=`review_pass_${r[C].is_seq}`;E.attr("name",z),s=!1}D.append(P)}}{var _=$(".list_table").eq(1).children("tbody").children("tr").first().clone();$(".list_table").eq(1).children("tbody").empty();var c=e.getItemData("normal_review_result",!0),m=e.getItemData("committee_in_member",!0),p=e.getItemData("committee_ex_member",!0),u=e.getItemData("normal_review_dttm",!0);let B=1;const G=m.dataObj.saved_data.data,Q=p.dataObj.saved_data.data;var v,h,g=[0,0,0];if(null!=G)for(let W=0;W<G.length;++W){v=void 0;try{v=c.dataObj.saved_data.data[String(G[W].info.user_seq)]}catch(X){}h=void 0;try{h=u.dataObj.saved_data.data[String(G[W].info.user_seq)]}catch(Z){}g[x(B++,G[W],"내부",v,h)]++}if(null!=Q)for(let ee=0;ee<Q.length;++ee){v=void 0;try{v=c.dataObj.saved_data.data[String(Q[ee].info.user_seq)]}catch(te){}h=void 0;try{h=u.dataObj.saved_data.data[String(Q[ee].info.user_seq)]}catch(ae){}g[x(B++,Q[ee],"외부",v,h)]++}var f=$(".list_table").eq(1).children("tfoot");function x(e,t,a,i,n){var r=0,s=_.clone();s.removeClass("agree");let d=0;if(s.attr("user_seq",t.user_seq),s.children("td").eq(d++).text(e),s.children("td").eq(d++).text(t.info.name),s.children("td").eq(d++).text(a),null!=i&&n>0)if(s.children("td").eq(d++).text(getYMDHMSFromUnixtime(n,!0)),"1"==i.select_ids[0]){let e=i.inputs[1][1];s.addClass("agree"),s.children("td").eq(d++).text("찬성"),s.children("td").eq(d++).html(`\n          <a href="javascript:void(0);" onclick="onClickShowAgreeReason('${e}');" class="blue_deep">\n            <i class="fas fa-comment-dots mRight5"></i>${stringShortDot(e,15)}\n          </a>`)}else{r=1,s.addClass("disagree");let e=i.inputs[2][1];s.children("td").eq(d++).text("반대"),s.children("td").eq(d++).html(`\n            <a href="javascript:void(0);" onclick="onClickShowOpposeReason('${e}');" class="red">\n              <i class="fas fa-comment-dots mRight5"></i>${stringShortDot(e,15)}\n            </a>`)}else r=2,s.addClass("timeout"),s.children("td").eq(d++).text("-"),s.children("td").eq(d++).text("-"),s.children("td").eq(d++).text("미이행");return $(".list_table").eq(1).children("tbody").append(s),r}f.children("tr").children("td").eq(1).children("span").eq(0).children("span").text(g[0]),f.children("tr").children("td").eq(1).children("span").eq(1).children("span").text(g[1]),f.children("tr").children("td").eq(1).children("span").eq(2).children("span").text(g[2])}{t=e.getItemData("final_judge_result");let ie=0;try{ie=Number(t.dataObj.saved_data.data[0].select_ids[0])}catch(se){}let ne="";try{ne=t.dataObj.saved_data.data[0].inputs[String(ie)][1]}catch(de){}let re="";for(let le=0;le<t.dataObj.items.length;++le)if(t.dataObj.items[le].id==ie){re=t.dataObj.items[le].value;break}$("#final_judge_result_text").prev(".custom-radio").find("label").text(re),""!=ne?$("#final_judge_result_text").text(ne):$("#final_judge_result_text").remove()}originalJSFunction();for(let oe=0;oe<r.length;++oe)if(s){let _e=`review_point_${r[oe].is_seq}`;try{let ce=l.dataObj.saved_data.data[r[oe].is_seq];ce<2?ce=2:ce||(ce="-"),$(`td[name=${_e}]`).text(`${ce}`)}catch(me){}}else{let pe=`review_pass_${r[oe].is_seq}`;try{l.dataObj.saved_data.data[r[oe].is_seq]>0?$(`td[name=${pe}]`).text("적합"):$(`td[name=${pe}]`).text("부적합")}catch(ue){}}sumPoint($("td.evaluation_score").not(":last")),sumAccount($("td.evaluation_yn").not(":last")),$(".card").removeClass("hidden")}function onClickShowAgreeReason(e){$(".agree_reason").text(e),$("#modal_agree_comment").modal("show")}function onClickShowOpposeReason(e){$(".oppose_reason").text(e),$("#modal_disagree_comment").modal("show")}$((function(){loadApplicationParams(),function(e){if(IPSAP.DEMO_MODE)originalJSFunction();else{inst_info.ia_evaluation_method==IPSAP.EVALUATION_METHOD.SCORE?$(".evaluation_yn").remove():inst_info.ia_evaluation_method==IPSAP.EVALUATION_METHOD.YN?$(".evaluation_score").remove():inst_info.ia_evaluation_method==IPSAP.EVALUATION_METHOD.NONE?($(".evaluation_score").remove(),$(".evaluation_yn").remove(),e.find("tfoot").find(".text-right").text("")):alert("Error!!!");let t=$(".list_table").first().find("tbody");g_trTemplete=t.children("tr").first().clone(),t.empty();let a={"filter.query_items":"general_title,general_end_date,final_judge_result,expert_review_opinion,expert_review,expert_member,committee_in_member,committee_ex_member,normal_review_result,normal_review_dttm"};g_AppItemParser=new ItemParser(g_AppInfo.appSeq),g_AppItemParser.load(a,dataMappingFunc)}}($(".page-content"))}));