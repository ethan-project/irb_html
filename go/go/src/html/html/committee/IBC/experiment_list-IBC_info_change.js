var changeInfoTemplate,changeMemberTemplate,changeEndDateTemplate;"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof ipsap_item_module_js&&document.write("<script src='/assets/js/ipsap/ipsap_item_module.js'><\/script>"),document.write("<script src='/html/researcher/IBC/common_application_new-IBC.js'><\/script>");const member_is_seq=286,end_date_is_seq=288;function dataMappingFunc(e){var t=e.getParentItemData("general_title");$("#name_ko").text(t.getStringValue("name_ko")),$("#name_en").text(t.getStringValue("name_en"));{t=e.getParentItemData("application_info");let a=Number(t.getStringValue("approved_dttm"));$("#approved_dttm").text(getDttm(a).dt)}t=e.getParentItemData("general_end_date");function a(e,t){for(let a=0;a<e.length;++a)if(e[a].is_seq==t)return e[a].contents;return"Error!!"}function n(e,t){for(let a=0;a<e.length;++a)if(e[a].file_idx==t)return e[a]}$("#general_end_date").text(t.getStringValue("0"));{var d=e.getItemData("ibc_ca_file");let b=(t=e.getItemData("ibc_ca_item")).dataObj.saved_data.data;for(const[v,I]of Object.entries(b)){let b=n(d.dataObj.saved_data.data,Number(v));var i=JSON.parse(I);let A={};var r=3;if(286==Number(v)){A=changeMemberTemplate.clone(),A.find(".data").eq(2).text(i[2]);var p=A.find(".data").find("tbody").eq(0),c=A.find(".data").find("tbody").eq(1),l=p.children("tr").eq(0),o=c.children("tr").eq(0);A.find(".data").find("tbody").empty();let t=CONST.API.APPLICATION_CHANGE.BEFORECHANGE_MEMBER,a=i[1];API.load({url:t.replace("${app_seq}",a),type:CONST.API_TYPE.GET,success:function(e){var t=[];for(let a=0;a<e.length;a++)t.push(e[a]);$.each(t,(function(e,t){let a="";if(t.edu_course){let e=JSON.parse(t.edu_course);for(const t in e)a+=`\n                  <div class="flexMid">\n                    <span class="w120 mRight5">${t}</span>\n                    <div>${e[t]}</div>\n                  </div>`}var n=l.clone(),d=t.info;d.tmp_phoneno=d.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),1==t.user_seq?n.children("td").eq(0).find("input").prop("checked",!0):(n.children("td").eq(0).find("input").prop("checked",!1),n.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?n.children("td").eq(1).find("input").prop("checked",!0):(n.children("td").eq(1).find("input").prop("checked",!1),n.children("td").eq(1).find("input").prop("disabled",!0)),n.children("td").eq(2).text(d.name),n.children("td").eq(3).text(d.dept_str),n.children("td").eq(4).append(a),p.append(n)}))},error:function(){},complete:function(){}});var s=[],_=e.getItemData("general_director");s.push(_.dataObj.saved_data.data[0]);for(var f=_.dataObj.saved_data.data[0].user_seq,m=e.getItemData("general_expt"),u=0;u<Object.keys(m.dataObj.saved_data.data).length;u++)s.push(m.dataObj.saved_data.data[u]);$.each(s,(function(e,t){let a="";if(t.edu_course){let e=JSON.parse(t.edu_course);for(const t in e)a+=`\n              <div class="flexMid">\n                <span class="w120 mRight5">${t}</span>\n                <div>${e[t]}</div>\n              </div>`}var n=o.clone(),d=t.info;f==t.user_seq?n.children("td").eq(0).find("input").prop("checked",!0):(n.children("td").eq(0).find("input").prop("checked",!1),n.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?n.children("td").eq(1).find("input").prop("checked",!0):(n.children("td").eq(1).find("input").prop("checked",!1),n.children("td").eq(1).find("input").prop("disabled",!0)),n.children("td").eq(2).text(d.name),n.children("td").eq(3).text(d.dept_str),n.children("td").eq(4).append(a),c.append(n)}))}else if(288==Number(v)){var g;A=changeEndDateTemplate.clone();let t=CONST.API.APPLICATION_CHANGE.BEFORECHANGE_ENDDATE,a=i[1];API.load({url:t.replace("${app_seq}",a),type:CONST.API_TYPE.GET,success:function(t){var a=e.getParentItemData("application_info");let n=getTimeStrFromDateType(new Date(getDttm(Number(a.getStringValue("approved_dttm"))).dt));g=getTimeStrFromDateType(new Date(t[0][0]));var d=e.getItemData("general_end_date"),r=getTimeStrFromDateType(new Date(d.getStringValue("0")));A.find(".data").eq(2).text(n+"~"+g),A.find(".data").eq(3).text(n+"~"+r),A.find(".data").eq(4).text(i[2])},error:function(){},complete:function(){}}),A.find(".data").eq(4).text(i[2]),r=5}else A=changeInfoTemplate.clone(),A.find("label").eq(0).text(a(t.dataObj.codes,Number(v))),A.find(".data").eq(1).text(i[1]),A.find(".data").eq(2).text(i[2]);null==b?A.find(".data").eq(r).text(""):(A.find(".data").eq(r).text(b.org_file_name),A.find(".data").eq(r).attr("href",b.src));var h=`newWindowPopup('./_popup_app-IBC_info_all.html#form_${i[0]}')`;A.find("a").first().attr("onclick",h),A.find("a").eq(0).empty();var q=`<i class="fas fa-link mRight5"></i>심의 신청서 : ${IPSAP.IBC_MAIN_TAGE_NAME[i[0]]}`;A.find("a").eq(0).append(q),$("#change_application").append(A)}}$(".agree_date").text(getDate(g_AppInfo.appObj.submit_dttm)),$(".reviewer").text(spaceAddStr(g_AppInfo.appObj.user_name)),"전문심사"==g_AppInfo.appObj.committee_judge_type_str?$(".card-footer").children().eq(1).css("display","none"):"일반심사"==g_AppInfo.appObj.committee_judge_type_str&&$(".card-footer").children().eq(0).css("display","none"),$(".card").removeClass("hidden")}$((function(){loadApplicationParams();changeInfoTemplate=$("#change_application").children("ul").eq(0).clone(),changeMemberTemplate=$("#change_application").children("ul").eq(1).clone(),changeEndDateTemplate=$("#change_application").children("ul").eq(2).clone(),$("#change_application").empty(),$("#change_application").removeClass("hidden"),g_AppItemParser=new ItemParser(g_AppInfo.childAppSeq),g_AppItemParser.load({"filter.query_items":"ibc_change_application","filter.parent_items":"general_title,general_end_date,application_info,general_director,general_expt,ibc_general_experiment"},dataMappingFunc)}));