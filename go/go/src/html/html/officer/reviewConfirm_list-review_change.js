var changeInfoTemplate,changeMemberTemplate,changeEndDateTemplate;"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof ipsap_item_module_js&&document.write("<script src='/assets/js/ipsap/ipsap_item_module.js'><\/script>"),document.write("<script src='/html/researcher/application_new-0.js'><\/script>");const animal_is_seq=104,member_is_seq=111,end_date_is_seq=112;function originalJSFunction(){}function dataMappingFunc(e){var t,a=e.getItemData("ca_regular_item");(t=0==Object.keys(a.dataObj.saved_data.data).length)&&$("#fast_hide_area").remove();var n=e.getParentItemData("general_title");$("#name_ko").text(n.getStringValue("name_ko")),$("#name_en").text(n.getStringValue("name_en"));{n=e.getParentItemData("application_info");let G=Number(n.getStringValue("approved_dttm"));$("#approved_dttm").text(getDttm(G).dt)}n=e.getParentItemData("general_end_date");function d(e,t){for(let a=0;a<e.length;++a)if(e[a].is_seq==t)return e[a].contents;return"Error!!"}function i(e,t){for(let a=0;a<e.length;++a)if(e[a].file_idx==t)return e[a]}$("#general_end_date").text(n.getStringValue("0"));{var r=e.getItemData("ca_regular_file");let Y=(n=e.getItemData("ca_regular_item")).dataObj.saved_data.data;for(const[B,H]of Object.entries(Y)){let W=i(r.dataObj.saved_data.data,Number(B)),Q=changeInfoTemplate.clone();Q.find("span").eq(0).text("[정규]"),Q.find("span").eq(1).text(d(n.dataObj.codes,Number(B)));var l,s=JSON.parse(H);104==Number(B)?(l=Q.find(".data").eq(1).children("div").first().clone(),Q.find(".data").eq(1).empty()):Q.find(".data").eq(1).text(s[1]),Q.find(".data").eq(2).text(s[2]),Q.find("span").eq(2).text(IPSAP.APP_MAIN_TAG_NAME[s[0]]);var o=`newWindowPopup('./_popup_application-info.html#form_${s[0]}')`;if(Q.find("a").first().attr("onclick",o),null==W?Q.find(".data").eq(3).text(""):(Q.find(".data").eq(3).text(W.org_file_name),Q.find(".data").eq(3).attr("href",W.src)),104==Number(B)){var c=JSON.parse(s[1]);for(let z=0;z<c.length;++z){let K=l.clone();K.find("span").eq(0).text(c[z][0]),K.find("span").eq(3).text(c[z][1]),K.find("span").eq(5).text(c[z][2]),K.find("span").eq(6).text(c[z][3]),K.find("span").eq(9).text(c[z][4]),K.find("span").eq(11).text(c[z][5]),Q.find(".data").eq(1).append(K)}}$("#change_application").append(Q)}}{r=e.getItemData("ca_fast_file");let X=(n=e.getItemData("ca_fast_item")).dataObj.saved_data.data;for(const[Z,ee]of Object.entries(X)){let te=i(r.dataObj.saved_data.data,Number(Z));s=JSON.parse(ee);let ae={};var _=3;if(111==Number(Z)){ae=changeMemberTemplate.clone(),ae.find(".data").eq(2).text(s[2]);var p=ae.find(".data").find("tbody").eq(0),m=ae.find(".data").find("tbody").eq(1),f=p.children("tr").eq(0),h=m.children("tr").eq(0);ae.find(".data").find("tbody").empty();var g=[],u=e.getParentItemData("general_director");g.push(u.dataObj.saved_data.data[0]);for(var q=u.dataObj.saved_data.data[0].user_seq,v=e.getParentItemData("general_expt"),b=0;b<Object.keys(v.dataObj.saved_data.data).length;b++)g.push(v.dataObj.saved_data.data[b]);$.each(g,(function(e,t){var a=f.clone(),n=t.info;n.tmp_phoneno=n.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),q==t.user_seq?a.children("td").eq(0).find("input").prop("checked",!0):(a.children("td").eq(0).find("input").prop("checked",!1),a.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?a.children("td").eq(1).find("input").prop("checked",!0):(a.children("td").eq(1).find("input").prop("checked",!1),a.children("td").eq(1).find("input").prop("disabled",!0)),a.children("td").eq(2).text(n.name),a.children("td").eq(3).text(n.dept_str),a.children("td").eq(4).text(n.position_str),a.children("td").eq(5).text(n.major_field_str),a.children("td").eq(6).text(n.tmp_phoneno),a.children("td").eq(7).text(t.exp_year_code_str),p.append(a)}));var x=[],j=e.getItemData("general_director");x.push(j.dataObj.saved_data.data[0]);var I=j.dataObj.saved_data.data[0].user_seq,P=e.getItemData("general_expt");for(b=0;b<Object.keys(P.dataObj.saved_data.data).length;b++)x.push(P.dataObj.saved_data.data[b]);$.each(x,(function(e,t){var a=h.clone(),n=t.info;n.tmp_phoneno=n.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),I==t.user_seq?a.children("td").eq(0).find("input").prop("checked",!0):(a.children("td").eq(0).find("input").prop("checked",!1),a.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?a.children("td").eq(1).find("input").prop("checked",!0):(a.children("td").eq(1).find("input").prop("checked",!1),a.children("td").eq(1).find("input").prop("disabled",!0)),a.children("td").eq(2).text(n.name),a.children("td").eq(3).text(n.dept_str),a.children("td").eq(4).text(n.position_str),a.children("td").eq(5).text(n.major_field_str),a.children("td").eq(6).text(n.tmp_phoneno),a.children("td").eq(7).text(t.exp_year_code_str),m.append(a)}))}else if(112==Number(Z)){ae=changeEndDateTemplate.clone();var S=e.getParentItemData("application_info");let ne=getTimeStrFromDateType(new Date(getDttm(Number(S.getStringValue("approved_dttm"))).dt));var A=e.getParentItemData("general_end_date"),D=getTimeStrFromDateType(new Date(A.getStringValue("0"))),O=e.getItemData("general_end_date"),w=getTimeStrFromDateType(new Date(O.getStringValue("0")));ae.find(".data").eq(2).text(ne+"~"+D),ae.find(".data").eq(3).text(ne+"~"+w),ae.find(".data").eq(4).text(s[2]),_=5}else ae=changeInfoTemplate.clone(),ae.removeClass("regular_review"),ae.addClass("simple_review"),ae.find(".blue_deep").addClass("green"),ae.find(".blue_deep").removeClass("blue_deep"),ae.find("span").eq(0).text("[신속]"),ae.find("span").eq(1).text(d(n.dataObj.codes,Number(Z))),ae.find(".data").eq(1).text(s[1]),ae.find(".data").eq(2).text(s[2]),ae.find("span").eq(2).text(IPSAP.APP_MAIN_TAG_NAME[s[0]]);null==te?ae.find(".data").eq(_).text(""):(ae.find(".data").eq(_).text(te.org_file_name),ae.find(".data").eq(_).attr("href",te.src));o=`newWindowPopup('./_popup_application-info.html#form_${s[0]}')`;ae.find("a").first().attr("onclick",o),$("#change_application").append(ae)}}if($(".agree_date").eq(0).text(getDate(g_AppInfo.appObj.submit_dttm)),$(".reviewer").eq(0).text(spaceAddStr(g_AppInfo.appObj.user_name)),!t){try{var n=e.getItemData("expert_review_result");let de=Number(n.dataObj.saved_data.data[0].select_ids[0]),ie="";try{ie=n.dataObj.saved_data.data[0].inputs[String(de)][1]}catch(le){}let re="";for(let se=0;se<n.dataObj.items.length;++se)if(n.dataObj.items[se].id==de){re=n.dataObj.items[se].value;break}$("#expert_review_result").text(re),""!=ie?$("#expert_review_result_text").text(ie):$("#expert_review_result_text").remove()}catch(oe){}{var T=(n=e.getItemData("expert_member")).dataObj.saved_data.data[0].info.name;$(".reviewer").eq(1).text(spaceAddStr(T));var y=n.dataObj.saved_data.data[0].user_seq,k=e.getItemData("expert_review_dttm");const ce=new Date(1e3*k.dataObj.saved_data.data[String(y)]);$(".agree_date").eq(1).text(getTimeStrFromDateType(ce))}{var E=$(".list_table").eq(0).children("tbody").children("tr").first().clone();$(".list_table").eq(0).children("tbody").empty();var N=e.getItemData("normal_review_result",!0),M=e.getItemData("committee_in_member",!0),C=e.getItemData("committee_ex_member",!0),F=e.getItemData("normal_review_dttm",!0);let _e=1;const pe=M.dataObj.saved_data.data,me=C.dataObj.saved_data.data;var R,J,U=[0,0,0];if(null!=pe)for(let fe=0;fe<pe.length;++fe){R=void 0;try{R=N.dataObj.saved_data.data[String(pe[fe].info.user_seq)]}catch(he){}J=void 0;try{J=F.dataObj.saved_data.data[String(pe[fe].info.user_seq)]}catch(ge){}U[V(_e++,pe[fe],"내부",R,J)]++}if(null!=me)for(let ue=0;ue<me.length;++ue){R=void 0;try{R=N.dataObj.saved_data.data[String(me[ue].info.user_seq)]}catch(qe){}J=void 0;try{J=F.dataObj.saved_data.data[String(pe[ue].info.user_seq)]}catch(ve){}U[V(_e++,me[ue],"외부",R,J)]++}var L=$(".list_table").eq(0).children("tfoot");function V(e,t,a,n,d){var i=0,r=E.clone();r.removeClass("agree");let l=0;if(r.attr("user_seq",t.user_seq),r.children("td").eq(l++).text(e),r.children("td").eq(l++).text(t.info.name),r.children("td").eq(l++).text(a),null!=n&&d>0)if(r.children("td").eq(l++).text(getYMDHMSFromUnixtime(d,!0)),"1"==n.select_ids[0]){let e=n.inputs[1][1];r.addClass("agree"),r.children("td").eq(l++).text("찬성"),r.children("td").eq(l++).html(`\n            <a href="javascript:void(0);" onclick="onClickShowAgreeReason('${e}');" class="blue_deep">\n              <i class="fas fa-comment-dots mRight5"></i>${stringShortDot(e,15)}\n            </a>`)}else{i=1,r.addClass("disagree");let e=n.inputs[2][1];r.children("td").eq(l++).text("반대"),r.children("td").eq(l++).html(`\n              <a href="javascript:void(0);" onclick="onClickShowOpposeReason('${e}');" class="red">\n                <i class="fas fa-comment-dots mRight5"></i>${stringShortDot(e,15)}\n              </a>`)}else i=2,r.addClass("timeout"),r.children("td").eq(l++).text("-"),r.children("td").eq(l++).text("-"),r.children("td").eq(l++).text("미이행");return $(".list_table").eq(0).children("tbody").append(r),i}L.children("tr").children("td").eq(1).children("span").eq(0).children("span").text(U[0]),L.children("tr").children("td").eq(1).children("span").eq(1).children("span").text(U[1]),L.children("tr").children("td").eq(1).children("span").eq(2).children("span").text(U[2])}}(n=e.getItemData("final_judge_result")).makeHtmlRadioType(IPSAP.COL.ALL,0),$(".card").removeClass("hidden"),originalJSFunction()}function onClickShowOpposeReason(e){$(".oppose_reason").text(e),$("#modal_disagree_comment").modal("show")}function onClickShowAgreeReason(e){$(".agree_reason").text(e),$("#modal_agree_comment").modal("show")}function onClickFinalFinishSubmit(){if(IPSAP.DEMO_MODE)window.location.href="./reviewConfirm_list.html";else{g_AppItemParser.targetSavedItemNames=["final_judge_result"];var e=IPSAP.APP_SUBMIT_TYPE_PARAM.JUDGE_FINAL_REJECT;switch(Number($('input:radio[name="final_judge_result_0"]:checked').val())){case 1:e=IPSAP.APP_SUBMIT_TYPE_PARAM.JUDGE_FINAL_A;break;case 2:e=IPSAP.APP_SUBMIT_TYPE_PARAM.JUDGE_FINAL_AC;break;case 3:e=IPSAP.APP_SUBMIT_TYPE_PARAM.JUDGE_FINAL_REQUIRE_RETRY}appItemSubmit(onCompleteFinalFinishSubmit,e)}}function onCompleteFinalFinishSubmit(e,t,a){e?window.location.href="./reviewConfirm_list.html":appSubmitHandleError("심의 완료를 실패했습니다.",t)}$((function(){if(loadApplicationParams(),IPSAP.DEMO_MODE)originalJSFunction();else{let e={"filter.query_items":"change_application,judge_expert_deadline,expert_member,expert_review_result,expert_review_dttm,judge_normal_deadline,normal_review_result,committee_in_member,committee_ex_member,normal_review_dttm,final_judge_result","filter.parent_items":"general_title,general_end_date,application_info,general_director,general_expt"};changeInfoTemplate=$("#change_application").children("ul").first().clone(),changeMemberTemplate=$("#change_application").children("ul").eq(2).clone(),changeEndDateTemplate=$("#change_application").children("ul").eq(3).clone(),$("#change_application").empty(),$("#change_application").removeClass("hidden"),g_AppItemParser=new ItemParser(g_AppInfo.childAppSeq),g_AppItemParser.load(e,dataMappingFunc)}}));