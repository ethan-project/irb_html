"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof date_utils_js&&document.write("<script src='/assets/js/common/util/date_utils.js'><\/script>"),"undefined"==typeof ipsap_item_module_js&&document.write("<script src='/assets/js/ipsap/ipsap_item_module.js'><\/script>"),"undefined"==typeof ipsap_application_common_js&&document.write("<script src='/assets/js/ipsap/ipsap_application_common.js'><\/script>");var approved_inspection="approved_inspection";function onCompleteSubmit(e,a,t){e?window.location.href="./inspection_list.html":appSubmitHandleError("승인후 점검 완료를 실패했습니다.",a)}function makeApprovedInspectionData(){var e=newItemParser.getItemData(approved_inspection),a={},t=e.dataObj.codes;return $.each(t,(function(e,t){var s={};let n="#ins_input_"+t.is_seq;var i=t.sub_items,o=$(`${n}`).val(),p="#ins_check"+t.is_seq,l=$(p).is(":checked");o=$(`${n}`).val();$.each(i,(function(e,a){var t="ins_pass_"+a.is_seq,n=$(`select[name=${t}]`).val();s[a.is_seq]=n})),s[t.is_seq]=o,s.checked=l,a[t.is_seq]=s})),{data:{0:JSON.stringify(a)}}}function setApprovedInspection(){makeApprovedInspectionData(),newItemParser.targetSavedItemNames=[approved_inspection],newItemParser.addMoreSaveTag(approved_inspection,makeApprovedInspectionData())}function loadAppItemData(){newItemParser=new ItemParser(g_AppInfo.childAppSeq),newItemParser.load({"filter.query_items":"approved_inspection, ai_supplement","filter.guide_items":"approved_inspection","filter.parent_items":"general_end_date,application_info"},dataMappingFunc)}function dataMappingFunc(e){$(".agree_date").text(getToDayStr()),null==g_AppInfo.appObj.check_user_name?$(".reviewer").text(g_AppInfo.appObj.user_name):$(".reviewer").text(g_AppInfo.appObj.check_user_name),$(".task_title").text(g_AppInfo.appObj.name_ko+"/"+g_AppInfo.appObj.name_en),$(".task_title_ko").text(g_AppInfo.appObj.name_ko),$(".task_title_en").text(g_AppInfo.appObj.name_en),$(".task_sub_title").text(g_AppInfo.appObj.sub_title),$(".task_director").text(g_AppInfo.appObj.user_name),$(".task_director_all").text(`(연구 책임자 : ${g_AppInfo.appObj.user_name})`),$(".task_director_dept").text(g_AppInfo.appObj.user_dept_str),g_AppInfo.appObj.user_phoneno&&(g_AppInfo.appObj.tmp_user_phoneno=g_AppInfo.appObj.user_phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3")),$(".task_director_contact").text(g_AppInfo.appObj.tmp_user_phoneno+" / "+g_AppInfo.appObj.user_email);var a=(s=e.getItemData(approved_inspection)).dataObj.codes,t={};if(null!=s.dataObj.saved_data&&(t=JSON.parse(s.getStringValue("0"))),$(".approved_inspection_list").empty(),$.each(a,(function(e,a){var t=e+1,s="";s=t<10?"#form_0"+t:"#form_"+t;var n="ins_check"+a.is_seq,i="ins_group"+a.is_seq,o="";isInArray([4,7,8,9],t)&&(o=`<div class="custom-control custom-switch switch-primary mHside10">\n                <input type="checkbox" class="custom-control-input" id="${n}" data-toggle="collapse" data-target='.${i}'>  \n                <label class="custom-control-label w80" for="${n}">해당사항 없음</label>\n              </div>`);var p=`<ul class="list-group focus_area" data-focus-to="${s}">\n                  <li class="list-group-item list_group_title flexMid flexBetween" data-move-to="${s}-1">\n                    <span>${a.contents}<span class="light mLeft15"><i class="fas fa-angle-left mRight5"></i>신청서 보기</span></span>`+o+`</li>\n                  <div id="subItem${t}" class="collapse show ${i}">\n                  </div>\n                  <li class="list-group-item hovered collapse show ${i}">\n                    <div class="mBot5">점검 의견</div>\n                    <textarea class="form-control sub-input" rows="2" id="ins_input_${a.is_seq}" placeholder="[부적합] 선택 시 반드시 입력해주세요."></textarea>\n                  </li>\n                 </ul>`;$(".approved_inspection_list").append(p);var l=a.sub_items;$.each(l,(function(e,a){var s=`<li class="list-group-item small_pass flexMid">\n                    <span class="flex_1">${a.contents}</span>\n                    <span>\n                      <select class="rating_pass" name="ins_pass_${a.is_seq}" autocomplete="off" style="display: none;">\n                        <option value="0">부적합</option>\n                        <option value="1" selected>적합</option>\n                      </select>\n                      <div class="rating_pass" id="rating_pass_${a.is_seq}">\n                        <a href="javascript:void(0);" class="rating_pass active" data-value="1">적합</a>\n                        <a href="javascript:void(0);" class="rating_pass" data-value="0">부적합</a>\n                      </div>\n                    </span>\n                  </li>`;$(`#subItem${t}`).append(s)}))})),$.each(t,(function(e,a){$(`#ins_input_${e}`).text(a[e]);var t=Object.keys(a).filter((a=>a!==e));$.each(t,(function(e,t){1==a[t]?($(`select[name='ins_pass_${t}']`).val("1").prop("selected",!0),$(`#rating_pass_${t}`).children("a").eq(0).addClass("active"),$(`#rating_pass_${t}`).children("a").eq(1).removeClass("active")):($(`select[name='ins_pass_${t}']`).val("0").prop("selected",!0),$(`#rating_pass_${t}`).children("a").eq(0).removeClass("active"),$(`#rating_pass_${t}`).children("a").eq(1).addClass("active"),$(`select[name='ins_pass_${t}']`).closest(".list-group").find("textarea").addClass("red_border"))})),Object.keys(a).includes("checked")&&a.checked&&$(`#ins_check${e}`).click()})),g_AppInfo.appObj.application_result==IPSAP.APPLICATION_RESULT.SUPPLEMENT){var s;$("#supp_comment").removeClass("hidden");let a=(s=e.getItemData("ai_supplement")).getStringValue("0");$("#supp_comment_text").text(a),$(".modal-body").animate({scrollTop:999999},500)}originalJSFunction()}function originalJSFunction(){if($(".modal.draggable").length){var e=!0;$(".modal.draggable>.modal-dialog").draggable({drag:function(e,a){a.position.top<=0&&(a.position.top=0),a.position.top>=window.innerHeight-80&&(a.position.top=window.innerHeight-80)},cursor:"move",handle:".modal-header"}),$(".modal.draggable>.modal-dialog>.modal-content>.modal-header").css("cursor","move"),$(".modal.draggable>.modal-dialog").on({"click drag":function(a){$(".modal_hint").hide(),e&&($(".modal[data-backdrop=false]").css({"background-color":"rgba(0,0,0, 0.0)","pointer-events":"none"}),$(".modal-dialog-centered.ui-draggable").css({"justify-content":"flex-start"}),"click"==a.type&&$(this).css({"margin-right":"0",left:"0",top:"0"})),e=!1}})}$(".modal.fade").each((function(e,a){$(a).hasClass("in")&&$(a).modal("show"),"modal_inspection_after"==$(a).attr("id")&&$("body").css({overflow:"auto"})})),$("[data-focus-to]").on({mouseenter:function(e){let a=$(this),t=$(this).data("focus-to");a.siblings(".list-group").removeClass("active"),$(".app_header").removeClass("active"),a.addClass("active"),$(t).next(".content_wrapper").length?$(t).next(".content_wrapper").find(".app_header").addClass("active"):$(t).nextUntil(".app_anchor").filter(".app_header").addClass("active")}}),$("a.rating_pass").on({click:function(e){$(this).siblings().removeClass("active"),$(this).addClass("active"),$(this).parent().siblings("select").val($(this).data("value")).trigger("change")}}),$("select.rating_pass").on({change:function(e){var a=$(this).closest(".list-group").find("select.rating_pass").length,t=0;$(this).closest(".list-group").find("select.rating_pass").each((function(){t+=1*$(this).val()})),t<a?$(this).closest(".list-group").find("textarea").addClass("red_border").focus():$(this).closest(".list-group").find("textarea").removeClass("red_border")}}),$(".continue").on({click:function(e){$("#modal_inspection_after").modal("show")}}),$(window).on({load:function(e){$(".supplement_comment:visible").length&&($(".hint_title").addClass("op_0"),$(".modal-body").animate({scrollTop:$(document).height()},500))},scroll:function(){scrollSpy()}}),setTriggerDataMoveTo(),scrollSpy()}$((function(){$(".page-contents");IPSAP.DEMO_MODE?($("#all_app_r").load("/html/common/inc_application/all_app_readonly.html",(function(){})),originalJSFunction()):(g_AppInfo.loadParams(),$("#all_app_r").empty(),$("#all_app_r").load("/html/common/inc_application/all_app_readonly.html",(function(){remakeApplicationInfoReadOnly([])})),loadAppItemData()),$("#modal_review").on({click:function(e){var a=newItemParser.getItemData(approved_inspection).dataObj.codes,t=!0;$.each(a,(function(e,a){if(!t)return;let s="#ins_input_"+a.is_seq;var n=a.sub_items,i=$(`${s}`).val();$.each(n,(function(e,a){var s="ins_pass_"+a.is_seq;0!=$(`select[name=${s}]`).val()||""!=i||(t=!1)}))})),t?($("#modal_review").attr("data-target","#modal_review_confirm"),$(".app_no").text(g_AppInfo.appObj.application_no),$(".app_title").text(g_AppInfo.appObj.name_ko)):$("#modal_review").attr("data-target","#modal_input_alert")}}),$("#inspect_submit").on({click:function(e){setApprovedInspection();var a={parent_app_seq:g_AppItemParser.app_seq,application_type:IPSAP.APPLICATION_TYPE.CHECKLIST,judge_type:g_AppInfo.appObj.judge_type};newItemParser.addMoreSaveTag("application_info",{data:a}),appItemSubmitWithParser(newItemParser,onCompleteSubmit,IPSAP.APP_SUBMIT_TYPE_PARAM.CHILD_SUBMIT)}}),$("#modal_review").attr("disabled",!0),$("#check_01").on({change:function(e){$("input:checkbox[id='check_01']").is(":checked")?$("#modal_review").attr("disabled",!1):$("#modal_review").attr("disabled",!0)}})})),$("#modal_inspection_after").on("hidden.bs.modal",(e=>{$(e.currentTarget).modal("show")}));