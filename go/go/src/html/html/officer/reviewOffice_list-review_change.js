var changeInfoTemplate,changeMemberTemplate,changeEndDateTemplate;"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof ipsap_item_module_js&&document.write("<script src='/assets/js/ipsap/ipsap_item_module.js'><\/script>"),document.write("<script src='/html/researcher/application_new-0.js'><\/script>");const animal_is_seq=104,member_is_seq=111,end_date_is_seq=112;function originalJSFunction(){var e=!0;$(".modal.draggable>.modal-dialog").draggable({drag:function(e,t){t.position.top<=0&&(t.position.top=0),t.position.top>=window.innerHeight-80&&(t.position.top=window.innerHeight-80)},cursor:"move",handle:".modal-header"}),$(".modal.draggable>.modal-dialog>.modal-content>.modal-header").css("cursor","move"),$(".modal.draggable>.modal-dialog").on({"click drag":function(t){$(".modal_hint").hide(),e&&($(".modal[data-backdrop=false]").css({"background-color":"rgba(0,0,0, 0.0)","pointer-events":"none"}),$(".modal-dialog-centered.ui-draggable").css({"justify-content":"flex-start"}),"click"==t.type&&$(this).css({"margin-right":"0",left:"0",top:"0"})),e=!1}})}function dataMappingFunc(e){var t=e.getParentItemData("general_title");$("#name_ko").text(t.getStringValue("name_ko")),$("#name_en").text(t.getStringValue("name_en"));{t=e.getParentItemData("application_info");let a=Number(t.getStringValue("approved_dttm"));$("#approved_dttm").text(getDttm(a).dt)}t=e.getParentItemData("general_end_date");function a(e,t){for(let a=0;a<e.length;++a)if(e[a].is_seq==t)return e[a].contents;return"Error!!"}function n(e,t){for(let a=0;a<e.length;++a)if(e[a].file_idx==t)return e[a]}$("#general_end_date").text(t.getStringValue("0"));{var i=e.getItemData("ca_regular_file");let o=(t=e.getItemData("ca_regular_item")).dataObj.saved_data.data;for(const[e,s]of Object.entries(o)){let o=n(i.dataObj.saved_data.data,Number(e)),c=changeInfoTemplate.clone();c.find("span").eq(0).text("[정규]"),c.find("span").eq(1).text(a(t.dataObj.codes,Number(e)));var d,r=JSON.parse(s);104==Number(e)?(d=c.find(".data").eq(1).children("div").first().clone(),c.find(".data").eq(1).empty()):c.find(".data").eq(1).text(r[1]),c.find(".data").eq(2).text(r[2]),c.find("span").eq(2).text(IPSAP.APP_MAIN_TAG_NAME[r[0]]);var p=`newWindowPopup('./_popup_application-info.html#form_${r[0]}')`;if(c.find("a").first().attr("onclick",p),null==o?c.find(".data").eq(3).text(""):(c.find(".data").eq(3).text(o.org_file_name),c.find(".data").eq(3).attr("href",o.src)),104==Number(e)){var l=JSON.parse(r[1]);for(let e=0;e<l.length;++e){let t=d.clone();t.find("span").eq(0).text(l[e][0]),t.find("span").eq(3).text(l[e][1]),t.find("span").eq(5).text(l[e][2]),t.find("span").eq(6).text(l[e][3]),t.find("span").eq(9).text(l[e][4]),t.find("span").eq(11).text(l[e][5]),c.find(".data").eq(1).append(t)}}$("#change_application").append(c)}Object.keys(o).length>0?$("#btn_finish_review_fast").hide():$("#btn_finish_review").hide()}{i=e.getItemData("ca_fast_file");let d=(t=e.getItemData("ca_fast_item")).dataObj.saved_data.data;for(const[l,j]of Object.entries(d)){let d=n(i.dataObj.saved_data.data,Number(l));r=JSON.parse(j);let D={};var o=3;if(111==Number(l)){D=changeMemberTemplate.clone(),D.find(".data").eq(2).text(r[2]);var s=D.find(".data").find("tbody").eq(0),c=D.find(".data").find("tbody").eq(1),_=s.children("tr").eq(0),m=c.children("tr").eq(0);D.find(".data").find("tbody").empty();var f=[],g=e.getParentItemData("general_director");f.push(g.dataObj.saved_data.data[0]);for(var u=g.dataObj.saved_data.data[0].user_seq,h=e.getParentItemData("general_expt"),b=0;b<Object.keys(h.dataObj.saved_data.data).length;b++)f.push(h.dataObj.saved_data.data[b]);$.each(f,(function(e,t){var a=_.clone(),n=t.info;n.tmp_phoneno=n.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),u==t.user_seq?a.children("td").eq(0).find("input").prop("checked",!0):(a.children("td").eq(0).find("input").prop("checked",!1),a.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?a.children("td").eq(1).find("input").prop("checked",!0):(a.children("td").eq(1).find("input").prop("checked",!1),a.children("td").eq(1).find("input").prop("disabled",!0)),a.children("td").eq(2).text(n.name),a.children("td").eq(3).text(n.dept_str),a.children("td").eq(4).text(n.position_str),a.children("td").eq(5).text(n.major_field_str),a.children("td").eq(6).text(n.tmp_phoneno),a.children("td").eq(7).text(t.exp_year_code_str),s.append(a)}));var q=[],v=e.getItemData("general_director");q.push(v.dataObj.saved_data.data[0]);var x=v.dataObj.saved_data.data[0].user_seq,P=e.getItemData("general_expt");for(b=0;b<Object.keys(P.dataObj.saved_data.data).length;b++)q.push(P.dataObj.saved_data.data[b]);$.each(q,(function(e,t){var a=m.clone(),n=t.info;n.tmp_phoneno=n.phoneno.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/,"$1-$2-$3"),x==t.user_seq?a.children("td").eq(0).find("input").prop("checked",!0):(a.children("td").eq(0).find("input").prop("checked",!1),a.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?a.children("td").eq(1).find("input").prop("checked",!0):(a.children("td").eq(1).find("input").prop("checked",!1),a.children("td").eq(1).find("input").prop("disabled",!0)),a.children("td").eq(2).text(n.name),a.children("td").eq(3).text(n.dept_str),a.children("td").eq(4).text(n.position_str),a.children("td").eq(5).text(n.major_field_str),a.children("td").eq(6).text(n.tmp_phoneno),a.children("td").eq(7).text(t.exp_year_code_str),c.append(a)}))}else if(112==Number(l)){D=changeEndDateTemplate.clone();var I=e.getParentItemData("application_info");let t=getTimeStrFromDateType(new Date(getDttm(Number(I.getStringValue("approved_dttm"))).dt));var w=e.getParentItemData("general_end_date"),S=getTimeStrFromDateType(new Date(w.getStringValue("0"))),A=e.getItemData("general_end_date"),O=getTimeStrFromDateType(new Date(A.getStringValue("0")));D.find(".data").eq(2).text(t+"~"+S),D.find(".data").eq(3).text(t+"~"+O),D.find(".data").eq(4).text(r[2]),o=5}else D=changeInfoTemplate.clone(),D.removeClass("regular_review"),D.addClass("simple_review"),D.find(".blue_deep").addClass("green"),D.find(".blue_deep").removeClass("blue_deep"),D.find("span").eq(0).text("[신속]"),D.find("span").eq(1).text(a(t.dataObj.codes,Number(l))),D.find(".data").eq(1).text(r[1]),D.find(".data").eq(2).text(r[2]),D.find("span").eq(2).text(IPSAP.APP_MAIN_TAG_NAME[r[0]]);null==d?D.find(".data").eq(o).text(""):(D.find(".data").eq(o).text(d.org_file_name),D.find(".data").eq(o).attr("href",d.src));p=`newWindowPopup('./_popup_application-info.html#form_${r[0]}')`;D.find("a").first().attr("onclick",p),$("#change_application").append(D)}}$(".agree_date").text(getDate(g_AppInfo.appObj.submit_dttm)),$(".reviewer").text(spaceAddStr(g_AppInfo.appObj.user_name)),originalJSFunction(),$("#app_supplement_general_title").on({change:function(e){resetButton()}}),$("#app_supplement").children("textarea").on({keyup:function(e){resetButton()}}),resetButton()}function resetButton(){$("#btn_request").addClass("disabled"),$("#btn_finish_review").addClass("disabled"),$("#btn_finish_review_fast").addClass("disabled"),$("#app_supplement_general_title").is(":checked")?($("#app_supplement_general_title").parent().addClass("checkbox-danger"),$('label[for="app_supplement_general_title"]').removeClass("blue_deep"),""!=$("#app_supplement").children("textarea").val()&&$("#btn_request").removeClass("disabled")):($("#app_supplement_general_title").parent().removeClass("checkbox-danger"),$('label[for="app_supplement_general_title"]').addClass("blue_deep"),$("#btn_finish_review").removeClass("disabled"),$("#btn_finish_review_fast").removeClass("disabled"))}function onClickRequest(){if($("#app_supplement_general_title").is(":checked")){var e=$("#app_supplement").children("textarea").val();""!=e?IPSAP.DEMO_MODE?window.location.href="./reviewOffice_list.html":(g_AppItemParser.targetSavedItemNames=[],g_AppItemParser.addMoreSaveTag("ca_supplement",{data:{0:e}}),appItemSubmit(onCompleteRequest,IPSAP.APP_SUBMIT_TYPE_PARAM.SUPPLEMENT)):alert("보완 요청사항을 입력하세요.")}else alert("보완 요청사항이 입력되지 않았습니다.")}function onCompleteRequest(e,t,a){e?window.location.href="./reviewOffice_list.html":appSubmitHandleError("행정 보완 요청을 실패했습니다.",t)}function onClickNextJudge(){$("#app_supplement_general_title").is(":checked")?alert("보완 요청사항이 입력되어 있습니다."):IPSAP.DEMO_MODE?window.location.href="./reviewOffice_list-setup.html":(g_AppItemParser.targetSavedItemNames=[],appItemSubmit(onCompleteNextJudge,IPSAP.APP_SUBMIT_TYPE_PARAM.CHECKING))}function onCompleteNextJudge(e,t,a){e?window.location.href="./reviewOffice_list-setup.html":appSubmitHandleError("행정 검토 1단계 요청을 실패했습니다.",t)}function onClickFastFinish(){$("#app_supplement_general_title").is(":checked")?alert("보완 요청사항이 입력되어 있습니다."):IPSAP.DEMO_MODE?window.location.href="./reviewConfirm_list.html":(g_AppItemParser.targetSavedItemNames=[],appItemSubmit(onCompleteFastFinish,IPSAP.APP_SUBMIT_TYPE_PARAM.CHECKING1_FINISH_FAST))}function onCompleteFastFinish(e,t,a){e?window.location.href="./reviewConfirm_list.html":appSubmitHandleError("행정 검토 완료 실패했습니다.",t)}$((function(){if(loadApplicationParams(),IPSAP.DEMO_MODE)originalJSFunction(),$("#change_application").removeClass("hidden");else{let e={"filter.query_items":"change_application","filter.parent_items":"general_title,general_end_date,application_info,general_director,general_expt"};changeInfoTemplate=$("#change_application").children("ul").first().clone(),changeMemberTemplate=$("#change_application").children("ul").eq(2).clone(),changeEndDateTemplate=$("#change_application").children("ul").eq(3).clone(),$("#change_application").empty(),$("#change_application").removeClass("hidden"),g_AppItemParser=new ItemParser(g_AppInfo.childAppSeq),g_AppItemParser.load(e,dataMappingFunc)}}));