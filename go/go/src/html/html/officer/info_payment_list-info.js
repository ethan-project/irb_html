"undefined"==typeof ipsap_common_js&&document.write("<script src='/assets/js/ipsap/ipsap_common.js'><\/script>"),"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof date_utils_js&&document.write("<script src='/assets/js/common/util/date_utils.js'><\/script>");var order_seq=COMM.getStor("order_seq");function getOrderInfo(){let t=CONST.API.ORDERS.DETAIL;API.load({url:t.replace("${order_seq}",order_seq),type:CONST.API_TYPE.GET,success:function(t){if($("#order_info").empty(),t.length>1)$.each(t,(function(s,a){let n=moment(a.the_date,"YYYYMM").format("YYYY-MM")+"-01",d=moment(t[1].auth_date,"YY-MM-DD").format("YYYY-MM-DD");$("#order_name").text(a.pname),$("#order_period").text(n+" ~ "+d);let e="";"CARD"==a.pay_method?e="신용카드":"BANK"==a.pay_method&&(e="계좌이체");let o="";if(o+=`<tr>\n                        <td class="info_name fw_bold">결제 금액</td>\n                        <td class="data fw_bold"><span class="approved underline">${setComma(t[0].amount)}</span><span class="subInfo mLeft5">원</span></td>\n                        <td class="info_name">결제 구분</td>\n                        <td class="data"><span class="approved fw_bold">${e} - 승인</span></td>\n                    </tr>\n                    <tr>\n                        <td class="info_name">결제 일시</td>\n                        <td class="data">${moment(t[0].pay_date,"YYYY-MM-DD hh:mm:ss").format("YYYY-MM-DD HH:mm:ss")}</td>\n                        <td class="info_name">결제 번호</td>\n                        <td class="data">${t[0].moid}</td>\n                    </tr>`,"3"==t[1].order_type){o+=`<tr class="blank_row"><td colspan="4"></td></tr>\n                            <tr>\n                            <td class="info_name fw_bold">취소 금액</td>\n                            <td class="data fw_bold"><span class="canceled underline">${setComma(t[1].amount)}</span><span class="subInfo mLeft5">원</span></td>\n                            <td class="info_name">결제 구분</td>\n                            <td class="data"><span class="canceled fw_bold">${e} - 전체 취소</span></td>\n                            </tr>\n                            <tr>\n                            <td class="info_name">취소 일시</td>\n                            <td class="data">${moment(t[1].pay_date,"YYYY-MM-DD hh:mm:ss").format("YYYY-MM-DD HH:mm:ss")}</td>\n                            <td class="info_name">결제 번호</td>\n                            <td class="data">${t[1].moid}</td>\n                            </tr>`}else if("4"==t[1].order_type){let s="";for(var r=1;r<t.length;r++)s+=`<tr class="blank_row"><td colspan="4"></td></tr>\n                            <tr>\n                            <td class="info_name fw_bold">취소 금액</td>\n                            <td class="data fw_bold"><span class="canceled underline">${setComma(t[r].amount)}</span><span class="subInfo mLeft5">원</span></td>\n                            <td class="info_name">결제 구분</td>\n                            <td class="data"><span class="canceled fw_bold">${e} - 부분 취소</span></td>\n                            </tr>\n                            <tr>\n                            <td class="info_name">취소 일시</td>\n                            <td class="data">${moment(t[r].auth_date,"YY-MM-DD hh:mm:ss").format("YYYY-MM-DD HH:mm:ss")}</td>\n                            <td class="info_name">결제 번호</td>\n                            <td class="data">${t[r].moid}</td>\n                            </tr>`;o+=s}let l=0;for(r=1;r<t.length;r++)l+=t[r].amount;o+=`<tr class="blank_row"><td colspan="4"></td></tr>\n                        <tr>\n                        <td class="info_name">최종 결제 금액</td>\n                        <td colspan="3" class="data"><span class="underline red fw_bold">${setComma(t[0].amount-l)}</span><span class="subInfo mLeft5">원</span></td>\n                        </tr>`,$("#order_info").html(o),$("#btn_issue").attr("data-tid",`${a.tid}`)}));else{let s=moment(t[0].the_date,"YYYYMM").format("YYYY-MM")+"-01",a=moment(s).startOf("month").daysInMonth();$("#order_name").text(t[0].pname),$("#order_period").text(s+" ~ "+s.substring(0,7)+"-"+a);let n="";"CARD"==t[0].pay_method?n="신용카드":"BANK"==t[0].pay_method&&(n="계좌이체"),$("#order_info").append(`<tr>\n                    <td class="info_name fw_bold">결제 금액</td>\n                    <td class="data fw_bold"><span class="approved underline">${setComma(t[0].amount)}</span><span class="subInfo mLeft5">원</span></td>\n                    <td class="info_name">결제 구분</td>\n                    <td class="data"><span class="approved fw_bold">${n} - 승인</span></td>\n                  </tr>\n                  <tr>\n                    <td class="info_name">결제 일시</td>\n                    <td class="data">${moment(t[0].auth_date,"YY-MM-DD hh:mm:ss").format("YYYY-MM-DD HH:mm:ss")}</td>\n                    <td class="info_name">결제 번호</td>\n                    <td class="data">${t[0].moid}</td>\n                  </tr>\n                  <tr class="blank_row"><td colspan="4"></td></tr>\n                  <tr>\n                    <td class="info_name">최종 결제 금액</td>\n                    <td colspan="3" class="data"><span class="underline red fw_bold">${setComma(t[0].amount)}</span><span class="subInfo mLeft5">원</span></td>\n                  </tr>`),$("#btn_issue").attr("data-tid",`${t[0].tid}`)}},complete:function(){$(".card").removeClass("hidden")}})}function printReceipt(t){var s="https://npg.nicepay.co.kr/issue/IssueLoader.do?TID="+t+"&type=0";window.open(s,"popupIssue","toolbar=no,location=no,directories=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,width=420,height=540")}$(document).ready((function(){IPSAP.DEMO_MODE?$(".card").removeClass("hidden"):getOrderInfo()})),$("#btn_issue").on("click",(function(t){t.stopPropagation(),printReceipt($(this).data("tid"))}));