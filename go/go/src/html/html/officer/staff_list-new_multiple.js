function create(e){var r=new FileReader;r.onload=function(){var e=r.result,t=XLSX.read(e,{type:"binary"}),s=t.SheetNames[0],n=t.Sheets[s];var i=XLSX.utils.sheet_to_json(n,{header:["user_type1","user_type2","user_type3","phoneno","email"]});i=i.splice(1);var a=[];if($.each(i,(function(e,r){var t="",s="",n="",i=[];if("y"==r.user_type1)t="3",i.push(t);else if("y"!=r.user_type1&&"n"!=r.user_type1)return!1;if("y"==r.user_type2)s="4",i.push(s);else if("y"!=r.user_type2&&"n"!=r.user_type2)return!1;if("y"==r.user_type3)n="2",i.push(n);else if("y"!=r.user_type3&&"n"!=r.user_type3)return!1;var o={email:r.email,phoneno:r.phoneno.replaceAll("-",""),user_type:i.toString()};a.push(o)})),i.length!=a.length)return $("#modal_new_user").modal("hide"),alert("Excel 파일 내 데이터 값이 유효하지 않습니다."),!1;var o={userArr:a};API.load({url:CONST.API.ADMIN.CREATE_BATCH,type:CONST.API_TYPE.POST,data:o,success:function(e){window.location.href="./staff_list.html"},error:function(e){$("#modal_new_user").modal("hide"),$("#failure_message").text(e.responseJSON.em),$("#modal_failure").modal("show")}})},r.readAsBinaryString(e)}"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),$((function(){$(".page-content");$("#btn_register_batch").on("click",(function(){create($("#register_member_file")[0].files[0])}))}));