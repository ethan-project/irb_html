var changeInfoTemplate,changeMemberTemplate,changeEndDateTemplate;"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof ipsap_item_module_js&&document.write("<script src='/assets/js/ipsap/ipsap_item_module.js'><\/script>"),document.write("<script src='/html/researcher/IBC/common_application_new-IBC.js'><\/script>");const member_is_seq=286,end_date_is_seq=288;function originalJSFunction(){var e=!0;$(".modal.draggable>.modal-dialog").draggable({drag:function(e,t){t.position.top<=0&&(t.position.top=0),t.position.top>=window.innerHeight-80&&(t.position.top=window.innerHeight-80)},cursor:"move",handle:".modal-header"}),$(".modal.draggable>.modal-dialog>.modal-content>.modal-header").css("cursor","move"),$(".modal.draggable>.modal-dialog").on({"click drag":function(t){$(".modal_hint").hide(),e&&($(".modal[data-backdrop=false]").css({"background-color":"rgba(0,0,0, 0.0)","pointer-events":"none"}),$(".modal-dialog-centered.ui-draggable").css({"justify-content":"flex-start"}),"click"==t.type&&$(this).css({"margin-right":"0",left:"0",top:"0"})),e=!1}})}function dataMappingFunc(e){var t=e.getParentItemData("general_title");$("#name_ko").text(t.getStringValue("name_ko")),$("#name_en").text(t.getStringValue("name_en"));{t=e.getParentItemData("application_info");let a=Number(t.getStringValue("approved_dttm"));$("#approved_dttm").text(getDttm(a).dt)}t=e.getParentItemData("general_end_date");function a(e,t){for(let a=0;a<e.length;++a)if(e[a].is_seq==t)return e[a].contents;return"Error!!"}function n(e,t){for(let a=0;a<e.length;++a)if(e[a].file_idx==t)return e[a]}$("#general_end_date").text(t.getStringValue("0"));{var i=e.getItemData("ibc_ca_file");let A=(t=e.getItemData("ibc_ca_item")).dataObj.saved_data.data;for(const[k,j]of Object.entries(A)){let A=n(i.dataObj.saved_data.data,Number(k));var d=JSON.parse(j);let D={};var r=3;if(286==Number(k)){D=changeMemberTemplate.clone(),D.find(".data").eq(2).text(d[2]);var p=D.find(".data").find("tbody").eq(0),l=D.find(".data").find("tbody").eq(1),s=p.children("tr").eq(0),o=l.children("tr").eq(0);D.find(".data").find("tbody").empty();var c=[],_=e.getParentItemData("general_director");c.push(_.dataObj.saved_data.data[0]);for(var m=_.dataObj.saved_data.data[0].user_seq,g=e.getParentItemData("general_expt"),u=0;u<Object.keys(g.dataObj.saved_data.data).length;u++)c.push(g.dataObj.saved_data.data[u]);$.each(c,(function(e,t){let a="";if(t.edu_course){let n=JSON.parse(t.edu_course);for(e in n)a+=`\n              <div class="flexMid">\n                <span class="w120 mRight5">${e}</span>\n                <div>${n[e]}</div>\n              </div>`}var n=s.clone(),i=t.info;m==t.user_seq?n.children("td").eq(0).find("input").prop("checked",!0):(n.children("td").eq(0).find("input").prop("checked",!1),n.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?n.children("td").eq(1).find("input").prop("checked",!0):(n.children("td").eq(1).find("input").prop("checked",!1),n.children("td").eq(1).find("input").prop("disabled",!0)),n.children("td").eq(2).text(i.name),n.children("td").eq(3).text(i.dept_str),n.children("td").eq(4).append(a),p.append(n)}));var f=[],h=e.getItemData("general_director");f.push(h.dataObj.saved_data.data[0]);var b=h.dataObj.saved_data.data[0].user_seq,v=e.getItemData("general_expt");for(u=0;u<Object.keys(v.dataObj.saved_data.data).length;u++)f.push(v.dataObj.saved_data.data[u]);$.each(f,(function(e,t){let a="";if(t.edu_course){let n=JSON.parse(t.edu_course);for(e in n)a+=`\n              <div class="flexMid">\n                <span class="w120 mRight5">${e}</span>\n                <div>${n[e]}</div>\n              </div>`}var n=o.clone(),i=t.info;b==t.user_seq?n.children("td").eq(0).find("input").prop("checked",!0):(n.children("td").eq(0).find("input").prop("checked",!1),n.children("td").eq(0).find("input").prop("disabled",!0)),1==t.animal_mng_flag?n.children("td").eq(1).find("input").prop("checked",!0):(n.children("td").eq(1).find("input").prop("checked",!1),n.children("td").eq(1).find("input").prop("disabled",!0)),n.children("td").eq(2).text(i.name),n.children("td").eq(3).text(i.dept_str),n.children("td").eq(4).append(a),l.append(n)}))}else if(288==Number(k)){D=changeEndDateTemplate.clone();var q=e.getParentItemData("application_info");let t=getTimeStrFromDateType(new Date(getDttm(Number(q.getStringValue("approved_dttm"))).dt));var I=e.getParentItemData("general_end_date"),P=getTimeStrFromDateType(new Date(I.getStringValue("0"))),S=e.getItemData("general_end_date"),x=getTimeStrFromDateType(new Date(S.getStringValue("0")));D.find(".data").eq(2).text(t+"~"+P),D.find(".data").eq(3).text(t+"~"+x),D.find(".data").eq(4).text(d[2]),r=5}else D=changeInfoTemplate.clone(),D.find("label").eq(0).text(a(t.dataObj.codes,Number(k))),D.find(".data").eq(1).text(d[1]),D.find(".data").eq(2).text(d[2]);null==A?D.find(".data").eq(r).text(""):(D.find(".data").eq(r).text(A.org_file_name),D.find(".data").eq(r).attr("href",A.src));var w=`newWindowPopup('./_popup_app-IBC_info_all.html#form_${d[0]}')`;D.find("a").first().attr("onclick",w),D.find("a").eq(0).empty();var C=`<i class="fas fa-link mRight5"></i>심의 신청서 : ${IPSAP.IBC_MAIN_TAGE_NAME[d[0]]}`;D.find("a").eq(0).append(C),$("#change_application").append(D)}}var A=(t=e.getParentItemData("ibc_general_experiment")).getStringValue("0"),k=[];""!=A&&(k=A.split(",")),Math.min.apply(null,k)<=8?$("#btn_finish_review_fast").hide():$("#btn_finish_review").hide(),$(".agree_date").text(getDate(g_AppInfo.appObj.submit_dttm)),$(".reviewer").text(spaceAddStr(g_AppInfo.appObj.user_name)),originalJSFunction(),$("#app_supplement_general_title").on({change:function(e){resetButton()}}),$("#app_supplement").children("textarea").on({keyup:function(e){resetButton()}}),resetButton(),$(".card").removeClass("hidden")}function resetButton(){$("#btn_request").addClass("disabled"),$("#btn_finish_review").addClass("disabled"),$("#btn_finish_review_fast").addClass("disabled"),$("#app_supplement_general_title").is(":checked")?($("#app_supplement_general_title").parent().addClass("checkbox-danger"),$('label[for="app_supplement_general_title"]').removeClass("blue_deep"),""!=$("#app_supplement").children("textarea").val()&&$("#btn_request").removeClass("disabled")):($("#app_supplement_general_title").parent().removeClass("checkbox-danger"),$('label[for="app_supplement_general_title"]').addClass("blue_deep"),$("#btn_finish_review").removeClass("disabled"),$("#btn_finish_review_fast").removeClass("disabled"))}function onClickRequest(){if($("#app_supplement_general_title").is(":checked")){var e=$("#app_supplement").children("textarea").val();""!=e?(g_AppItemParser.targetSavedItemNames=[],g_AppItemParser.addMoreSaveTag("ca_supplement",{data:{0:e}}),appItemSubmit(onCompleteRequest,IPSAP.APP_SUBMIT_TYPE_PARAM.SUPPLEMENT)):alert("보완 요청사항을 입력하세요.")}else alert("보완 요청사항이 입력되지 않았습니다.")}function onCompleteRequest(e,t,a){e?window.location.href="../reviewOffice_list.html":appSubmitHandleError("행정 보완 요청을 실패했습니다.",t)}function onClickNextJudge(){$("#app_supplement_general_title").is(":checked")?alert("보완 요청사항이 입력되어 있습니다."):(g_AppItemParser.targetSavedItemNames=[],appItemSubmit(onCompleteNextJudge,IPSAP.APP_SUBMIT_TYPE_PARAM.CHECKING))}function onCompleteNextJudge(e,t,a){e?window.location.href="./reviewOffice_list-IBC_setup.html":appSubmitHandleError("행정 검토 1단계 요청을 실패했습니다.",t)}function onClickFastFinish(){$("#app_supplement_general_title").is(":checked")?alert("보완 요청사항이 입력되어 있습니다."):(g_AppItemParser.targetSavedItemNames=[],appItemSubmit(onCompleteFastFinish,IPSAP.APP_SUBMIT_TYPE_PARAM.CHECKING1_FINISH_FAST))}function onCompleteFastFinish(e,t,a){e?window.location.href="../reviewConfirm_list.html":appSubmitHandleError("행정 검토 완료 실패했습니다.",t)}$((function(){if(loadApplicationParams(),IPSAP.DEMO_MODE)originalJSFunction(),$("#change_application").removeClass("hidden");else{let e={"filter.query_items":"ibc_change_application","filter.parent_items":"general_title,general_end_date,application_info,general_director,general_expt,ibc_general_experiment"};changeInfoTemplate=$("#change_application").children("ul").eq(0).clone(),changeMemberTemplate=$("#change_application").children("ul").eq(1).clone(),changeEndDateTemplate=$("#change_application").children("ul").eq(2).clone(),$("#change_application").empty(),$("#change_application").removeClass("hidden"),g_AppItemParser=new ItemParser(g_AppInfo.childAppSeq),g_AppItemParser.load(e,dataMappingFunc)}}));