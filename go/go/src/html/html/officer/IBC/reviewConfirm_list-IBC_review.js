var g_trTemplete;"undefined"==typeof api_js&&document.write("<script src='/assets/js/common/api.js'><\/script>"),"undefined"==typeof const_js&&document.write("<script src='/assets/js/common/const.js'><\/script>"),"undefined"==typeof ipsap_item_module_js&&document.write("<script src='/assets/js/ipsap/ipsap_item_module.js'><\/script>"),document.write("<script src='/html/researcher/IBC/common_application_new-IBC.js'><\/script>");var user_info=JSON.parse(COMM.getCookie(CONST.COOKIE.IPSAP_USER_INFO)),inst_info=JSON.parse(COMM.getCookie(CONST.COOKIE.IPSAP_INST_INFO));function dataMappingFunc(e){(t=e.getItemData("final_judge_result")).makeHtmlRadioType(IPSAP.COL.ALL,0);var t=e.getItemData("general_title",!0);$("#coding_title_area").children("div").eq(0).children("span").text(t.getStringValue("name_ko")),$("#coding_title_area").children("div").eq(1).children("span").text(t.getStringValue("name_en"));t=e.getItemData("general_end_date",!0);"0"==g_AppInfo.appObj.approved_dttm?$("#coding_title_area").children("div").eq(2).children("span").text("위원회 승인일 ~ "+t.getStringValue("0")):$("#coding_title_area").children("div").eq(2).children("span").text(getDttm(g_AppInfo.appObj.approved_dttm).dt+" ~ "+t.getStringValue("0")),(t=e.getItemData("expert_review_total_review")).applyTextValueReadOnly();{t=e.getItemData("expert_review_result");let b=0;try{b=Number(t.dataObj.saved_data.data[0].select_ids[0])}catch(S){}let x="";try{x=t.dataObj.saved_data.data[0].inputs[String(b)][1]}catch(w){}let I="";for(let q=0;q<t.dataObj.items.length;++q)if(t.dataObj.items[q].id==b){I=t.dataObj.items[q].value;break}$("#expert_review_result").text(I),""!=x?$("#expert_review_result_text").text(x):$("#expert_review_result_text").remove()}{t=e.getItemData("expert_member");var a="";try{a=t.dataObj.saved_data.data[0].info.name}catch(P){}$("#experter").text(spaceAddStr(a));var i=0;try{i=t.dataObj.saved_data.data[0].user_seq}catch(j){}var r=e.getItemData("expert_review_dttm");const O=new Date(1e3*r.dataObj.saved_data.data[String(i)]);$("#expert_submit_date").text(getTimeStrFromDateType(O))}{var n=e.getItemData("expert_review_opinion",!0);let A=$(".list_table").first().find("tbody"),C=n.dataObj.codes;for(let y=0;y<C.length;++y){let D=g_trTemplete.clone();D.children("td").eq(0).text(C[y].contents);try{let M=n.dataObj.saved_data.data[C[y].is_seq];var d=JSON.parse(M);let T=D.children("td").eq(1);T.empty();let k="";for(let E=0;E<d.select.length;++E){let R=d.select[E],F=n.dataObj.codes[y].sub_items;for(let N=0;N<F.length;++N)if(R==F[N].is_seq){""!=k&&(k+="<br>"),k+=F[N].contents;break}}T.removeClass("noComment"),T.append(`<div class="review_numbers">${k}</div>`),T.append(`<div class="review_desc text-wrap">${d.text}</div>`)}catch(U){}A.append(D)}}{var l=$(".list_table").eq(1).children("tbody").children("tr").first().clone();$(".list_table").eq(1).children("tbody").empty();var s=e.getItemData("normal_review_result",!0),o=e.getItemData("committee_in_member",!0),_=e.getItemData("committee_ex_member",!0),c=e.getItemData("normal_review_dttm",!0);let J=1;const B=o.dataObj.saved_data.data,L=_.dataObj.saved_data.data;var m,p,h=[0,0,0];if(null!=B)for(let V=0;V<B.length;++V){m=void 0;try{m=s.dataObj.saved_data.data[String(B[V].info.user_seq)]}catch(Y){}p=void 0;try{p=c.dataObj.saved_data.data[String(B[V].info.user_seq)]}catch(G){}h[u(J++,B[V],"내부",m,p)]++}if(null!=L)for(let H=0;H<L.length;++H){m=void 0;try{m=s.dataObj.saved_data.data[String(L[H].info.user_seq)]}catch(K){}p=void 0;try{p=c.dataObj.saved_data.data[String(L[H].info.user_seq)]}catch(W){}h[u(J++,L[H],"외부",m,p)]++}var g=$(".list_table").eq(1).children("tfoot");function u(e,t,a,i,r){var n=0,d=l.clone();d.removeClass("agree");let s=0;if(d.attr("user_seq",t.user_seq),d.children("td").eq(s++).text(e),d.children("td").eq(s++).text(t.info.name),d.children("td").eq(s++).text(a),null!=i&&r>0){if(d.children("td").eq(s++).text(getYMDHMSFromUnixtime(r,!0)),"1"==i.select_ids[0]){let e=i.inputs[1][1];d.addClass("agree"),d.children("td").eq(s++).text("찬성"),d.children("td").eq(s++).html(`\n          <a href="javascript:void(0);" onclick="onClickShowAgreeReason('${e}');" class="blue_deep">\n            <i class="fas fa-comment-dots mRight5"></i>${stringShortDot(e,15)}\n          </a>`)}else{n=1,d.addClass("disagree");let e=i.inputs[2][1];d.children("td").eq(s++).text("반대"),d.children("td").eq(s++).html(`\n          <a href="javascript:void(0);" onclick="onClickShowOpposeReason('${e}');" class="red">\n            <i class="fas fa-comment-dots mRight5"></i>${stringShortDot(e,15)}\n          </a>`)}d.children("td").eq(s++).html(`<button type="button" onClick="newWindowPopup('./_popup_confirm-IBC_info.html?id=${t.user_seq}');" class="btn btn-primary btn_xxs noMinWidth"><i class="far fa-file mRight5"></i>심의 평가 결과 보기</button>`)}else n=2,d.addClass("timeout"),d.children("td").eq(s++).text("-"),d.children("td").eq(s++).text("-"),d.children("td").eq(s++).text("미이행");return $(".list_table").eq(1).children("tbody").append(d),n}g.children("tr").children("td").eq(1).children("span").eq(0).children("span").text(h[0]),g.children("tr").children("td").eq(1).children("span").eq(1).children("span").text(h[1]),g.children("tr").children("td").eq(1).children("span").eq(2).children("span").text(h[2])}var v=(t=e.getItemData("ibc_general_experiment")).getStringValue("0"),f=[];""!=v&&(f=v.split(",")),Math.min.apply(null,f)<=8&&$("#judgement_result").removeClass("hidden"),$(".card").removeClass("hidden")}function onClickShowOpposeReason(e){$(".oppose_reason").text(e),$("#modal_disagree_comment").modal("show")}function onClickShowAgreeReason(e){$(".agree_reason").text(e),$("#modal_agree_comment").modal("show")}function onClickFinalFinishSubmit(){if($("#modal_confirm_review").modal("hide"),IPSAP.DEMO_MODE)window.location.href="../reviewConfirm_list.html";else{g_AppItemParser.targetSavedItemNames=["final_judge_result"];var e=IPSAP.APP_SUBMIT_TYPE_PARAM.JUDGE_FINAL_REJECT;switch(Number($('input:radio[name="final_judge_result_0"]:checked').val())){case 1:e=IPSAP.APP_SUBMIT_TYPE_PARAM.JUDGE_FINAL_A;break;case 2:e=IPSAP.APP_SUBMIT_TYPE_PARAM.JUDGE_FINAL_AC;break;case 3:e=IPSAP.APP_SUBMIT_TYPE_PARAM.JUDGE_FINAL_REQUIRE_RETRY}appItemSubmit(onCompleteFinalFinishSubmit,e)}}function onCompleteFinalFinishSubmit(e,t,a){e?window.location.href="../reviewConfirm_list.html":appSubmitHandleError("심의 완료를 실패했습니다.",t)}$((function(){loadApplicationParams();$(".page-content");!function(e){let t=$(".list_table").first().find("tbody");g_trTemplete=t.children("tr").first().clone(),t.empty(),g_AppItemParser=new ItemParser(g_AppInfo.appSeq),g_AppItemParser.load({"filter.query_items":"general_title,general_end_date,final_judge_result,expert_review_opinion,expert_review,expert_member,ibc_general_experiment,committee_in_member,committee_ex_member,normal_review_result,normal_review_dttm,ibc_review_report"},dataMappingFunc),$('[data-target="#modal_confirm_review"]').on("click",(function(){if(""==$('input:radio[name="final_judge_result_0"]:checked').siblings().closest("input").val())return alert("최종 심의 결과를 입력해 주시기 바랍니다."),!1}))}()}));