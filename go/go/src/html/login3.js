const queryString=window.location.search,urlParams=new URLSearchParams(queryString);var paramAppSeq,paramInstSeq,paramRedirectPage,paramUserSeq;urlParams.get("app")&&(paramAppSeq=urlParams.get("app")),urlParams.get("instt")&&(paramInstSeq=urlParams.get("instt")),urlParams.get("page")&&(paramRedirectPage=urlParams.get("page")),urlParams.get("user")&&(paramUserSeq=urlParams.get("user"));var loginStatus=!1;function mailLinkAfterRedirect(paramApp,paramPage){if(paramApp)switch(paramPage){case"app":let urlPath=CONST.API.APPLICATION.LIST_INFO;API.load({url:urlPath.replace("${app_seq}",paramAppSeq),type:CONST.API_TYPE.GET,success:function(data){switch(data.judge_type){case 1:switch(data.application_type){case 1:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/researcher/application_list-info.html");break;case 2:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/researcher/experiment_list-info_change.html");break;case 3:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/researcher/experiment_list-info_renew.html");break;case 4:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/researcher/experiment_list-info_bring.html");break;case 5:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/researcher/inspection_list-info.html");break;case 6:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/researcher/experiment_list-info_end.html")}break;case 2:switch(data.application_type){case 1:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/researcher/IBC/application_list-IBC_info.html");break;case 2:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/researcher/IBC/experiment_list-IBC_info_change.html")}}}});break;case"pro":let urlPath2=CONST.API.APPLICATION.LIST_INFO;API.load({url:urlPath2.replace("${app_seq}",paramAppSeq),type:CONST.API_TYPE.GET,success:function(data){switch(data.judge_type){case 1:switch(data.application_type){case 1:switch(data.application_result){case 4:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/review_list-review_IACUC_expert_1.html");break;case 5:case 6:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/review_list-review_IACUC_expert_2.html");break;default:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/application_list-info.html")}break;case 2:switch(data.application_result){case 4:case 5:case 6:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/review_list-review_IACUC_expert_1_change.html");break;default:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/experiment_list-info_change.html")}break;case 3:switch(data.application_result){case 4:case 5:case 6:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/review_list-review_IACUC_expert_1_renew.html");break;default:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/experiment_list-info_renew.html")}}break;case 2:switch(data.application_type){case 1:switch(data.application_result){case 4:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/review_list-review_IBC_expert_1.html");break;case 5:case 6:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/review_list-review_IBC_expert_2.html");break;default:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/IBC/application_list-IBC_info.html")}break;case 2:switch(data.application_result){case 4:case 5:case 6:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/review_list-review_IBC_expert_1_change.html");break;default:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/IBC/experiment_list-IBC_info_change.html")}}}}});break;case"normal":let urlPath3=CONST.API.APPLICATION.LIST_INFO;API.load({url:urlPath3.replace("${app_seq}",paramAppSeq),type:CONST.API_TYPE.GET,success:function(data){switch(data.judge_type){case 1:switch(data.application_type){case 1:switch(data.application_result){case 4:case 5:case 6:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/review_list-review_IACUC_general_1.html");break;default:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/application_list-info.html")}break;case 2:switch(data.application_result){case 4:case 5:case 6:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/review_list-review_IACUC_general_1_change.html");break;default:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/experiment_list-info_change.html")}break;case 3:switch(data.application_result){case 4:case 5:case 6:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/review_list-review_IACUC_general_1_renew.html");break;default:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/experiment_list-info_renew.html")}}break;case 2:switch(data.application_type){case 1:switch(data.application_result){case 4:case 5:case 6:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/review_list-review_IBC_general_1.html");break;default:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/IBC/application_list-IBC_info.html")}break;case 2:switch(data.application_result){case 4:case 5:case 6:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/review_list-review_IBC_general_1_change.html");break;default:g_AppInfo.initWithAppObj(data),g_AppInfo.saveParamsAndNavigate("/html/committee/IBC/experiment_list-IBC_info_change.html")}}}}});break;case"admin_user":location.replace("/html/officer/staff_list.html")}}$(document).ready(function(){COMM.getCookie("ipsap_token")&&(loginStatus=!0),$("#btnLogin").on("click",function(){var param;0==loginStatus?(param=$(this).parent().parent().find("form").serialize(),(param=COMM.paramStr2Object(param)).tmp_key=COMM.getLoginKey($("[name=email]").val()),param.pw=COMM.getEncrypt(param.tmp_key,param.pw),param.user_seq=parseInt(paramUserSeq),API.load({url:CONST.API.AUTH.LOGIN_EMAIL,type:CONST.API_TYPE.POST,data:param,success:function(data){var user_info=data[0].user_info,institution_info=data[0].ins_info;let inspect_info=new Object;var inspect_info_time=(new Date).getTime();1==user_info.inspector&&(inspect_info.inspect_flag=!0,inspect_info.inspect_info_time=inspect_info_time,COMM.setCookie("inspect_info",JSON.stringify(inspect_info))),COMM.setCookie(CONST.COOKIE.IPSAP_TMP_KEY,COMM.getDecrypt(param.tmp_key,data[0].tmp_key)),COMM.setCookie("user_info",JSON.stringify(user_info)),COMM.setCookie("institution_info",JSON.stringify(institution_info)),COMM.setCookie("logo_file_src",institution_info.logo_file_src),COMM.setCookie(CONST.COOKIE.IPSAP_TOKEN,data[0].token),mailLinkAfterRedirect(paramAppSeq,paramRedirectPage)},error:function(){},complete:function(){}})):parseInt(paramUserSeq)==parseInt(JSON.parse(COMM.getCookie("user_info")).user_seq)?mailLinkAfterRedirect(paramAppSeq,paramRedirectPage):$("#modal_other_institution_alert").modal("show")}),$("#mailLinkRedirect").on("click",function(){var param,password;JSON.parse(COMM.getCookie("user_info")).email!=$("[name=email]").val()?(alert("다른 기관에 속해있는 동일한 아이디로 로그인 해주세요."),$("#modal_other_institution_alert").modal("hide")):(param=new Object,password=$("[name=pw]").val(),param.email=$("[name=email]").val(),param.tmp_key=COMM.getLoginKey($("[name=email]").val()),param.pw=COMM.getEncrypt(param.tmp_key,password),param.user_seq=parseInt(paramUserSeq),API.load({url:CONST.API.AUTH.LOGIN_EMAIL,type:CONST.API_TYPE.POST,data:param,success:function(data){var user_info=data[0].user_info,institution_info=data[0].ins_info;let inspect_info=new Object;var inspect_info_time=(new Date).getTime();1==user_info.inspector&&(inspect_info.inspect_flag=!0,inspect_info.inspect_info_time=inspect_info_time,COMM.setCookie("inspect_info",JSON.stringify(inspect_info))),COMM.setCookie(CONST.COOKIE.IPSAP_TMP_KEY,COMM.getDecrypt(param.tmp_key,data[0].tmp_key)),COMM.setCookie("user_info",JSON.stringify(user_info)),COMM.setCookie("institution_info",JSON.stringify(institution_info)),COMM.setCookie("logo_file_src",institution_info.logo_file_src),COMM.setCookie(CONST.COOKIE.IPSAP_TOKEN,data[0].token),mailLinkAfterRedirect(paramAppSeq,paramRedirectPage)},error:function(data){},complete:function(){}}))})});